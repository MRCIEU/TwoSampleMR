<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TwoSampleMR">
<title>Exposure data • TwoSampleMR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Exposure data">
<meta property="og:description" content="TwoSampleMR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TwoSampleMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guide">Guide</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guide">
    <a class="dropdown-item" href="../articles/index.html">List of articles</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/exposure.html">Exposure data</a>
    <a class="dropdown-item" href="../articles/outcome.html">Outcome data</a>
    <a class="dropdown-item" href="../articles/harmonise.html">Harmonise data</a>
    <a class="dropdown-item" href="../articles/perform_mr.html">Perform MR</a>
    <a class="dropdown-item" href="../articles/gwas2020.html">Major changes to the IEU GWAS resource for 2020</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mrcieu/TwoSampleMR">Source</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Exposure data</h1>
                        <h4 data-toc-skip class="author">Gibran
Hemani</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MRCIEU/TwoSampleMR/blob/HEAD/vignettes/exposure.Rmd" class="external-link"><code>vignettes/exposure.Rmd</code></a></small>
      <div class="d-none name"><code>exposure.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/TwoSampleMR" class="external-link">TwoSampleMR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A data frame of the instruments for an exposure is required. Each
line has the information for one variant for one exposure. The minimum
information required for MR analysis is the following:</p>
<ul>
<li>
<code>SNP</code> - rs ID</li>
<li>
<code>beta</code> - The effect size. If the trait is binary then
log(OR) should be used</li>
<li>
<code>se</code> - The standard error of the effect size</li>
<li>
<code>effect_allele</code> - The allele of the SNP which has the
effect marked in <code>beta</code>
</li>
</ul>
<p>Other information that is useful for MR can also be provided:</p>
<ul>
<li>
<code>other_allele</code> - The non-effect allele</li>
<li>
<code>eaf</code> - The effect allele frequency</li>
<li>
<code>Phenotype</code> - The name of the phenotype for which the SNP
has an effect</li>
</ul>
<p>You can also provide the following extra information:</p>
<ul>
<li>
<code>chr</code> - Physical position of variant (chromosome)</li>
<li>
<code>position</code> - Physical position of variant (position)</li>
<li>
<code>samplesize</code> - Sample size for estimating the effect
size</li>
<li>
<code>ncase</code> - Number of cases</li>
<li>
<code>ncontrol</code> - Number of controls</li>
<li>
<code>pval</code> - The P-value for the SNP’s association with the
exposure</li>
<li>
<code>units</code> - The units in which the effects are
presented</li>
<li>
<code>gene</code> - The gene or other annotation for the the
SNP</li>
</ul>
</div>
<div class="section level2">
<h2 id="reading-in-from-a-file">Reading in from a file<a class="anchor" aria-label="anchor" href="#reading-in-from-a-file"></a>
</h2>
<p>The data can be read in from a text file using the
<code>read_exposure_data</code> function. The file must have a header
with column names corresponding to the columns described above.</p>
<div class="section level3">
<h3 id="example-1-the-default-column-names-are-used">Example 1: The default column names are used<a class="anchor" aria-label="anchor" href="#example-1-the-default-column-names-are-used"></a>
</h3>
<p>An example of a text file with the default column names is provided
as part of the package, the first few rows look like this:</p>
<pre><code>Phenotype SNP beta se effect_allele other_allele eaf pval units gene samplesize
BMI rs10767664 0.19 0.0306122448979592 A T 0.78 5e-26 kg/m2 BDNF 225238
BMI rs13078807 0.1 0.0204081632653061 G A 0.2 4e-11 kg/m2 CADM2 221431
BMI rs1514175 0.07 0.0204081632653061 A G 0.43 8e-14 kg/m2 TNNI3K 207641
BMI rs1558902 0.39 0.0204081632653061 A T 0.42 5e-120 kg/m2 FTO 222476
BMI rs10968576 0.11 0.0204081632653061 G A 0.31 3e-13 kg/m2 LRRN6C 247166
BMI rs2241423 0.13 0.0204081632653061 G A 0.78 1e-18 kg/m2 LBXCOR1 227886</code></pre>
<p>The exact path to the file will be different on everyone’s computer,
but it can be located like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"bmi.txt"</span>, package <span class="op">=</span> <span class="st">"TwoSampleMR"</span><span class="op">)</span></span></code></pre></div>
<p>You can read the data in like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_exposure_data.html">read_exposure_data</a></span><span class="op">(</span><span class="va">bmi_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bmi_exp_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;          SNP beta.exposure se.exposure effect_allele.exposure</span></span>
<span><span class="co">#&gt; 1 rs10767664          0.19  0.03061224                      A</span></span>
<span><span class="co">#&gt; 2 rs13078807          0.10  0.02040816                      G</span></span>
<span><span class="co">#&gt; 3  rs1514175          0.07  0.02040816                      A</span></span>
<span><span class="co">#&gt; 4  rs1558902          0.39  0.02040816                      A</span></span>
<span><span class="co">#&gt; 5 rs10968576          0.11  0.02040816                      G</span></span>
<span><span class="co">#&gt; 6  rs2241423          0.13  0.02040816                      G</span></span>
<span><span class="co">#&gt;   other_allele.exposure eaf.exposure pval.exposure units.exposure gene.exposure</span></span>
<span><span class="co">#&gt; 1                     T         0.78         5e-26          kg/m2          BDNF</span></span>
<span><span class="co">#&gt; 2                     A         0.20         4e-11          kg/m2         CADM2</span></span>
<span><span class="co">#&gt; 3                     G         0.43         8e-14          kg/m2        TNNI3K</span></span>
<span><span class="co">#&gt; 4                     T         0.42        5e-120          kg/m2           FTO</span></span>
<span><span class="co">#&gt; 5                     A         0.31         3e-13          kg/m2        LRRN6C</span></span>
<span><span class="co">#&gt; 6                     A         0.78         1e-18          kg/m2       LBXCOR1</span></span>
<span><span class="co">#&gt;   samplesize.exposure exposure mr_keep.exposure pval_origin.exposure</span></span>
<span><span class="co">#&gt; 1              225238      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt; 2              221431      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt; 3              207641      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt; 4              222476      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt; 5              247166      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt; 6              227886      BMI             TRUE             reported</span></span>
<span><span class="co">#&gt;   units.exposure_dat id.exposure data_source.exposure</span></span>
<span><span class="co">#&gt; 1              kg/m2      ImbABK             textfile</span></span>
<span><span class="co">#&gt; 2              kg/m2      ImbABK             textfile</span></span>
<span><span class="co">#&gt; 3              kg/m2      ImbABK             textfile</span></span>
<span><span class="co">#&gt; 4              kg/m2      ImbABK             textfile</span></span>
<span><span class="co">#&gt; 5              kg/m2      ImbABK             textfile</span></span>
<span><span class="co">#&gt; 6              kg/m2      ImbABK             textfile</span></span></code></pre></div>
<p>The output from this function is a new data frame with standardised
column names:</p>
<ul>
<li><code>SNP</code></li>
<li><code>exposure</code></li>
<li><code>beta.exposure</code></li>
<li><code>se.exposure</code></li>
<li><code>effect_allele.exposure</code></li>
<li><code>other_allele.exposure</code></li>
<li><code>eaf.exposure</code></li>
<li><code>mr_keep.exposure</code></li>
<li><code>pval.exposure</code></li>
<li><code>pval_origin.exposure</code></li>
<li><code>id.exposure</code></li>
<li><code>data_source.exposure</code></li>
<li><code>units.exposure</code></li>
<li><code>gene.exposure</code></li>
<li><code>samplesize.exposure</code></li>
</ul>
<p>The function attempts to match the columns to the ones it expects. It
also checks that the data type is as expected.</p>
<p>If the required data for MR to be performed is not present (SNP name,
effect size, standard error, effect allele) for a particular SNP, then
the column <code>mr_keep.exposure</code> will be <code>FALSE</code>.</p>
</div>
<div class="section level3">
<h3 id="example-2-the-text-file-has-non-default-column-names">Example 2: The text file has non-default column names<a class="anchor" aria-label="anchor" href="#example-2-the-text-file-has-non-default-column-names"></a>
</h3>
<p>If the text file does not have default column names, this can still
be read in as follows. Here are the first few rows of an example:</p>
<pre><code>rsid,effect,SE,a1,a2,a1_freq,p-value,Units,Gene,n
rs10767664,0.19,0.030612245,A,T,0.78,5.00E-26,kg/m2,BDNF,225238
rs13078807,0.1,0.020408163,G,A,0.2,4.00E-11,kg/m2,CADM2,221431
rs1514175,0.07,0.020408163,A,G,0.43,8.00E-14,kg/m2,TNNI3K,207641
rs1558902,0.39,0.020408163,A,T,0.42,5.00E-120,kg/m2,FTO,222476</code></pre>
<p>Note that this is a CSV file, with commas separating fields. The file
is located here:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi2_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bmi.csv"</span>, package <span class="op">=</span> <span class="st">"TwoSampleMR"</span><span class="op">)</span></span></code></pre></div>
<p>To read in this data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_exposure_data.html">read_exposure_data</a></span><span class="op">(</span></span>
<span>    filename <span class="op">=</span> <span class="va">bmi2_file</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>    snp_col <span class="op">=</span> <span class="st">"rsid"</span>,</span>
<span>    beta_col <span class="op">=</span> <span class="st">"effect"</span>,</span>
<span>    se_col <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>    effect_allele_col <span class="op">=</span> <span class="st">"a1"</span>,</span>
<span>    other_allele_col <span class="op">=</span> <span class="st">"a2"</span>,</span>
<span>    eaf_col <span class="op">=</span> <span class="st">"a1_freq"</span>,</span>
<span>    pval_col <span class="op">=</span> <span class="st">"p-value"</span>,</span>
<span>    units_col <span class="op">=</span> <span class="st">"Units"</span>,</span>
<span>    gene_col <span class="op">=</span> <span class="st">"Gene"</span>,</span>
<span>    samplesize_col <span class="op">=</span> <span class="st">"n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; No phenotype name specified, defaulting to 'exposure'.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bmi_exp_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;          SNP beta.exposure se.exposure effect_allele.exposure</span></span>
<span><span class="co">#&gt; 1 rs10767664          0.19  0.03061224                      A</span></span>
<span><span class="co">#&gt; 2 rs13078807          0.10  0.02040816                      G</span></span>
<span><span class="co">#&gt; 3  rs1514175          0.07  0.02040816                      A</span></span>
<span><span class="co">#&gt; 4  rs1558902          0.39  0.02040816                      A</span></span>
<span><span class="co">#&gt; 5 rs10968576          0.11  0.02040816                      G</span></span>
<span><span class="co">#&gt; 6  rs2241423          0.13  0.02040816                      G</span></span>
<span><span class="co">#&gt;   other_allele.exposure eaf.exposure pval.exposure units.exposure gene.exposure</span></span>
<span><span class="co">#&gt; 1                     T         0.78         5e-26          kg/m2          BDNF</span></span>
<span><span class="co">#&gt; 2                     A         0.20         4e-11          kg/m2         CADM2</span></span>
<span><span class="co">#&gt; 3                     G         0.43         8e-14          kg/m2        TNNI3K</span></span>
<span><span class="co">#&gt; 4                     T         0.42        5e-120          kg/m2           FTO</span></span>
<span><span class="co">#&gt; 5                     A         0.31         3e-13          kg/m2        LRRN6C</span></span>
<span><span class="co">#&gt; 6                     A         0.78         1e-18          kg/m2       LBXCOR1</span></span>
<span><span class="co">#&gt;   samplesize.exposure exposure mr_keep.exposure pval_origin.exposure</span></span>
<span><span class="co">#&gt; 1              225238 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt; 2              221431 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt; 3              207641 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt; 4              222476 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt; 5              247166 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt; 6              227886 exposure             TRUE             reported</span></span>
<span><span class="co">#&gt;   units.exposure_dat id.exposure data_source.exposure</span></span>
<span><span class="co">#&gt; 1              kg/m2      Ku3B84             textfile</span></span>
<span><span class="co">#&gt; 2              kg/m2      Ku3B84             textfile</span></span>
<span><span class="co">#&gt; 3              kg/m2      Ku3B84             textfile</span></span>
<span><span class="co">#&gt; 4              kg/m2      Ku3B84             textfile</span></span>
<span><span class="co">#&gt; 5              kg/m2      Ku3B84             textfile</span></span>
<span><span class="co">#&gt; 6              kg/m2      Ku3B84             textfile</span></span></code></pre></div>
<p>If the <code>Phenotype</code> column is not provided (as is the case
in this example) then it will assume that the phenotype’s name is simply
“exposure”. This is entered in the <code>exposure</code> column. It can
be renamed manually:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_exp_dat</span><span class="op">$</span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="st">"BMI"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="using-an-existing-data-frame">Using an existing data frame<a class="anchor" aria-label="anchor" href="#using-an-existing-data-frame"></a>
</h2>
<p>If the data already exists as a data frame in R then it can be
converted into the correct format using the <code><a href="../reference/format_data.html">format_data()</a></code>
function. For example, here is some randomly created data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  SNP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rs1"</span>, <span class="st">"rs2"</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  effect_allele <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">random_df</span></span>
<span><span class="co">#&gt;   SNP beta se effect_allele</span></span>
<span><span class="co">#&gt; 1 rs1    1  1             A</span></span>
<span><span class="co">#&gt; 2 rs2    2  2             T</span></span></code></pre></div>
<p>This can be formatted like so:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_data.html">format_data</a></span><span class="op">(</span><span class="va">random_df</span>, type <span class="op">=</span> <span class="st">"exposure"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No phenotype name specified, defaulting to 'exposure'.</span></span>
<span><span class="co">#&gt; Warning in format_data(random_df, type = "exposure"): The following columns are not present but are helpful for harmonisation</span></span>
<span><span class="co">#&gt; other_alleleeaf</span></span>
<span><span class="co">#&gt; Inferring p-values</span></span>
<span><span class="va">random_exp_dat</span></span>
<span><span class="co">#&gt;   SNP beta.exposure se.exposure effect_allele.exposure exposure</span></span>
<span><span class="co">#&gt; 1 rs1             1           1                      A exposure</span></span>
<span><span class="co">#&gt; 2 rs2             2           2                      T exposure</span></span>
<span><span class="co">#&gt;   mr_keep.exposure pval.exposure pval_origin.exposure id.exposure</span></span>
<span><span class="co">#&gt; 1             TRUE     0.3173105             inferred      4nec1Z</span></span>
<span><span class="co">#&gt; 2             TRUE     0.3173105             inferred      4nec1Z</span></span>
<span><span class="co">#&gt;   other_allele.exposure eaf.exposure</span></span>
<span><span class="co">#&gt; 1                    NA           NA</span></span>
<span><span class="co">#&gt; 2                    NA           NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="obtaining-instruments-from-existing-catalogues">Obtaining instruments from existing catalogues<a class="anchor" aria-label="anchor" href="#obtaining-instruments-from-existing-catalogues"></a>
</h2>
<p>A number of sources of instruments have already been curated and are
available for use. They are provided as data objects in the
<code>MRInstruments</code> package. To install:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"MRCIEU/MRInstruments"</span><span class="op">)</span></span></code></pre></div>
<p>This package contains a number of data.frames, each of which is a
repository of SNP-trait associations. How to access the data frames is
detailed below:</p>
<div class="section level3">
<h3 id="gwas-catalog">GWAS catalog<a class="anchor" aria-label="anchor" href="#gwas-catalog"></a>
</h3>
<p>The NHGRI-EBI GWAS catalog contains a catalog of significant
associations obtained from GWASs. This version of the data is filtered
and harmonised to contain associations that have the required data to
perform MR, to ensure that the units used to report effect sizes from a
particular study are all the same, and other data cleaning
operations.</p>
<p>To use the GWAS catalog:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MRCIEU/MRInstruments" class="external-link">MRInstruments</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gwas_catalog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gwas_catalog</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                 Phenotype_simple</span></span>
<span><span class="co">#&gt; 1                           Eosinophil percentage of white cells</span></span>
<span><span class="co">#&gt; 2                                              Eosinophil counts</span></span>
<span><span class="co">#&gt; 3 Medication use (agents acting on the renin-angiotensin system)</span></span>
<span><span class="co">#&gt; 4                                       Post bronchodilator FEV1</span></span>
<span><span class="co">#&gt; 5                         DNA methylation variation (age effect)</span></span>
<span><span class="co">#&gt; 6                                         Ankylosing spondylitis</span></span>
<span><span class="co">#&gt;                                                MAPPED_TRAIT_EFO</span></span>
<span><span class="co">#&gt; 1                           eosinophil percentage of leukocytes</span></span>
<span><span class="co">#&gt; 2                                              eosinophil count</span></span>
<span><span class="co">#&gt; 3 Agents acting on the renin-angiotensin system use measurement</span></span>
<span><span class="co">#&gt; 4          forced expiratory volume, response to bronchodilator</span></span>
<span><span class="co">#&gt; 5                                               DNA methylation</span></span>
<span><span class="co">#&gt; 6                                        ankylosing spondylitis</span></span>
<span><span class="co">#&gt;                                                              MAPPED_TRAIT_EFO_URI</span></span>
<span><span class="co">#&gt; 1                                            http://www.ebi.ac.uk/efo/EFO_0007991</span></span>
<span><span class="co">#&gt; 2                                            http://www.ebi.ac.uk/efo/EFO_0004842</span></span>
<span><span class="co">#&gt; 3                                            http://www.ebi.ac.uk/efo/EFO_0009931</span></span>
<span><span class="co">#&gt; 4 http://www.ebi.ac.uk/efo/EFO_0004314, http://purl.obolibrary.org/obo/GO_0097366</span></span>
<span><span class="co">#&gt; 5                                       http://purl.obolibrary.org/obo/GO_0006306</span></span>
<span><span class="co">#&gt; 6                                            http://www.ebi.ac.uk/efo/EFO_0003898</span></span>
<span><span class="co">#&gt;                                                                                                                                                Initial_sample_description</span></span>
<span><span class="co">#&gt; 1                                                                                                                                   172,378 European ancestry individuals</span></span>
<span><span class="co">#&gt; 2                                                                                                                                   172,275 European ancestry individuals</span></span>
<span><span class="co">#&gt; 3                                                                                                      62,752 European ancestry cases, 174,778 European ancestry controls</span></span>
<span><span class="co">#&gt; 4 10,094 European ancestry current and former smoker individuals, 3,260 African American current and former smoker individuals, 178 current and former smoker individuals</span></span>
<span><span class="co">#&gt; 5                                                                                                                                                   Up to 954 individuals</span></span>
<span><span class="co">#&gt; 6                                                    921 Turkish ancestry cases, 907 Turkish ancestry controls, 422 Iranian ancestry cases, 754 Iranian ancestry controls</span></span>
<span><span class="co">#&gt;   Replication_sample_description STUDY.ACCESSION</span></span>
<span><span class="co">#&gt; 1                           &lt;NA&gt;      GCST004600</span></span>
<span><span class="co">#&gt; 2                           &lt;NA&gt;      GCST004606</span></span>
<span><span class="co">#&gt; 3                           &lt;NA&gt;      GCST007930</span></span>
<span><span class="co">#&gt; 4                           &lt;NA&gt;      GCST003262</span></span>
<span><span class="co">#&gt; 5                           &lt;NA&gt;      GCST006660</span></span>
<span><span class="co">#&gt; 6                           &lt;NA&gt;      GCST007844</span></span>
<span><span class="co">#&gt;                                                        Phenotype Phenotype_info</span></span>
<span><span class="co">#&gt; 1                           Eosinophil percentage of white cells               </span></span>
<span><span class="co">#&gt; 2                                              Eosinophil counts               </span></span>
<span><span class="co">#&gt; 3 Medication use (agents acting on the renin-angiotensin system)               </span></span>
<span><span class="co">#&gt; 4                                       Post bronchodilator FEV1               </span></span>
<span><span class="co">#&gt; 5                         DNA methylation variation (age effect)               </span></span>
<span><span class="co">#&gt; 6                                         Ankylosing spondylitis               </span></span>
<span><span class="co">#&gt;   PubmedID   Author Year        SNP chr bp_ens_GRCh38   Region       gene</span></span>
<span><span class="co">#&gt; 1 27863252 Astle WJ 2016  rs1000005  21      33060745 21q22.11 AP000282.2</span></span>
<span><span class="co">#&gt; 2 27863252 Astle WJ 2016  rs1000005  21      33060745 21q22.11 AP000282.2</span></span>
<span><span class="co">#&gt; 3 31015401     Wu Y 2019  rs1000010   3      11562645   3p25.3      VGLL4</span></span>
<span><span class="co">#&gt; 4 26634245  Lutz SM 2015 rs10000225   4     144312789  4q31.21 Intergenic</span></span>
<span><span class="co">#&gt; 5 30348214  Zhang Q 2018 rs10000513   4     160334994   4q32.1         NR</span></span>
<span><span class="co">#&gt; 6 30946743     Li Z 2019 rs10000518   4      11502867  4p15.33     HS3ST1</span></span>
<span><span class="co">#&gt;               Gene_ens effect_allele other_allele        beta          se  pval</span></span>
<span><span class="co">#&gt; 1 AP000282.2,LINC00945             C            G -0.02652552 0.003826531 2e-13</span></span>
<span><span class="co">#&gt; 2 AP000282.2,LINC00945             C            G -0.02481715 0.003571429 7e-12</span></span>
<span><span class="co">#&gt; 3                                  G            A -0.03724189 0.006377551 6e-09</span></span>
<span><span class="co">#&gt; 4           Intergenic             A            T -0.04400000 0.009420188 3e-06</span></span>
<span><span class="co">#&gt; 5                   NR          &lt;NA&gt;         &lt;NA&gt;          NA          NA 4e-08</span></span>
<span><span class="co">#&gt; 6                                  G            A  0.73396926          NA 6e-06</span></span>
<span><span class="co">#&gt;              units      eaf date_added_to_MRBASE</span></span>
<span><span class="co">#&gt; 1    unit decrease 0.589400           2019-08-29</span></span>
<span><span class="co">#&gt; 2    unit decrease 0.589400           2019-08-29</span></span>
<span><span class="co">#&gt; 3    unit decrease 0.351806           2019-08-29</span></span>
<span><span class="co">#&gt; 4 NR unit decrease 0.350000           2019-08-29</span></span>
<span><span class="co">#&gt; 5             &lt;NA&gt;       NA           2019-08-29</span></span>
<span><span class="co">#&gt; 6             &lt;NA&gt;       NA           2019-08-29</span></span></code></pre></div>
<p>For example, to obtain instruments for body mass index using the
Speliotes et al 2010 study:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_gwas</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">gwas_catalog</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Speliotes"</span>, <span class="va">Author</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>           <span class="va">Phenotype</span> <span class="op">==</span> <span class="st">"Body mass index"</span><span class="op">)</span></span>
<span><span class="va">bmi_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_data.html">format_data</a></span><span class="op">(</span><span class="va">bmi_gwas</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="metabolites">Metabolites<a class="anchor" aria-label="anchor" href="#metabolites"></a>
</h3>
<p>Independent top hits from GWASs on 121 metabolites in whole blood are
stored in the <code>metab_qtls</code> data object. Use
<code><a href="https://rdrr.io/pkg/MRInstruments/man/metab_qtls.html" class="external-link">?metab_qtls</a></code> to get more information.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metab_qtls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metab_qtls</span><span class="op">)</span></span>
<span><span class="co">#&gt;   phenotype chromosome  position       SNP effect_allele other_allele      eaf</span></span>
<span><span class="co">#&gt; 1     AcAce          8   9181395 rs2169387             G            A 0.870251</span></span>
<span><span class="co">#&gt; 2     AcAce         11 116648917  rs964184             C            G 0.857715</span></span>
<span><span class="co">#&gt; 3       Ace          6  12042473 rs6933521             C            T 0.120256</span></span>
<span><span class="co">#&gt; 4       Ala          2  27730940 rs1260326             C            T 0.638817</span></span>
<span><span class="co">#&gt; 5       Ala          2  65220910 rs2160387             C            T 0.403170</span></span>
<span><span class="co">#&gt; 6       Ala         12  47201814 rs4554975             G            A 0.644059</span></span>
<span><span class="co">#&gt;        beta       se     pval n_studies     n</span></span>
<span><span class="co">#&gt; 1  0.085630 0.015451 3.61e-08        11 19257</span></span>
<span><span class="co">#&gt; 2 -0.096027 0.014624 6.71e-11        11 19261</span></span>
<span><span class="co">#&gt; 3 -0.091667 0.015885 8.10e-09        14 24742</span></span>
<span><span class="co">#&gt; 4 -0.104582 0.009940 7.40e-26        13 22569</span></span>
<span><span class="co">#&gt; 5 -0.071001 0.009603 1.49e-13        14 24793</span></span>
<span><span class="co">#&gt; 6 -0.069135 0.009598 6.12e-13        14 24792</span></span></code></pre></div>
<p>For example, to obtain instruments for Alanine:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ala_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_metab_qtls.html">format_metab_qtls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">metab_qtls</span>, <span class="va">phenotype</span> <span class="op">==</span> <span class="st">"Ala"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="proteins">Proteins<a class="anchor" aria-label="anchor" href="#proteins"></a>
</h3>
<p>Independent top hits from GWASs on 47 protein levels in whole blood
are stored in the <code>proteomic_qtls</code> data object. Use
<code><a href="https://rdrr.io/pkg/MRInstruments/man/proteomic_qtls.html" class="external-link">?proteomic_qtls</a></code> to get more information.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">proteomic_qtls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">proteomic_qtls</span><span class="op">)</span></span>
<span><span class="co">#&gt;   analyte chr  position        SNP  gene location annotation other_allele</span></span>
<span><span class="co">#&gt; 1   CFHR1   1 196698945 rs12144939   CFH      cis   missense            T</span></span>
<span><span class="co">#&gt; 2    IL6r   1 154425456 rs12126142  IL6R      cis   missense            A</span></span>
<span><span class="co">#&gt; 3   ApoA4  11 116677723  rs1263167 APOA4      cis intergenic            G</span></span>
<span><span class="co">#&gt; 4    SELE   9 136149399   rs507666   ABO    trans   intronic            A</span></span>
<span><span class="co">#&gt; 5 FetuinA   3 186335941  rs2070633  AHSG      cis   missense            T</span></span>
<span><span class="co">#&gt; 6     ACE  17  61566031     rs4343   ACE      cis synonymous            A</span></span>
<span><span class="co">#&gt;   effect_allele   eaf   maf      pval   beta         se</span></span>
<span><span class="co">#&gt; 1             G 0.643 0.357 8.99e-143 -1.108 0.04355258</span></span>
<span><span class="co">#&gt; 2             G 0.608 0.392 1.81e-106  0.850 0.03878364</span></span>
<span><span class="co">#&gt; 3             A 0.803 0.197  2.64e-54 -0.919 0.05922332</span></span>
<span><span class="co">#&gt; 4             G 0.809 0.191  1.01e-52 -0.882 0.05771545</span></span>
<span><span class="co">#&gt; 5             C 0.676 0.324  2.88e-44 -0.629 0.04506925</span></span>
<span><span class="co">#&gt; 6             G 0.508 0.492  6.66e-44  0.493 0.03547679</span></span></code></pre></div>
<p>For example, to obtain instruments for the ApoH protein:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apoh_exp_dat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/format_proteomic_qtls.html">format_proteomic_qtls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">proteomic_qtls</span>, <span class="va">analyte</span> <span class="op">==</span> <span class="st">"ApoH"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gene-expression-levels">Gene expression levels<a class="anchor" aria-label="anchor" href="#gene-expression-levels"></a>
</h3>
<p>Independent top hits from GWASs on 32432 gene identifiers and in 44
tissues are available from the GTEX study in <code>gtex_eqtl</code>. Use
<code><a href="https://rdrr.io/pkg/MRInstruments/man/gtex_eqtl.html" class="external-link">?gtex_eqtl</a></code> to get more information.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gtex_eqtl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gtex_eqtl</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 tissue     gene_name gene_start         SNP snp_position</span></span>
<span><span class="co">#&gt; 1 Adipose Subcutaneous RP4-669L17.10   1:317720   rs2519065     1:787151</span></span>
<span><span class="co">#&gt; 2 Adipose Subcutaneous RP11-206L10.1   1:661611  rs11804171     1:723819</span></span>
<span><span class="co">#&gt; 3 Adipose Subcutaneous RP11-206L10.3   1:677193 rs149110718     1:759227</span></span>
<span><span class="co">#&gt; 4 Adipose Subcutaneous RP11-206L10.2   1:700306 rs148649543     1:752796</span></span>
<span><span class="co">#&gt; 5 Adipose Subcutaneous RP11-206L10.9   1:714150  rs12184279     1:717485</span></span>
<span><span class="co">#&gt; 6 Adipose Subcutaneous RP11-206L10.8   1:736259  rs10454454     1:754954</span></span>
<span><span class="co">#&gt;   effect_allele other_allele      beta        se        pval   n</span></span>
<span><span class="co">#&gt; 1             A            G  0.551788 0.0747180 2.14627e-12 298</span></span>
<span><span class="co">#&gt; 2             A            T -0.917475 0.1150060 4.99967e-14 298</span></span>
<span><span class="co">#&gt; 3             T            C  0.807571 0.1776530 8.44694e-06 298</span></span>
<span><span class="co">#&gt; 4             T            C  0.745393 0.0958531 1.82660e-13 298</span></span>
<span><span class="co">#&gt; 5             A            C  1.927250 0.2247390 9.55098e-16 298</span></span>
<span><span class="co">#&gt; 6             A            G  1.000400 0.1787470 5.61079e-08 298</span></span></code></pre></div>
<p>For example, to obtain instruments for the IRAK1BP1 gene expression
levels in subcutaneous adipose tissue:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irak1bp1_exp_dat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/format_gtex_eqtl.html">format_gtex_eqtl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>    <span class="va">gtex_eqtl</span>,</span>
<span>    <span class="va">gene_name</span> <span class="op">==</span> <span class="st">"IRAK1BP1"</span> <span class="op">&amp;</span> <span class="va">tissue</span> <span class="op">==</span> <span class="st">"Adipose Subcutaneous"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in format_data(gtex_eqtl_subset, type = type, phenotype_col = type, : The following columns are not present but are helpful for harmonisation</span></span>
<span><span class="co">#&gt; eaf</span></span>
<span><span class="co">#&gt; Inferring p-values</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dna-methylation-levels">DNA methylation levels<a class="anchor" aria-label="anchor" href="#dna-methylation-levels"></a>
</h3>
<p>Independent top hits from GWASs on 0 DNA methylation levels in whole
blood across 5 time points are available from the ARIES study in
<code>aries_mqtl</code>. Use <code><a href="https://rdrr.io/pkg/MRInstruments/man/aries_mqtl.html" class="external-link">?aries_mqtl</a></code> to get more
information.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">aries_mqtl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">aries_mqtl</span><span class="op">)</span></span>
<span><span class="co">#&gt;          SNP timepoint        cpg    beta        pval         se snp_chr</span></span>
<span><span class="co">#&gt; 1 esv2656832         1 cg21826606  0.3459 1.60408e-26 0.03265336       1</span></span>
<span><span class="co">#&gt; 2 esv2658098         1 cg22681495 -0.6263 1.55765e-66 0.03643240      15</span></span>
<span><span class="co">#&gt; 3 esv2660043         1 cg24276624 -0.5772 3.16370e-26 0.05481823      11</span></span>
<span><span class="co">#&gt; 4 esv2660043         1 cg11157765 -0.5423 1.33928e-22 0.05583777      11</span></span>
<span><span class="co">#&gt; 5 esv2660673         1 cg05832925 -0.5919 2.88011e-50 0.03982467      11</span></span>
<span><span class="co">#&gt; 6 esv2660769         1 cg05859533 -0.6224 1.49085e-58 0.03868158      16</span></span>
<span><span class="co">#&gt;    snp_pos effect_allele other_allele    eaf   sex   age    units</span></span>
<span><span class="co">#&gt; 1 25591901             I            R 0.3974 mixed Birth SD units</span></span>
<span><span class="co">#&gt; 2 86057007             D            R 0.2076 mixed Birth SD units</span></span>
<span><span class="co">#&gt; 3 69982552             D            R 0.1450 mixed Birth SD units</span></span>
<span><span class="co">#&gt; 4 69982552             D            R 0.1450 mixed Birth SD units</span></span>
<span><span class="co">#&gt; 5 74024905             D            R 0.1671 mixed Birth SD units</span></span>
<span><span class="co">#&gt; 6 57725395             D            R 0.2136 mixed Birth SD units</span></span>
<span><span class="co">#&gt;   island_location cpg_chr  cpg_pos    gene gene_location cis_trans</span></span>
<span><span class="co">#&gt; 1         N_Shore       1 25593055                             cis</span></span>
<span><span class="co">#&gt; 2                      15 86058755  AKAP13          Body       cis</span></span>
<span><span class="co">#&gt; 3                      11 69982941    ANO1          Body       cis</span></span>
<span><span class="co">#&gt; 4                      11 69982996    ANO1          Body       cis</span></span>
<span><span class="co">#&gt; 5         S_Shelf      11 74026371                             cis</span></span>
<span><span class="co">#&gt; 6                      16 57727230 CCDC135       TSS1500       cis</span></span></code></pre></div>
<p>For example, to obtain instruments for cg25212131 CpG DNA methylation
levels in at birth:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cg25212131_exp_dat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/format_aries_mqtl.html">format_aries_mqtl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">aries_mqtl</span>, <span class="va">cpg</span> <span class="op">==</span> <span class="st">"cg25212131"</span> <span class="op">&amp;</span></span>
<span>                             <span class="va">age</span> <span class="op">==</span> <span class="st">"Birth"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ieu-gwas-database">IEU GWAS database<a class="anchor" aria-label="anchor" href="#ieu-gwas-database"></a>
</h3>
<p>The IEU GWAS database contains the entire summary statistics for
thousands of GWASs. You can browse them here: <a href="https://gwas.mrcieu.ac.uk/" class="external-link uri">https://gwas.mrcieu.ac.uk/</a></p>
<p>You can use this database to define the instruments for a particular
exposure. You can also use this database to obtain the effects for
constructing polygenic risk scores using different p-value
thresholds.</p>
<p>You can check the status of the API:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ieugwasr</span><span class="fu">::</span><span class="fu"><a href="https://mrcieu.github.io/ieugwasr/reference/api_status.html" class="external-link">api_status</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To obtain a list and details about the available GWASs do the
following:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ao</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/available_outcomes.html">available_outcomes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ao</span><span class="op">)</span></span></code></pre></div>
<p>For information about authentication see <a href="https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication" class="external-link uri">https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication</a>.</p>
<p>The <code><a href="../reference/available_outcomes.html">available_outcomes()</a></code> function returns a table of all
the available studies in the database. Each study has a unique ID. e.g.,
You might obtain</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ao</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">trait</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           trait         id</span></span>
<span><span class="co">#&gt; 1 Schizophrenia ieu-b-5103</span></span>
<span><span class="co">#&gt; 2 Schizophrenia ieu-b-5102</span></span>
<span><span class="co">#&gt; 3 Schizophrenia ieu-b-5101</span></span>
<span><span class="co">#&gt; 4 Schizophrenia ieu-b-5100</span></span>
<span><span class="co">#&gt; 5 Schizophrenia ieu-b-5099</span></span>
<span><span class="co">#&gt; 6 Schizophrenia ieu-b-5098</span></span></code></pre></div>
<p>To extract instruments for a particular trait using a particular
study, for example to obtain SNPs for body mass index using the Locke et
al. 2015 GIANT study, you specify the study ID as follows:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi2014_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_instruments.html">extract_instruments</a></span><span class="op">(</span>outcomes <span class="op">=</span> <span class="st">'ieu-a-2'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bmi2014_exp_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    79 obs. of  15 variables:</span></span>
<span><span class="co">#&gt;  $ pval.exposure         : num  2.18e-08 4.57e-11 5.06e-14 5.45e-10 1.88e-28 ...</span></span>
<span><span class="co">#&gt;  $ samplesize.exposure   : num  339152 339065 313621 338768 338123 ...</span></span>
<span><span class="co">#&gt;  $ chr.exposure          : chr  "1" "1" "1" "1" ...</span></span>
<span><span class="co">#&gt;  $ se.exposure           : num  0.003 0.0031 0.0087 0.0029 0.003 0.0037 0.0031 0.003 0.0038 0.003 ...</span></span>
<span><span class="co">#&gt;  $ beta.exposure         : num  -0.0168 0.0201 0.0659 0.0181 0.0331 0.0497 -0.0227 0.0221 0.0209 0.0175 ...</span></span>
<span><span class="co">#&gt;  $ pos.exposure          : int  47684677 78048331 110082886 201784287 72837239 177889480 49589847 96924097 164567689 181550962 ...</span></span>
<span><span class="co">#&gt;  $ id.exposure           : chr  "ieu-a-2" "ieu-a-2" "ieu-a-2" "ieu-a-2" ...</span></span>
<span><span class="co">#&gt;  $ SNP                   : chr  "rs977747" "rs17381664" "rs7550711" "rs2820292" ...</span></span>
<span><span class="co">#&gt;  $ effect_allele.exposure: chr  "G" "C" "T" "C" ...</span></span>
<span><span class="co">#&gt;  $ other_allele.exposure : chr  "T" "T" "C" "A" ...</span></span>
<span><span class="co">#&gt;  $ eaf.exposure          : num  0.5333 0.425 0.0339 0.5083 0.6083 ...</span></span>
<span><span class="co">#&gt;  $ exposure              : chr  "Body mass index || id:ieu-a-2" "Body mass index || id:ieu-a-2" "Body mass index || id:ieu-a-2" "Body mass index || id:ieu-a-2" ...</span></span>
<span><span class="co">#&gt;  $ mr_keep.exposure      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ pval_origin.exposure  : chr  "reported" "reported" "reported" "reported" ...</span></span>
<span><span class="co">#&gt;  $ data_source.exposure  : chr  "igd" "igd" "igd" "igd" ...</span></span></code></pre></div>
<p>This returns a set of LD clumped SNPs that are GWAS significant for
BMI. You can specify various parameters for this function:</p>
<ul>
<li>
<code>p1</code> = P-value threshold for keeping a SNP</li>
<li>
<code>clump</code> = Whether or not to return independent SNPs only
(default is <code>TRUE</code>)</li>
<li>
<code>r2</code> = The maximum LD R-square allowed between returned
SNPs</li>
<li>
<code>kb</code> = The distance in which to search for LD R-square
values</li>
</ul>
<p>By changing changing the <code>p1</code> parameter it is possible to
obtain SNP effects for constructing polygenic risk scores.</p>
</div>
</div>
<div class="section level2">
<h2 id="clumping">Clumping<a class="anchor" aria-label="anchor" href="#clumping"></a>
</h2>
<p>For standard two sample MR it is important to ensure that the
instruments for the exposure are independent. Once instruments have been
identified for an exposure variable, the IEU GWAS database can be used
to perform clumping.</p>
<p>You can provide a list of SNP IDs, the SNPs will be extracted from
1000 genomes data, LD calculated between them, and amongst those SNPs
that have LD R-square above the specified threshold only the SNP with
the lowest P-value will be retained. To do this, use the following
command:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmi_exp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clump_data.html">clump_data</a></span><span class="op">(</span><span class="va">bmi2014_exp_dat</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bmi_exp_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    30 obs. of  16 variables:</span></span>
<span><span class="co">#&gt;  $ SNP                   : chr  "rs10767664" "rs13078807" "rs1514175" "rs1558902" ...</span></span>
<span><span class="co">#&gt;  $ beta.exposure         : num  0.19 0.1 0.07 0.39 0.11 0.13 0.06 0.09 0.13 0.06 ...</span></span>
<span><span class="co">#&gt;  $ se.exposure           : num  0.0306 0.0204 0.0204 0.0204 0.0204 ...</span></span>
<span><span class="co">#&gt;  $ effect_allele.exposure: chr  "A" "G" "A" "A" ...</span></span>
<span><span class="co">#&gt;  $ other_allele.exposure : chr  "T" "A" "G" "T" ...</span></span>
<span><span class="co">#&gt;  $ eaf.exposure          : num  0.78 0.2 0.43 0.42 0.31 0.78 0.41 0.24 0.21 0.21 ...</span></span>
<span><span class="co">#&gt;  $ pval.exposure         : num  5e-26 4e-11 8e-14 5e-120 3e-13 ...</span></span>
<span><span class="co">#&gt;  $ units.exposure        : chr  "kg/m2" "kg/m2" "kg/m2" "kg/m2" ...</span></span>
<span><span class="co">#&gt;  $ gene.exposure         : chr  "BDNF" "CADM2" "TNNI3K" "FTO" ...</span></span>
<span><span class="co">#&gt;  $ samplesize.exposure   : int  225238 221431 207641 222476 247166 227886 209051 218439 209849 220081 ...</span></span>
<span><span class="co">#&gt;  $ exposure              : chr  "BMI" "BMI" "BMI" "BMI" ...</span></span>
<span><span class="co">#&gt;  $ mr_keep.exposure      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ pval_origin.exposure  : chr  "reported" "reported" "reported" "reported" ...</span></span>
<span><span class="co">#&gt;  $ units.exposure_dat    : chr  "kg/m2" "kg/m2" "kg/m2" "kg/m2" ...</span></span>
<span><span class="co">#&gt;  $ id.exposure           : chr  "FXhiAH" "FXhiAH" "FXhiAH" "FXhiAH" ...</span></span>
<span><span class="co">#&gt;  $ data_source.exposure  : chr  "textfile" "textfile" "textfile" "textfile" ...</span></span></code></pre></div>
<p>The <code><a href="../reference/clump_data.html">clump_data()</a></code> function takes any data frame that has
been formatted to be an exposure data type of data frame. Note that for
the instruments in the MRInstruments package the SNPs are already LD
clumped.</p>
<p><strong>Note:</strong> The LD reference panel only includes SNPs (no
INDELs). There are five super-populations from which LD can be
calculated, by default European samples are used. Only SNPs with MAF
&gt; 0.01 within-population are available.</p>
<p><strong>NOTE:</strong> If a variant is dropped from your unclumped
data it could be because it is absent from the reference panel. For more
flexibility, including using your own LD reference data, see here: <a href="https://mrcieu.github.io/ieugwasr/" class="external-link uri">https://mrcieu.github.io/ieugwasr/</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gibran Hemani, Philip Haycock, Jie Zheng, Tom Gaunt, Ben Elsworth, Tom Palmer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

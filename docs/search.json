[{"path":"https://mrcieu.github.io/TwoSampleMR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2019 Gibran Hemani Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Exposure data","text":"data frame instruments exposure required. line information one variant one exposure. minimum information required MR analysis following: SNP - rs ID beta - effect size. trait binary log() used se - standard error effect size effect_allele - allele SNP effect marked beta information useful MR can also provided: other_allele - non-effect allele eaf - effect allele frequency Phenotype - name phenotype SNP effect can also provide following extra information: chr - Physical position variant (chromosome) position - Physical position variant (position) samplesize - Sample size estimating effect size ncase - Number cases ncontrol - Number controls pval - P-value SNP’s association exposure units - units effects presented gene - gene annotation SNP","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"reading-in-from-a-file","dir":"Articles","previous_headings":"","what":"Reading in from a file","title":"Exposure data","text":"data can read text file using read_exposure_data function. file must header column names corresponding columns described .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"example-1-the-default-column-names-are-used","dir":"Articles","previous_headings":"Reading in from a file","what":"Example 1: The default column names are used","title":"Exposure data","text":"example text file default column names provided part package, first rows look like : exact path file different everyone’s computer, can located like : can read data like : output function new data frame standardised column names: SNP exposure beta.exposure se.exposure effect_allele.exposure other_allele.exposure eaf.exposure mr_keep.exposure pval.exposure pval_origin.exposure id.exposure data_source.exposure units.exposure gene.exposure samplesize.exposure function attempts match columns ones expects. also checks data type expected. required data MR performed present (SNP name, effect size, standard error, effect allele) particular SNP, column mr_keep.exposure FALSE.","code":"Phenotype SNP beta se effect_allele other_allele eaf pval units gene samplesize BMI rs10767664 0.19 0.0306122448979592 A T 0.78 5e-26 kg/m2 BDNF 225238 BMI rs13078807 0.1 0.0204081632653061 G A 0.2 4e-11 kg/m2 CADM2 221431 BMI rs1514175 0.07 0.0204081632653061 A G 0.43 8e-14 kg/m2 TNNI3K 207641 BMI rs1558902 0.39 0.0204081632653061 A T 0.42 5e-120 kg/m2 FTO 222476 BMI rs10968576 0.11 0.0204081632653061 G A 0.31 3e-13 kg/m2 LRRN6C 247166 BMI rs2241423 0.13 0.0204081632653061 G A 0.78 1e-18 kg/m2 LBXCOR1 227886 bmi_file <- system.file(\"extdata\", \"bmi.txt\", package = \"TwoSampleMR\") bmi_exp_dat <- read_exposure_data(bmi_file) head(bmi_exp_dat) #>          SNP beta.exposure se.exposure effect_allele.exposure #> 1 rs10767664          0.19  0.03061224                      A #> 2 rs13078807          0.10  0.02040816                      G #> 3  rs1514175          0.07  0.02040816                      A #> 4  rs1558902          0.39  0.02040816                      A #> 5 rs10968576          0.11  0.02040816                      G #> 6  rs2241423          0.13  0.02040816                      G #>   other_allele.exposure eaf.exposure pval.exposure units.exposure gene.exposure #> 1                     T         0.78         5e-26          kg/m2          BDNF #> 2                     A         0.20         4e-11          kg/m2         CADM2 #> 3                     G         0.43         8e-14          kg/m2        TNNI3K #> 4                     T         0.42        5e-120          kg/m2           FTO #> 5                     A         0.31         3e-13          kg/m2        LRRN6C #> 6                     A         0.78         1e-18          kg/m2       LBXCOR1 #>   samplesize.exposure exposure mr_keep.exposure pval_origin.exposure #> 1              225238      BMI             TRUE             reported #> 2              221431      BMI             TRUE             reported #> 3              207641      BMI             TRUE             reported #> 4              222476      BMI             TRUE             reported #> 5              247166      BMI             TRUE             reported #> 6              227886      BMI             TRUE             reported #>   units.exposure_dat id.exposure data_source.exposure #> 1              kg/m2      ImbABK             textfile #> 2              kg/m2      ImbABK             textfile #> 3              kg/m2      ImbABK             textfile #> 4              kg/m2      ImbABK             textfile #> 5              kg/m2      ImbABK             textfile #> 6              kg/m2      ImbABK             textfile"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"example-2-the-text-file-has-non-default-column-names","dir":"Articles","previous_headings":"Reading in from a file","what":"Example 2: The text file has non-default column names","title":"Exposure data","text":"text file default column names, can still read follows. first rows example: Note CSV file, commas separating fields. file located : read data: Phenotype column provided (case example) assume phenotype’s name simply “exposure”. entered exposure column. can renamed manually:","code":"rsid,effect,SE,a1,a2,a1_freq,p-value,Units,Gene,n rs10767664,0.19,0.030612245,A,T,0.78,5.00E-26,kg/m2,BDNF,225238 rs13078807,0.1,0.020408163,G,A,0.2,4.00E-11,kg/m2,CADM2,221431 rs1514175,0.07,0.020408163,A,G,0.43,8.00E-14,kg/m2,TNNI3K,207641 rs1558902,0.39,0.020408163,A,T,0.42,5.00E-120,kg/m2,FTO,222476 bmi2_file <- system.file(\"extdata/bmi.csv\", package = \"TwoSampleMR\") bmi_exp_dat <- read_exposure_data(     filename = bmi2_file,     sep = \",\",     snp_col = \"rsid\",     beta_col = \"effect\",     se_col = \"SE\",     effect_allele_col = \"a1\",     other_allele_col = \"a2\",     eaf_col = \"a1_freq\",     pval_col = \"p-value\",     units_col = \"Units\",     gene_col = \"Gene\",     samplesize_col = \"n\" ) #> No phenotype name specified, defaulting to 'exposure'. head(bmi_exp_dat) #>          SNP beta.exposure se.exposure effect_allele.exposure #> 1 rs10767664          0.19  0.03061224                      A #> 2 rs13078807          0.10  0.02040816                      G #> 3  rs1514175          0.07  0.02040816                      A #> 4  rs1558902          0.39  0.02040816                      A #> 5 rs10968576          0.11  0.02040816                      G #> 6  rs2241423          0.13  0.02040816                      G #>   other_allele.exposure eaf.exposure pval.exposure units.exposure gene.exposure #> 1                     T         0.78         5e-26          kg/m2          BDNF #> 2                     A         0.20         4e-11          kg/m2         CADM2 #> 3                     G         0.43         8e-14          kg/m2        TNNI3K #> 4                     T         0.42        5e-120          kg/m2           FTO #> 5                     A         0.31         3e-13          kg/m2        LRRN6C #> 6                     A         0.78         1e-18          kg/m2       LBXCOR1 #>   samplesize.exposure exposure mr_keep.exposure pval_origin.exposure #> 1              225238 exposure             TRUE             reported #> 2              221431 exposure             TRUE             reported #> 3              207641 exposure             TRUE             reported #> 4              222476 exposure             TRUE             reported #> 5              247166 exposure             TRUE             reported #> 6              227886 exposure             TRUE             reported #>   units.exposure_dat id.exposure data_source.exposure #> 1              kg/m2      Ku3B84             textfile #> 2              kg/m2      Ku3B84             textfile #> 3              kg/m2      Ku3B84             textfile #> 4              kg/m2      Ku3B84             textfile #> 5              kg/m2      Ku3B84             textfile #> 6              kg/m2      Ku3B84             textfile bmi_exp_dat$exposure <- \"BMI\""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"using-an-existing-data-frame","dir":"Articles","previous_headings":"","what":"Using an existing data frame","title":"Exposure data","text":"data already exists data frame R can converted correct format using format_data() function. example, randomly created data: can formatted like :","code":"random_df <- data.frame(   SNP = c(\"rs1\", \"rs2\"),   beta = c(1, 2),   se = c(1, 2),   effect_allele = c(\"A\", \"T\") ) random_df #>   SNP beta se effect_allele #> 1 rs1    1  1             A #> 2 rs2    2  2             T random_exp_dat <- format_data(random_df, type = \"exposure\") #> No phenotype name specified, defaulting to 'exposure'. #> Warning in format_data(random_df, type = \"exposure\"): The following columns are not present but are helpful for harmonisation #> other_alleleeaf #> Inferring p-values random_exp_dat #>   SNP beta.exposure se.exposure effect_allele.exposure exposure #> 1 rs1             1           1                      A exposure #> 2 rs2             2           2                      T exposure #>   mr_keep.exposure pval.exposure pval_origin.exposure id.exposure #> 1             TRUE     0.3173105             inferred      4nec1Z #> 2             TRUE     0.3173105             inferred      4nec1Z #>   other_allele.exposure eaf.exposure #> 1                    NA           NA #> 2                    NA           NA"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"obtaining-instruments-from-existing-catalogues","dir":"Articles","previous_headings":"","what":"Obtaining instruments from existing catalogues","title":"Exposure data","text":"number sources instruments already curated available use. provided data objects MRInstruments package. install: package contains number data.frames, repository SNP-trait associations. access data frames detailed :","code":"remotes::install_github(\"MRCIEU/MRInstruments\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"gwas-catalog","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"GWAS catalog","title":"Exposure data","text":"NHGRI-EBI GWAS catalog contains catalog significant associations obtained GWASs. version data filtered harmonised contain associations required data perform MR, ensure units used report effect sizes particular study , data cleaning operations. use GWAS catalog: example, obtain instruments body mass index using Speliotes et al 2010 study:","code":"library(MRInstruments) data(gwas_catalog) head(gwas_catalog) #>                                                 Phenotype_simple #> 1                           Eosinophil percentage of white cells #> 2                                              Eosinophil counts #> 3 Medication use (agents acting on the renin-angiotensin system) #> 4                                       Post bronchodilator FEV1 #> 5                         DNA methylation variation (age effect) #> 6                                         Ankylosing spondylitis #>                                                MAPPED_TRAIT_EFO #> 1                           eosinophil percentage of leukocytes #> 2                                              eosinophil count #> 3 Agents acting on the renin-angiotensin system use measurement #> 4          forced expiratory volume, response to bronchodilator #> 5                                               DNA methylation #> 6                                        ankylosing spondylitis #>                                                              MAPPED_TRAIT_EFO_URI #> 1                                            http://www.ebi.ac.uk/efo/EFO_0007991 #> 2                                            http://www.ebi.ac.uk/efo/EFO_0004842 #> 3                                            http://www.ebi.ac.uk/efo/EFO_0009931 #> 4 http://www.ebi.ac.uk/efo/EFO_0004314, http://purl.obolibrary.org/obo/GO_0097366 #> 5                                       http://purl.obolibrary.org/obo/GO_0006306 #> 6                                            http://www.ebi.ac.uk/efo/EFO_0003898 #>                                                                                                                                                Initial_sample_description #> 1                                                                                                                                   172,378 European ancestry individuals #> 2                                                                                                                                   172,275 European ancestry individuals #> 3                                                                                                      62,752 European ancestry cases, 174,778 European ancestry controls #> 4 10,094 European ancestry current and former smoker individuals, 3,260 African American current and former smoker individuals, 178 current and former smoker individuals #> 5                                                                                                                                                   Up to 954 individuals #> 6                                                    921 Turkish ancestry cases, 907 Turkish ancestry controls, 422 Iranian ancestry cases, 754 Iranian ancestry controls #>   Replication_sample_description STUDY.ACCESSION #> 1                           <NA>      GCST004600 #> 2                           <NA>      GCST004606 #> 3                           <NA>      GCST007930 #> 4                           <NA>      GCST003262 #> 5                           <NA>      GCST006660 #> 6                           <NA>      GCST007844 #>                                                        Phenotype Phenotype_info #> 1                           Eosinophil percentage of white cells                #> 2                                              Eosinophil counts                #> 3 Medication use (agents acting on the renin-angiotensin system)                #> 4                                       Post bronchodilator FEV1                #> 5                         DNA methylation variation (age effect)                #> 6                                         Ankylosing spondylitis                #>   PubmedID   Author Year        SNP chr bp_ens_GRCh38   Region       gene #> 1 27863252 Astle WJ 2016  rs1000005  21      33060745 21q22.11 AP000282.2 #> 2 27863252 Astle WJ 2016  rs1000005  21      33060745 21q22.11 AP000282.2 #> 3 31015401     Wu Y 2019  rs1000010   3      11562645   3p25.3      VGLL4 #> 4 26634245  Lutz SM 2015 rs10000225   4     144312789  4q31.21 Intergenic #> 5 30348214  Zhang Q 2018 rs10000513   4     160334994   4q32.1         NR #> 6 30946743     Li Z 2019 rs10000518   4      11502867  4p15.33     HS3ST1 #>               Gene_ens effect_allele other_allele        beta          se  pval #> 1 AP000282.2,LINC00945             C            G -0.02652552 0.003826531 2e-13 #> 2 AP000282.2,LINC00945             C            G -0.02481715 0.003571429 7e-12 #> 3                                  G            A -0.03724189 0.006377551 6e-09 #> 4           Intergenic             A            T -0.04400000 0.009420188 3e-06 #> 5                   NR          <NA>         <NA>          NA          NA 4e-08 #> 6                                  G            A  0.73396926          NA 6e-06 #>              units      eaf date_added_to_MRBASE #> 1    unit decrease 0.589400           2019-08-29 #> 2    unit decrease 0.589400           2019-08-29 #> 3    unit decrease 0.351806           2019-08-29 #> 4 NR unit decrease 0.350000           2019-08-29 #> 5             <NA>       NA           2019-08-29 #> 6             <NA>       NA           2019-08-29 bmi_gwas <-   subset(gwas_catalog,          grepl(\"Speliotes\", Author) &            Phenotype == \"Body mass index\") bmi_exp_dat <- format_data(bmi_gwas)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"metabolites","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"Metabolites","title":"Exposure data","text":"Independent top hits GWASs 121 metabolites whole blood stored metab_qtls data object. Use ?metab_qtls get information. example, obtain instruments Alanine:","code":"data(metab_qtls) head(metab_qtls) #>   phenotype chromosome  position       SNP effect_allele other_allele      eaf #> 1     AcAce          8   9181395 rs2169387             G            A 0.870251 #> 2     AcAce         11 116648917  rs964184             C            G 0.857715 #> 3       Ace          6  12042473 rs6933521             C            T 0.120256 #> 4       Ala          2  27730940 rs1260326             C            T 0.638817 #> 5       Ala          2  65220910 rs2160387             C            T 0.403170 #> 6       Ala         12  47201814 rs4554975             G            A 0.644059 #>        beta       se     pval n_studies     n #> 1  0.085630 0.015451 3.61e-08        11 19257 #> 2 -0.096027 0.014624 6.71e-11        11 19261 #> 3 -0.091667 0.015885 8.10e-09        14 24742 #> 4 -0.104582 0.009940 7.40e-26        13 22569 #> 5 -0.071001 0.009603 1.49e-13        14 24793 #> 6 -0.069135 0.009598 6.12e-13        14 24792 ala_exp_dat <- format_metab_qtls(subset(metab_qtls, phenotype == \"Ala\"))"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"proteins","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"Proteins","title":"Exposure data","text":"Independent top hits GWASs 47 protein levels whole blood stored proteomic_qtls data object. Use ?proteomic_qtls get information. example, obtain instruments ApoH protein:","code":"data(proteomic_qtls) head(proteomic_qtls) #>   analyte chr  position        SNP  gene location annotation other_allele #> 1   CFHR1   1 196698945 rs12144939   CFH      cis   missense            T #> 2    IL6r   1 154425456 rs12126142  IL6R      cis   missense            A #> 3   ApoA4  11 116677723  rs1263167 APOA4      cis intergenic            G #> 4    SELE   9 136149399   rs507666   ABO    trans   intronic            A #> 5 FetuinA   3 186335941  rs2070633  AHSG      cis   missense            T #> 6     ACE  17  61566031     rs4343   ACE      cis synonymous            A #>   effect_allele   eaf   maf      pval   beta         se #> 1             G 0.643 0.357 8.99e-143 -1.108 0.04355258 #> 2             G 0.608 0.392 1.81e-106  0.850 0.03878364 #> 3             A 0.803 0.197  2.64e-54 -0.919 0.05922332 #> 4             G 0.809 0.191  1.01e-52 -0.882 0.05771545 #> 5             C 0.676 0.324  2.88e-44 -0.629 0.04506925 #> 6             G 0.508 0.492  6.66e-44  0.493 0.03547679 apoh_exp_dat <-   format_proteomic_qtls(subset(proteomic_qtls, analyte == \"ApoH\"))"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"gene-expression-levels","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"Gene expression levels","title":"Exposure data","text":"Independent top hits GWASs 32432 gene identifiers 44 tissues available GTEX study gtex_eqtl. Use ?gtex_eqtl get information. example, obtain instruments IRAK1BP1 gene expression levels subcutaneous adipose tissue:","code":"data(gtex_eqtl) head(gtex_eqtl) #>                 tissue     gene_name gene_start         SNP snp_position #> 1 Adipose Subcutaneous RP4-669L17.10   1:317720   rs2519065     1:787151 #> 2 Adipose Subcutaneous RP11-206L10.1   1:661611  rs11804171     1:723819 #> 3 Adipose Subcutaneous RP11-206L10.3   1:677193 rs149110718     1:759227 #> 4 Adipose Subcutaneous RP11-206L10.2   1:700306 rs148649543     1:752796 #> 5 Adipose Subcutaneous RP11-206L10.9   1:714150  rs12184279     1:717485 #> 6 Adipose Subcutaneous RP11-206L10.8   1:736259  rs10454454     1:754954 #>   effect_allele other_allele      beta        se        pval   n #> 1             A            G  0.551788 0.0747180 2.14627e-12 298 #> 2             A            T -0.917475 0.1150060 4.99967e-14 298 #> 3             T            C  0.807571 0.1776530 8.44694e-06 298 #> 4             T            C  0.745393 0.0958531 1.82660e-13 298 #> 5             A            C  1.927250 0.2247390 9.55098e-16 298 #> 6             A            G  1.000400 0.1787470 5.61079e-08 298 irak1bp1_exp_dat <-   format_gtex_eqtl(subset(     gtex_eqtl,     gene_name == \"IRAK1BP1\" & tissue == \"Adipose Subcutaneous\"   )) #> Warning in format_data(gtex_eqtl_subset, type = type, phenotype_col = type, : The following columns are not present but are helpful for harmonisation #> eaf #> Inferring p-values"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"dna-methylation-levels","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"DNA methylation levels","title":"Exposure data","text":"Independent top hits GWASs 0 DNA methylation levels whole blood across 5 time points available ARIES study aries_mqtl. Use ?aries_mqtl get information. example, obtain instruments cg25212131 CpG DNA methylation levels birth:","code":"data(aries_mqtl) head(aries_mqtl) #>          SNP timepoint        cpg    beta        pval         se snp_chr #> 1 esv2656832         1 cg21826606  0.3459 1.60408e-26 0.03265336       1 #> 2 esv2658098         1 cg22681495 -0.6263 1.55765e-66 0.03643240      15 #> 3 esv2660043         1 cg24276624 -0.5772 3.16370e-26 0.05481823      11 #> 4 esv2660043         1 cg11157765 -0.5423 1.33928e-22 0.05583777      11 #> 5 esv2660673         1 cg05832925 -0.5919 2.88011e-50 0.03982467      11 #> 6 esv2660769         1 cg05859533 -0.6224 1.49085e-58 0.03868158      16 #>    snp_pos effect_allele other_allele    eaf   sex   age    units #> 1 25591901             I            R 0.3974 mixed Birth SD units #> 2 86057007             D            R 0.2076 mixed Birth SD units #> 3 69982552             D            R 0.1450 mixed Birth SD units #> 4 69982552             D            R 0.1450 mixed Birth SD units #> 5 74024905             D            R 0.1671 mixed Birth SD units #> 6 57725395             D            R 0.2136 mixed Birth SD units #>   island_location cpg_chr  cpg_pos    gene gene_location cis_trans #> 1         N_Shore       1 25593055                             cis #> 2                      15 86058755  AKAP13          Body       cis #> 3                      11 69982941    ANO1          Body       cis #> 4                      11 69982996    ANO1          Body       cis #> 5         S_Shelf      11 74026371                             cis #> 6                      16 57727230 CCDC135       TSS1500       cis cg25212131_exp_dat <-   format_aries_mqtl(subset(aries_mqtl, cpg == \"cg25212131\" &                              age == \"Birth\"))"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"ieu-opengwas-database","dir":"Articles","previous_headings":"Obtaining instruments from existing catalogues","what":"IEU OpenGWAS database","title":"Exposure data","text":"IEU OpenGWAS database contains entire summary statistics thousands GWASs. can browse : https://gwas.mrcieu.ac.uk/ can use database define instruments particular exposure. can also use database obtain effects constructing polygenic risk scores using different p-value thresholds. can check status API: obtain list details available GWASs following: information authentication see https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication. available_outcomes() function returns table available studies database. study unique ID. e.g., might obtain extract instruments particular trait using particular study, example obtain SNPs body mass index using Locke et al. 2015 GIANT study, specify study ID follows: returns set LD clumped SNPs GWAS significant BMI. can specify various parameters function: p1 = P-value threshold keeping SNP clump = Whether return independent SNPs (default TRUE) r2 = maximum LD R-square allowed returned SNPs kb = distance search LD R-square values changing changing p1 parameter possible obtain SNP effects constructing polygenic risk scores.","code":"ieugwasr::api_status() ao <- available_outcomes() head(ao) head(subset(ao, select = c(trait, id))) #>           trait         id #> 1 Schizophrenia ieu-b-5103 #> 2 Schizophrenia ieu-b-5102 #> 3 Schizophrenia ieu-b-5101 #> 4 Schizophrenia ieu-b-5100 #> 5 Schizophrenia ieu-b-5099 #> 6 Schizophrenia ieu-b-5098 bmi2014_exp_dat <- extract_instruments(outcomes = 'ieu-a-2') str(bmi2014_exp_dat) #> 'data.frame':    79 obs. of  15 variables: #>  $ pval.exposure         : num  2.18e-08 4.57e-11 5.06e-14 5.45e-10 1.88e-28 ... #>  $ samplesize.exposure   : num  339152 339065 313621 338768 338123 ... #>  $ chr.exposure          : chr  \"1\" \"1\" \"1\" \"1\" ... #>  $ se.exposure           : num  0.003 0.0031 0.0087 0.0029 0.003 0.0037 0.0031 0.003 0.0038 0.003 ... #>  $ beta.exposure         : num  -0.0168 0.0201 0.0659 0.0181 0.0331 0.0497 -0.0227 0.0221 0.0209 0.0175 ... #>  $ pos.exposure          : int  47684677 78048331 110082886 201784287 72837239 177889480 49589847 96924097 164567689 181550962 ... #>  $ id.exposure           : chr  \"ieu-a-2\" \"ieu-a-2\" \"ieu-a-2\" \"ieu-a-2\" ... #>  $ SNP                   : chr  \"rs977747\" \"rs17381664\" \"rs7550711\" \"rs2820292\" ... #>  $ effect_allele.exposure: chr  \"G\" \"C\" \"T\" \"C\" ... #>  $ other_allele.exposure : chr  \"T\" \"T\" \"C\" \"A\" ... #>  $ eaf.exposure          : num  0.5333 0.425 0.0339 0.5083 0.6083 ... #>  $ exposure              : chr  \"Body mass index || id:ieu-a-2\" \"Body mass index || id:ieu-a-2\" \"Body mass index || id:ieu-a-2\" \"Body mass index || id:ieu-a-2\" ... #>  $ mr_keep.exposure      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ... #>  $ pval_origin.exposure  : chr  \"reported\" \"reported\" \"reported\" \"reported\" ... #>  $ data_source.exposure  : chr  \"igd\" \"igd\" \"igd\" \"igd\" ..."},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/exposure.html","id":"clumping","dir":"Articles","previous_headings":"","what":"Clumping","title":"Exposure data","text":"standard two sample MR important ensure instruments exposure independent. instruments identified exposure variable, IEU OpenGWAS database can used perform clumping. can provide list SNP IDs, SNPs extracted 1000 genomes data, LD calculated , amongst SNPs LD R-square specified threshold SNP lowest P-value retained. , use following command: clump_data() function takes data frame formatted exposure data type data frame. Note instruments MRInstruments package SNPs already LD clumped. Note: LD reference panel includes SNPs (INDELs). five super-populations LD can calculated, default European samples used. SNPs MAF > 0.01 within-population available. NOTE: variant dropped unclumped data absent reference panel. flexibility, including using LD reference data, see : https://mrcieu.github.io/ieugwasr/","code":"bmi_exp_dat <- clump_data(bmi2014_exp_dat) str(bmi_exp_dat) #> 'data.frame':    30 obs. of  16 variables: #>  $ SNP                   : chr  \"rs10767664\" \"rs13078807\" \"rs1514175\" \"rs1558902\" ... #>  $ beta.exposure         : num  0.19 0.1 0.07 0.39 0.11 0.13 0.06 0.09 0.13 0.06 ... #>  $ se.exposure           : num  0.0306 0.0204 0.0204 0.0204 0.0204 ... #>  $ effect_allele.exposure: chr  \"A\" \"G\" \"A\" \"A\" ... #>  $ other_allele.exposure : chr  \"T\" \"A\" \"G\" \"T\" ... #>  $ eaf.exposure          : num  0.78 0.2 0.43 0.42 0.31 0.78 0.41 0.24 0.21 0.21 ... #>  $ pval.exposure         : num  5e-26 4e-11 8e-14 5e-120 3e-13 ... #>  $ units.exposure        : chr  \"kg/m2\" \"kg/m2\" \"kg/m2\" \"kg/m2\" ... #>  $ gene.exposure         : chr  \"BDNF\" \"CADM2\" \"TNNI3K\" \"FTO\" ... #>  $ samplesize.exposure   : int  225238 221431 207641 222476 247166 227886 209051 218439 209849 220081 ... #>  $ exposure              : chr  \"BMI\" \"BMI\" \"BMI\" \"BMI\" ... #>  $ mr_keep.exposure      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ... #>  $ pval_origin.exposure  : chr  \"reported\" \"reported\" \"reported\" \"reported\" ... #>  $ units.exposure_dat    : chr  \"kg/m2\" \"kg/m2\" \"kg/m2\" \"kg/m2\" ... #>  $ id.exposure           : chr  \"FXhiAH\" \"FXhiAH\" \"FXhiAH\" \"FXhiAH\" ... #>  $ data_source.exposure  : chr  \"textfile\" \"textfile\" \"textfile\" \"textfile\" ..."},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"dataset-ids","dir":"Articles","previous_headings":"What has changed","what":"Dataset IDs","title":"Major changes to the IEU GWAS resources for 2020","text":"made new system naming datasets, datasets organised data batches. Either new datasets uploaded one time case added ieu-data batch, bulk upload case new batch created. example, ukb-bulk upload first round Neale lab UKBiobank GWAS, ukb-b IEU GWAS analysis UKBiobank data. cases, dataset numbered arbitrarily within batch. example, Locke et al 2014 BMI analysis previously known 2, now known ieu--2. backward compatibility built R packages access data, use ‘old’ ID, automatically translate new one. give warning, urge update scripts reflect change.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"authentication","dir":"Articles","previous_headings":"What has changed","what":"Authentication","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously automatically asked authenticate query database, google. Now, making authentication voluntary - something start session need access specific private datasets database. vast majority use cases required. Another change R package managed authentication updated, file tokens generated slightly different. full information deal , see : https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"ukbiobank-data-has-been-curated","dir":"Articles","previous_headings":"What has changed","what":"UKBiobank data has been curated","title":"Major changes to the IEU GWAS resources for 2020","text":"conducted large GWAS analysis using pipeline systematically analysed every PHESANT phenotype UK Biobank. previously ~20k traits complete GWAS data, majority binary traits based numbers cases. now filtered unreliable datasets, 2514 traits remaining, binary traits removed fewer 1000 cases. Another issue combination small numbers cases allele frequency - minor allele count (MAC) particular association small lead high false positives using Bolt-LMM. remaining traits filtered retain associations MAC > 90. Document detailing investigation : https://htmlpreview.github.io/?https://raw.githubusercontent.com/MRCIEU/ukbb-gwas-analysis/master/docs/ldsc_clumped_analysis.html?token=AAOV6TBQXEXEPT7SUXXLWMC6DWP3O","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"all-data-is-now-harmonised","dir":"Articles","previous_headings":"What has changed","what":"All data is now harmonised","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously data QC’d remove malformed results deposited found . now also pre-harmonising data. means alleles coded forward strand, non-effect allele always aligned human genome reference sequence B37 (effect allele non-reference allele). mean sometimes variants removed map human genome, datasets effect allele switched approximately half sites. effect allele changes course switch sign effect size, impact MR results.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"ld-reference-panel-is-now-harmonised","dir":"Articles","previous_headings":"What has changed","what":"LD reference panel is now harmonised","title":"Major changes to the IEU GWAS resources for 2020","text":"updated LD reference panel harmonised human genome build 37, consequence variants lost version previously used.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"instrument-lists-are-up-to-date","dir":"Articles","previous_headings":"What has changed","what":"Instrument lists are up-to-date","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously pre-clumping tophits storing MRInstruments R package, often delay updating MRInstruments R package new datasets uploaded database. moved away model. Everything dataset pre-clumped, stored database. request default clumping values extracting tophits dataset, still fast retrieving data server, MRInstruments package. can continue use MRInstruments package GWAS hits e.g. GTEx EBI GWAS catalog.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"dbsnp-rs-ids","dir":"Articles","previous_headings":"What has changed","what":"dbSNP rs IDs","title":"Major changes to the IEU GWAS resources for 2020","text":"rs IDs mapped dbSNP build 144. Therefore, rs IDs may changed, stronger alignment across datasets.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"everything-is-faster","dir":"Articles","previous_headings":"What has changed","what":"Everything is faster","title":"Major changes to the IEU GWAS resources for 2020","text":"using Elasticsearch Neo4j Oracle Cloud Infrastructure serve data. ’s much faster. Interestingly, actually gets faster people using cache gets ‘warmed ’ requests.","code":""},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"browse-available-datasets-online","dir":"Articles","previous_headings":"What is new","what":"Browse available datasets online","title":"Major changes to the IEU GWAS resources for 2020","text":"new home GWAS summary data: https://gwas.mrcieu.ac.uk/.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"chromosome-and-position","dir":"Articles","previous_headings":"What is new","what":"Chromosome and position","title":"Major changes to the IEU GWAS resources for 2020","text":"variants mapped chromosome position (hg19/build37). can query based chromosome position coordinates. means either list <chr:pos> values, list <chr:pos1-pos2> ranges.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"indels-are-retained","dir":"Articles","previous_headings":"What is new","what":"INDELs are retained","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously excluding , now retained","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"multi-allelic-variants-are-retained","dir":"Articles","previous_headings":"What is new","what":"Multi-allelic variants are retained","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously excluding , now retained. warned extract variant multiple alleles may get one row variant.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"more-data","dir":"Articles","previous_headings":"What is new","what":"More data","title":"Major changes to the IEU GWAS resources for 2020","text":"Automated download EBI repository, automated upload system batch data processing system means data can added faster keep database current.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"error-messages-are-more-informative","dir":"Articles","previous_headings":"What is new","what":"Error messages are more informative","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously query database failed didn’t give reason, hopefully clarity regarding happening now. can also check status server : https://api.opengwas.io/api/","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"easier-programmatic-access-to-the-database","dir":"Articles","previous_headings":"What is new","what":"Easier programmatic access to the database","title":"Major changes to the IEU GWAS resources for 2020","text":"trying make flexible possible access data. TwoSampleMR R package previously programmatic way access data, now following options: ieugwasr R package: TwoSampleMR functions access data done calling package now. simple wrapper around API controls access database. ieugwaspy python package: Similar functionality ieugwasr (construction). API: can use API directly, e.g. building services applications.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"local-ld-operations","dir":"Articles","previous_headings":"What is new","what":"Local LD operations","title":"Major changes to the IEU GWAS resources for 2020","text":"now possible perform clumping, create LD matrices, using local LD reference dataset. can download one using : https://github.com/mrcieu/gwasglue#reference-datasets, create plink format dataset e.g. larger samples different ancestries. See LD clumping functions ieugwasr package details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"access-the-data-directly","dir":"Articles","previous_headings":"What is new","what":"Access the data directly","title":"Major changes to the IEU GWAS resources for 2020","text":"Previously data accessible database. Now data can downloaded “GWAS VCF” format https://gwas.mrcieu.ac.uk/. (IEU members can access data RDSF bluecrystal4 directly). means want perform large numerous operations, can HPC locally performant manner using data files directly. Please see gwasvcf R package work data.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"connect-the-data-to-different-analytical-tools","dir":"Articles","previous_headings":"What is new","what":"Connect the data to different analytical tools","title":"Major changes to the IEU GWAS resources for 2020","text":"Either data database, GWAS VCF files, can queried results translated formats bunch different R packages MR, colocalisation, fine mapping, etc. look gwasglue R package, see available . ’s still construction, feel free try , make suggestions, contribute code.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"key-links","dir":"Articles","previous_headings":"","what":"Key links","title":"Major changes to the IEU GWAS resources for 2020","text":"IEU GWAS database: https://gwas.mrcieu.ac.uk API IEU GWAS database: https://api.opengwas.io/api/ ieugwasr package, R access API: https://mrcieu.github.io/ieugwasr/ ieugwaspy package, python access API: https://github.com/MRCIEU/ieugwaspy/ (construction) gwasvcf package, R interface GWAS VCF files: https://mrcieu.github.io/gwasvcf/ pygwasvcf package, python interface GWAS VCF files: https://github.com/mrcieu/pygwasvcf (construction) gwasglue package, linking GWAS data various analytical methods: https://mrcieu.github.io/gwasglue/ (Functional, construction) gwas2vcf online tool, allowing users create GWAS VCF files summary data: https://github.com/MRCIEU/gwas2vcf","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"how-to-request-new-data","dir":"Articles","previous_headings":"","what":"How to request new data","title":"Major changes to the IEU GWAS resources for 2020","text":"setup github issues page : https://github.com/MRCIEU/opengwas-requests/issues Please visit make log new data requests, contribute new data.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","id":"backwards-compatibility","dir":"Articles","previous_headings":"","what":"Backwards compatibility","title":"Major changes to the IEU GWAS resources for 2020","text":"install new version TwoSampleMR, perform normal: update package just run remotes::install_github(\"MRCIEU/TwoSampleMR\") command . recommend using new version going forwards limited time enabling backwards compatibility, case middle analysis need reproduce old analysis. order use legacy version package database, install using:","code":"install.packages(\"remotes\") remotes::install_github(\"MRCIEU/TwoSampleMR\") install.packages(\"remotes\") remotes::install_github(\"MRCIEU/TwoSampleMR@0.4.26\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Harmonise data","text":"exposure data outcome data now obtained, e.g.: important harmonise effects. means effect SNP exposure effect SNP outcome must correspond allele. Note: IEU GWAS database contains data already harmonised, meaning non-effect allele aligned human genome reference sequence (build 37). ’s still recommended harmonise, principle everything forward strand effect alleles always relating allele. discrepancies arise multi-allelic variants represented different bi-allelic variants different studies. harmonise exposure outcome data, following: creates new data frame exposure data outcome data combined. 3 exposure traits 3 outcome traits 9 sets harmonisations performed - harmonising SNP effects exposure trait 1 outcome trait 1; exposure trait 1 outcome trait 2; .","code":"bmi_exp_dat <- extract_instruments(outcomes = 'ieu-a-2') chd_out_dat <- extract_outcome_data(snps = bmi_exp_dat$SNP, outcomes = 'ieu-a-7') dat <- harmonise_data(     exposure_dat = bmi_exp_dat,     outcome_dat = chd_out_dat ) #> Harmonising Body mass index || id:ieu-a-2 (ieu-a-2) and Coronary heart disease || id:ieu-a-7 (ieu-a-7)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"dealing-with-strand-issues","dir":"Articles","previous_headings":"","what":"Dealing with strand issues","title":"Harmonise data","text":"Recent GWASs typically present effects SNP reference allele forward strand. reference panels updated forward strand sometimes changes, GWASs years ago aren’t guaranteed using forward strand conventions. examples shown :","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"correct-unambigious","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Correct, unambigious","title":"Harmonise data","text":"effect allele exposure outcome ","code":"exposure effect = 0.5 effect allele = A other allele = G  outcome effect = 0.05 effect allele = A other allele = G"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"incorrect-reference-unambigious","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Incorrect reference, unambigious","title":"Harmonise data","text":"outcome GWAS presenting effect alternate allele reverse strand. need flip outcome effect 0.05 correspond allele exposure GWAS forward strand.","code":"exposure effect = 0.5 effect allele = A other allele = G  outcome effect = -0.05 effect allele = C other allele = T"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"ambiguous","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Ambiguous","title":"Harmonise data","text":"alleles correspond SNP, SNP discarded analysis.","code":"exposure effect = 0.5 effect allele = A other allele = G  outcome effect = -0.05 effect allele = A other allele = C"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"palindromic-snp-inferrable","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Palindromic SNP, inferrable","title":"Harmonise data","text":"alleles correspond, palindromic SNP, alleles forward strand reverse strand (/T forward T/reverse). However, allele frequency effect allele gives us information - outcome effect allele () forward strand expect low allele frequency, given high frequency (0.91) infer outcome GWAS presenting effect reverse strand alternative allele. flip effect 0.05 outcome GWAS.","code":"exposure effect = 0.5 effect allele = A other allele = T effect allele frequency = 0.11  outcome effect = -0.05 effect allele = A other allele = T effect allele frequency = 0.91"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"palindromic-snp-not-inferrable","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Palindromic SNP, not inferrable","title":"Harmonise data","text":"similar , except allele frequency longer gives us information strand. discard SNP. done palindromic SNPs minor allele frequency 0.42.","code":"exposure effect = 0.5 effect allele = A other allele = T effect allele frequency = 0.50  outcome effect = -0.05 effect allele = A other allele = T effect allele frequency = 0.50"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"options","dir":"Articles","previous_headings":"Dealing with strand issues","what":"Options","title":"Harmonise data","text":"three options harmonising data. Assume alleles presented forward strand Try infer forward strand alleles using allele frequency information Correct strand non-palindromic SNPs, drop palindromic SNPs default, harmonise_data function uses option 2, can modified using action argument, e.g. harmonise_data(exposure_dat, outcome_dat, action = 3).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/harmonise.html","id":"drop-duplicate-exposure-outcome-summary-sets","dir":"Articles","previous_headings":"","what":"Drop duplicate exposure-outcome summary sets","title":"Harmonise data","text":"data harmonisation, users may find dataset contains duplicate exposure-outcome summary sets. can arise, example, GWAS consortium released multiple results separate GWAS analyses trait. example, multiple GWAS summary datasets body mass index coronary heart disease: therefore multiple potential combinations body mass index coronary heart disease, likely lead duplicate MR analyses. recommend users prune datasets exposure-outcome combination highested expected power retained. can done selecting exposure-outcome summary set largest sample size outcome, using power_prune function: drops duplicate exposure-outcome sets smaller outcome sample size (number cases binary outcomes). Remaining duplicates dropped basis exposure sample size. However, large number SNPs available instrument exposure, outcome GWAS better SNP coverage may provide better power outcome GWAS larger sample size. can occur, example, larger outcome GWAS used targeted genotyping array. instances, may better prune studies basis instrument strength (.e. variation exposure explained instrumental SNPs) well sample size. can done setting method argument 2: procedure drops duplicate exposure-outcome sets basis instrument strength sample size, assumes SNP-exposure effects correspond continuous trait normal distribution (.e. exposure binary). SNP-outcome effects can correspond either binary continuous trait (default behaviour assume binary distribution). exposure binary method 1 used.","code":"ao <- available_outcomes() ao[ao$trait == \"Body mass index\", c(\"trait\", \"id\", \"pmid\", \"author\", \"sample_size\", \"nsnp\")] #>                 trait                 id     pmid                    author #> 3958  Body mass index ebi-a-GCST90103751 35051171                   Wong HS #> 4015  Body mass index ebi-a-GCST90095039 35399580 Fern<U+00E1>ndez-Rhodes L #> 4020  Body mass index ebi-a-GCST90095034 35399580 Fern<U+00E1>ndez-Rhodes L #> 6032  Body mass index ebi-a-GCST90029007 29892013                    Loh PR #> 6821  Body mass index ebi-a-GCST90025994 34226706                 Barton AR #> 7045  Body mass index ebi-a-GCST90018947 34594039                  Sakaue S #> 7259  Body mass index ebi-a-GCST90018727 34594039                  Sakaue S #> 10738 Body mass index           ieu-a-94 23754948                Randall JC #> 12717 Body mass index            ieu-a-2 25673413                  Locke AE #> 14254 Body mass index           ieu-a-95 23754948                Randall JC #> 16676 Body mass index          ieu-a-974 25673413                  Locke AE #> 19343 Body mass index            bbj-a-3 28892062                Ishigaki K #> 26475 Body mass index   ebi-a-GCST006368 30108127               Hoffmann TJ #> 28065 Body mass index         ieu-b-4815       NA                   Howe LJ #> 28419 Body mass index            bbj-a-2 28892062                Ishigaki K #> 32371 Body mass index         ieu-b-4816       NA                   Howe LJ #> 33869 Body mass index          ieu-a-785 25673413                  Locke AE #> 39217 Body mass index   ebi-a-GCST002783 25673413                  Locke AE #> 40065 Body mass index            bbj-a-1 28892062                Ishigaki K #> 43262 Body mass index   ebi-a-GCST004904 28892062                 Akiyama M #> 43743 Body mass index   ebi-a-GCST006802 26961502                   Wood AR #> 47894 Body mass index          ieu-a-835 25673413                  Locke AE #> 48917 Body mass index   ebi-a-GCST008025 31217584                 Wojcik GL #> 49208 Body mass index         ieu-a-1089 26961502                      Wood #>       sample_size     nsnp #> 3958        21930  6370138 #> 4015       330793  2401077 #> 4020        56161  8764141 #> 6032       532396 11973091 #> 6821       457756  4238669 #> 7045       359983 19066885 #> 7259       163835 12502877 #> 10738       60586  2736876 #> 12717      339224  2555511 #> 14254       73137  2736876 #> 16676      171977  2494613 #> 19343       72390  6108953 #> 26475      315347 27854527 #> 28065       51852       NA #> 28419       85894  6108953 #> 32371       99998  7191606 #> 33869      152893  2477659 #> 39217      236781  2529499 #> 40065      158284  5961600 #> 43262      158284  5952516 #> 43743      119688  8580466 #> 47894      322154  2554668 #> 48917       21955 34343880 #> 49208      120286  8654252 ao[ao$trait == \"Coronary heart disease\", c(\"trait\", \"id\", \"pmid\", \"author\", \"ncase\", \"ncontrol\", \"nsnp\")] #>                        trait               id     pmid      author ncase #> 14897 Coronary heart disease          ieu-a-7 26343387      Nikpay 60801 #> 23614 Coronary heart disease          ieu-a-9 23202125    Deloukas 63746 #> 27414 Coronary heart disease ebi-a-GCST000998 21378990 Schunkert H 22233 #> 38602 Coronary heart disease          ieu-a-8 21378990 Schunkert H 22233 #> 45294 Coronary heart disease          ieu-a-6 21378988       Peden 15420 #>       ncontrol    nsnp #> 14897   123504 9455779 #> 23614   130681   79129 #> 27414    64762 2415020 #> 38602    64762 2420361 #> 45294    15062  540233 dat <- power_prune(dat, method = 1, dist.outcome = \"binary\") dat <- power_prune(dat, method = 2, dist.outcome = \"binary\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/introduction.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Introduction","text":"Two sample Mendelian randomisation (2SMR) method estimate causal effect exposure outcome using summary statistics genome wide association studies (GWAS). Though conceptually straightforward, number steps required perform analysis properly, can cumbersome. TwoSampleMR package aims make easy combining three important components data management harmonisation statistical routines estimate causal effects connection large repository actual GWAS summary statistics needed perform analyses. general principles (G. Davey Smith Ebrahim 2003; George Davey Smith Hemani 2014), statistical methods (Pierce Burgess 2013; Bowden, Davey Smith, Burgess 2015) can found elsewhere, just outline use R package. package uses ieugwasr package connect database thousands complete GWAS summary data.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/introduction.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction","text":"install directly GitHub repository following: don’t remotes package install CRAN using install.packages(\"remotes\").","code":"library(remotes) install_github(\"MRCIEU/TwoSampleMR\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/introduction.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction","text":"workflow performing MR follows: Select instruments exposure (perform LD clumping necessary) Extract instruments IEU GWAS database outcomes interest Harmonise effect sizes instruments exposures outcomes reference allele Perform MR analysis, sensitivity analyses, create plots, compile reports diagrammatic overview shown :  basic analysis, e.g. causal effect body mass index coronary heart disease, looks like : step documented pages documentation.","code":"library(TwoSampleMR)  # List available GWASs ao <- available_outcomes()  # Get instruments exposure_dat <- extract_instruments(\"ieu-a-2\")  # Get effects of instruments on outcome outcome_dat <- extract_outcome_data(snps=exposure_dat$SNP, outcomes = \"ieu-a-7\")  # Harmonise the exposure and outcome data dat <- harmonise_data(exposure_dat, outcome_dat)  # Perform MR res <- mr(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/introduction.html","id":"authentication","dir":"Articles","previous_headings":"","what":"Authentication","title":"Introduction","text":"statistical methods TwoSampleMR can used data, number functions connect OpenGWAS database data extraction. OpenGWAS data access functions require authentication. Authentication changing main differences : Authentication required queries OpenGWAS everyone (.e. anonymous usage) longer using Google Oauth2. replaced simple API key system. Detailed information given : https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication.","code":""},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"available-studies-in-ieu-gwas-database","dir":"Articles","previous_headings":"","what":"Available studies in IEU GWAS database","title":"Outcome data","text":"IEU GWAS database (IGD) contains complete GWAS summary statistics large number studies. can browse : https://gwas.mrcieu.ac.uk/ obtain details available GWASs programmatically following: information authentication see https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication. available_outcomes function returns table available studies database. study unique ID. e.g.","code":"ao <- available_outcomes() head(ao) #>           id         trait ncase group_name year       author consortium #> 1 ieu-b-5103 Schizophrenia  1234     public 2022 Trubetskoy V        PGC #> 2 ieu-b-5102 Schizophrenia 52017     public 2022 Trubetskoy V        PGC #> 3 ieu-b-5101 Schizophrenia 12305     public 2022 Trubetskoy V        PGC #> 4 ieu-b-5100 Schizophrenia 64322     public 2022 Trubetskoy V        PGC #> 5 ieu-b-5099 Schizophrenia 76755     public 2022 Trubetskoy V        PGC #> 6 ieu-b-5098 Schizophrenia  5998     public 2022 Trubetskoy V        PGC #>                 sex     pmid                         population  unit #> 1 Males and Females 35396580         Hispanic or Latin American logOR #> 2 Males and Females 35396580                           European logOR #> 3 Males and Females 35396580                         East Asian logOR #> 4 Males and Females 35396580                              Mixed logOR #> 5 Males and Females 35396580                              Mixed logOR #> 6 Males and Females 35396580 African American or Afro-Caribbean logOR #>   sample_size       build ncontrol category subcategory      ontology #> 1        4324 HG19/GRCh37     3090  Disease          NA MONDO:0005090 #> 2      127906 HG19/GRCh37    75889  Disease          NA MONDO:0005090 #> 3       27363 HG19/GRCh37    15058  Disease          NA MONDO:0005090 #> 4      155269 HG19/GRCh37    90947  Disease          NA MONDO:0005090 #> 5      320404 HG19/GRCh37   243649  Disease          NA MONDO:0005090 #> 6        9824 HG19/GRCh37     3826  Disease          NA MONDO:0005090 #>                                                                      note mr #> 1                                                                    <NA> NA #> 2                                                                    <NA> NA #> 3                                                                    <NA> NA #> 4                            Core - East Asian and European meta analysis NA #> 5 Primary - meta analysis of Eur, East Asian, African American and Latino NA #> 6                                                                    <NA> NA #>   nsnp  doi coverage study_design priority sd #> 1   NA <NA>     <NA>         <NA>       NA NA #> 2   NA <NA>     <NA>         <NA>       NA NA #> 3   NA <NA>     <NA>         <NA>       NA NA #> 4   NA <NA>     <NA>         <NA>       NA NA #> 5   NA <NA>     <NA>         <NA>       NA NA #> 6   NA <NA>     <NA>         <NA>       NA NA head(subset(ao, select = c(trait, id))) #>           trait         id #> 1 Schizophrenia ieu-b-5103 #> 2 Schizophrenia ieu-b-5102 #> 3 Schizophrenia ieu-b-5101 #> 4 Schizophrenia ieu-b-5100 #> 5 Schizophrenia ieu-b-5099 #> 6 Schizophrenia ieu-b-5098"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"extracting-particular-snps-from-particular-studies","dir":"Articles","previous_headings":"","what":"Extracting particular SNPs from particular studies","title":"Outcome data","text":"want perform MR BMI coronary heart disease, need identify SNPs influence BMI, extract SNPs GWAS coronary heart disease. Let’s get Locke et al 2014 instruments BMI example: now need find suitable GWAS coronary heart disease. can search available studies: recent CARDIOGRAM GWAS ID number ieu--7. can extract BMI SNPs GWAS follows: extract_outcome_data() function flexible. snps argument requires array rsIDs, outcomes argument can vector outcomes, e.g. extract two SNPs outcomes ieu--2 ieu--7.","code":"bmi_exp_dat <- extract_instruments(outcomes = 'ieu-a-2') head(bmi_exp_dat) #>   pval.exposure samplesize.exposure chr.exposure se.exposure beta.exposure #> 1   2.18198e-08              339152            1      0.0030       -0.0168 #> 2   4.56773e-11              339065            1      0.0031        0.0201 #> 3   5.05941e-14              313621            1      0.0087        0.0659 #> 4   5.45205e-10              338768            1      0.0029        0.0181 #> 5   1.88018e-28              338123            1      0.0030        0.0331 #> 6   2.28718e-40              339078            1      0.0037        0.0497 #>   pos.exposure id.exposure        SNP effect_allele.exposure #> 1     47684677     ieu-a-2   rs977747                      G #> 2     78048331     ieu-a-2 rs17381664                      C #> 3    110082886     ieu-a-2  rs7550711                      T #> 4    201784287     ieu-a-2  rs2820292                      C #> 5     72837239     ieu-a-2  rs7531118                      C #> 6    177889480     ieu-a-2   rs543874                      G #>   other_allele.exposure eaf.exposure                      exposure #> 1                     T       0.5333 Body mass index || id:ieu-a-2 #> 2                     T       0.4250 Body mass index || id:ieu-a-2 #> 3                     C       0.0339 Body mass index || id:ieu-a-2 #> 4                     A       0.5083 Body mass index || id:ieu-a-2 #> 5                     T       0.6083 Body mass index || id:ieu-a-2 #> 6                     A       0.2667 Body mass index || id:ieu-a-2 #>   mr_keep.exposure pval_origin.exposure data_source.exposure #> 1             TRUE             reported                  igd #> 2             TRUE             reported                  igd #> 3             TRUE             reported                  igd #> 4             TRUE             reported                  igd #> 5             TRUE             reported                  igd #> 6             TRUE             reported                  igd ao[grepl(\"heart disease\", ao$trait), ] #>                                 id #> 7958                 finn-b-I9_CHD #> 10829                   ukb-b-3983 #> 12268                ukb-e-I25_AFR #> 14221                   ukb-b-2205 #> 14897                      ieu-a-7 #> 15028 finn-b-I9_SECONDRIGHT_EXNONE #> 16883                   ukb-b-7436 #> 18046                    ukb-a-534 #> 18048                ukb-e-I25_CSA #> 20207           finn-b-I9_OTHHEART #> 22249         finn-b-I9_VHD_EXNONE #> 22725          finn-b-I9_PULMHEART #> 23614                      ieu-a-9 #> 24603           finn-b-FG_OTHHEART #> 27414             ebi-a-GCST000998 #> 33264          finn-b-FG_PULMHEART #> 35220                 ukb-d-I9_CHD #> 35231        finn-b-I9_OTHILLHEART #> 36931                   ukb-b-8184 #> 37302 finn-b-I9_OTHILLHEART_EXNONE #> 37894                   ukb-b-1668 #> 38319                finn-b-I9_IHD #> 38448            finn-b-I9_RHEUFEV #> 38602                      ieu-a-8 #> 41994          finn-b-I9_ISCHHEART #> 42095                 ukb-d-I9_IHD #> 42882        finn-b-I9_SECONDRIGHT #> 43747           ukb-d-I9_CHD_NOREV #> 45294                      ieu-a-6 #> 46126                finn-b-I9_VHD #> 46689                  ukb-b-16606 #>                                                                                                                           trait #> 7958                                                                                         Major coronary heart disease event #> 10829                                                Diagnoses - main ICD10: I25.9 Chronic ischaemic heart disease, unspecified #> 12268                                                                                       I25 Chronic ischaemic heart disease #> 14221 Diagnoses - secondary ICD10: Z82.4 Family history of ischaemic heart disease and other diseases of the circulatory system #> 14897                                                                                                    Coronary heart disease #> 15028                                                                      Secondary right heart disease (no controls excluded) #> 16883                                                          Diagnoses - secondary ICD10: I25.1 Atherosclerotic heart disease #> 18046                                                               Diagnoses - main ICD10: I25 Chronic ischaemic heart disease #> 18048                                                                                       I25 Chronic ischaemic heart disease #> 20207                                                                                        Other heart diseases (I9_OTHHEART) #> 22249                                                   Valvular heart disease including rheumatic fever (no controls excluded) #> 22725                                                                Pulmonary heart disease, diseases of pulmonary circulation #> 23614                                                                                                    Coronary heart disease #> 24603                                                                                        Other heart diseases (FG_OTHHEART) #> 27414                                                                                                    Coronary heart disease #> 33264                                                                                                   Pulmonary heart disease #> 35220                                                                                        Major coronary heart disease event #> 35231                                                                                       Other or ill-defined heart diseases #> 36931                                           Diagnoses - secondary ICD10: I25.9 Chronic ischaemic heart disease, unspecified #> 37302                                                                Other or ill-defined heart diseases (no controls excluded) #> 37894                                                               Diagnoses - main ICD10: I25.1 Atherosclerotic heart disease #> 38319                                                                                  Ischaemic heart disease, wide definition #> 38448                                                                                        Rheumatic fever incl heart disease #> 38602                                                                                                    Coronary heart disease #> 41994                                                                                                   Ischemic heart diseases #> 42095                                                                                  Ischaemic heart disease, wide definition #> 42882                                                                                             Secondary right heart disease #> 43747                                                           Major coronary heart disease event excluding revascularizations #> 45294                                                                                                    Coronary heart disease #> 46126                                                                          Valvular heart disease including rheumatic fever #> 46689                                         Diagnoses - secondary ICD10: I25.8 Other forms of chronic ischaemic heart disease #>       ncase group_name year       author        consortium               sex #> 7958  21012     public 2021           NA                NA Males and Females #> 10829  1195     public 2018 Ben Elsworth           MRC-IEU Males and Females #> 12268   302     public 2020 Pan-UKB team                NA Males and Females #> 14221  9330     public 2018 Ben Elsworth           MRC-IEU Males and Females #> 14897 60801     public 2015       Nikpay CARDIoGRAMplusC4D Males and Females #> 15028   428     public 2021           NA                NA Males and Females #> 16883  5771     public 2018 Ben Elsworth           MRC-IEU Males and Females #> 18046  8755     public 2017        Neale         Neale Lab Males and Females #> 18048  1205     public 2020 Pan-UKB team                NA Males and Females #> 20207 62081     public 2021           NA                NA Males and Females #> 22249 38209     public 2021           NA                NA Males and Females #> 22725  4564     public 2021           NA                NA Males and Females #> 23614 63746     public 2013     Deloukas CARDIoGRAMplusC4D Males and Females #> 24603 58173     public 2021           NA                NA Males and Females #> 27414 22233     public 2011  Schunkert H                NA                NA #> 33264  4185     public 2021           NA                NA Males and Females #> 35220 10157     public 2018    Neale lab                NA Males and Females #> 35231   713     public 2021           NA                NA Males and Females #> 36931  5861     public 2018 Ben Elsworth           MRC-IEU Males and Females #> 37302   713     public 2021           NA                NA Males and Females #> 37894 12171     public 2018 Ben Elsworth           MRC-IEU Males and Females #> 38319 31640     public 2021           NA                NA Males and Females #> 38448   573     public 2021           NA                NA Males and Females #> 38602 22233     public 2011  Schunkert H        CARDIoGRAM Males and Females #> 41994 30952     public 2021           NA                NA Males and Females #> 42095 20857     public 2018    Neale lab                NA Males and Females #> 42882   428     public 2021           NA                NA Males and Females #> 43747 10157     public 2018    Neale lab                NA Males and Females #> 45294 15420     public 2011        Peden               C4D Males and Females #> 46126 38209     public 2021           NA                NA Males and Females #> 46689  5738     public 2018 Ben Elsworth           MRC-IEU Males and Females #>           pmid                         population     unit sample_size #> 7958        NA                           European       NA          NA #> 10829       NA                           European       SD      463010 #> 12268       NA African American or Afro-Caribbean       NA        6636 #> 14221       NA                           European       SD      463010 #> 14897 26343387                              Mixed log odds      184305 #> 15028       NA                           European       NA          NA #> 16883       NA                           European       SD      463010 #> 18046       NA                           European       SD      337199 #> 18048       NA                        South Asian       NA        8876 #> 20207       NA                           European       NA          NA #> 22249       NA                           European       NA          NA #> 22725       NA                           European       NA          NA #> 23614 23202125                              Mixed log odds      194427 #> 24603       NA                           European       NA          NA #> 27414 21378990                           European    logOR       86995 #> 33264       NA                           European       NA          NA #> 35220       NA                           European       NA      361194 #> 35231       NA                           European       NA          NA #> 36931       NA                           European       SD      463010 #> 37302       NA                           European       NA          NA #> 37894       NA                           European       SD      463010 #> 38319       NA                           European       NA          NA #> 38448       NA                           European       NA          NA #> 38602 21378990                           European log odds       86995 #> 41994       NA                           European       NA          NA #> 42095       NA                           European       NA      361194 #> 42882       NA                           European       NA          NA #> 43747       NA                           European       NA      361194 #> 45294 21378988                              Mixed log odds       30482 #> 46126       NA                           European       NA          NA #> 46689       NA                           European       SD      463010 #>             build ncontrol category    subcategory ontology #> 7958  HG19/GRCh37   197780   Binary             NA       NA #> 10829 HG19/GRCh37   461815   Binary             NA       NA #> 12268 HG19/GRCh37     6334   Binary             NA       NA #> 14221 HG19/GRCh37   453680   Binary             NA       NA #> 14897 HG19/GRCh37   123504  Disease Cardiovascular       NA #> 15028 HG19/GRCh37   218364   Binary             NA       NA #> 16883 HG19/GRCh37   457239   Binary             NA       NA #> 18046 HG19/GRCh37   328444       NA             NA       NA #> 18048 HG19/GRCh37     7671   Binary             NA       NA #> 20207 HG19/GRCh37   156711   Binary             NA       NA #> 22249 HG19/GRCh37   180583   Binary             NA       NA #> 22725 HG19/GRCh37   214228   Binary             NA       NA #> 23614 HG19/GRCh37   130681  Disease Cardiovascular       NA #> 24603 HG19/GRCh37   160619   Binary             NA       NA #> 27414 HG19/GRCh37    64762       NA             NA       NA #> 33264 HG19/GRCh37   214607   Binary             NA       NA #> 35220 HG19/GRCh37   351037   Binary             NA       NA #> 35231 HG19/GRCh37   156711   Binary             NA       NA #> 36931 HG19/GRCh37   457149   Binary             NA       NA #> 37302 HG19/GRCh37   218079   Binary             NA       NA #> 37894 HG19/GRCh37   450839   Binary             NA       NA #> 38319 HG19/GRCh37   187152   Binary             NA       NA #> 38448 HG19/GRCh37   218219   Binary             NA       NA #> 38602 HG19/GRCh37    64762  Disease Cardiovascular       NA #> 41994 HG19/GRCh37   187840   Binary             NA       NA #> 42095 HG19/GRCh37   340337   Binary             NA       NA #> 42882 HG19/GRCh37   214228   Binary             NA       NA #> 43747 HG19/GRCh37   351037   Binary             NA       NA #> 45294 HG19/GRCh37    15062  Disease Cardiovascular       NA #> 46126 HG19/GRCh37   156711   Binary             NA       NA #> 46689 HG19/GRCh37   457272   Binary             NA       NA #>                                                                                       note #> 7958                                                                                I9_CHD #> 10829 41202#I259: Output from GWAS pipeline using Phesant derived variables from UKBiobank #> 12268                                                                                   NA #> 14221 41204#Z824: Output from GWAS pipeline using Phesant derived variables from UKBiobank #> 14897                                                                                 <NA> #> 15028                                                                I9_SECONDRIGHT_EXNONE #> 16883 41204#I251: Output from GWAS pipeline using Phesant derived variables from UKBiobank #> 18046                                                                                   NA #> 18048                                                                                   NA #> 20207                                                                          I9_OTHHEART #> 22249                                                                        I9_VHD_EXNONE #> 22725                                                                         I9_PULMHEART #> 23614                                                                                 <NA> #> 24603                                                                          FG_OTHHEART #> 27414                                                                                   NA #> 33264                                                                         FG_PULMHEART #> 35220                                                                                   NA #> 35231                                                                       I9_OTHILLHEART #> 36931 41204#I259: Output from GWAS pipeline using Phesant derived variables from UKBiobank #> 37302                                                                I9_OTHILLHEART_EXNONE #> 37894 41202#I251: Output from GWAS pipeline using Phesant derived variables from UKBiobank #> 38319                                                                               I9_IHD #> 38448                                                                           I9_RHEUFEV #> 38602                                                                                 <NA> #> 41994                                                                         I9_ISCHHEART #> 42095                                                                                   NA #> 42882                                                                       I9_SECONDRIGHT #> 43747                                                                                   NA #> 45294                                                                                 <NA> #> 46126                                                                               I9_VHD #> 46689 41204#I258: Output from GWAS pipeline using Phesant derived variables from UKBiobank #>       mr     nsnp  doi coverage study_design priority sd #> 7958   1 16380466 <NA>     <NA>         <NA>        0 NA #> 10829  1  9851867 <NA>     <NA>         <NA>        1 NA #> 12268  1 15478580 <NA>     <NA>         <NA>        0 NA #> 14221  1  9851867 <NA>     <NA>         <NA>        1 NA #> 14897  1  9455779 <NA>     <NA>         <NA>        1 NA #> 15028  1 16380466 <NA>     <NA>         <NA>        0 NA #> 16883  1  9851867 <NA>     <NA>         <NA>        1 NA #> 18046  1 10894596 <NA>     <NA>         <NA>        1 NA #> 18048  1  9811287 <NA>     <NA>         <NA>        0 NA #> 20207  1 16380466 <NA>     <NA>         <NA>        0 NA #> 22249  1 16380466 <NA>     <NA>         <NA>        0 NA #> 22725  1 16380466 <NA>     <NA>         <NA>        0 NA #> 23614  1    79129 <NA>     <NA>         <NA>        1 NA #> 24603  1 16380466 <NA>     <NA>         <NA>        0 NA #> 27414  1  2415020 <NA>     <NA>         <NA>        0 NA #> 33264  1 16380466 <NA>     <NA>         <NA>        0 NA #> 35220  1 13295130 <NA>     <NA>         <NA>        0 NA #> 35231  1 16380177 <NA>     <NA>         <NA>        0 NA #> 36931  1  9851867 <NA>     <NA>         <NA>        1 NA #> 37302  1 16380466 <NA>     <NA>         <NA>        0 NA #> 37894  1  9851867 <NA>     <NA>         <NA>        1 NA #> 38319  1 16380466 <NA>     <NA>         <NA>        0 NA #> 38448  1 16380466 <NA>     <NA>         <NA>        0 NA #> 38602  1  2420361 <NA>     <NA>         <NA>        2 NA #> 41994  1 16380466 <NA>     <NA>         <NA>        0 NA #> 42095  1 13586589 <NA>     <NA>         <NA>        0 NA #> 42882  1 16380459 <NA>     <NA>         <NA>        0 NA #> 43747  1 13295130 <NA>     <NA>         <NA>        0 NA #> 45294  1   540233 <NA>     <NA>         <NA>        3 NA #> 46126  1 16380358 <NA>     <NA>         <NA>        0 NA #> 46689  1  9851867 <NA>     <NA>         <NA>        1 NA chd_out_dat1 <- extract_outcome_data(     snps = bmi_exp_dat$SNP,     outcomes = 'ieu-a-7' ) chd_out_dat2 <- extract_outcome_data(     snps = c(\"rs234\", \"rs17097147\"),     outcomes = c('ieu-a-2', 'ieu-a-7') )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"ld-proxies","dir":"Articles","previous_headings":"","what":"LD proxies","title":"Outcome data","text":"default particular requested SNP present outcome GWAS SNP (proxy) LD requested SNP (target) searched instead. LD proxies defined using 1000 genomes European sample data. effect proxy SNP outcome returned, along proxy SNP, effect allele proxy SNP, corresponding allele (phase) target SNP. parameters handling LD proxies follows: proxies = TRUE FALSE (TRUE default) rsq = numeric value minimum rsq find proxy. Default 0.8, minimum 0.6 palindromes = Allow palindromic SNPs? Default 1 (yes) maf_threshold = palindromes allowed maximum minor allele frequency palindromes allowed? Default 0.3.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"using-local-gwas-summary-data","dir":"Articles","previous_headings":"","what":"Using local GWAS summary data","title":"Outcome data","text":"GWAS summary data present IEU GWAS database, can still used perform analysis. Supposing GWAS summary file called “gwas_summary.csv” e.g. 2 million rows looks like : extract exposure SNPs data, use following command: returns outcome data frame SNPs requested (SNPs present “gwas_summary.csv” file).","code":"rsid,effect,SE,a1,a2,a1_freq,p-value,Units,Gene,n rs10767664,0.19,0.030612245,A,T,0.78,5.00E-26,kg/m2,BDNF,225238 rs13078807,0.1,0.020408163,G,A,0.2,4.00E-11,kg/m2,CADM2,221431 rs1514175,0.07,0.020408163,A,G,0.43,8.00E-14,kg/m2,TNNI3K,207641 rs1558902,0.39,0.020408163,A,T,0.42,5.00E-120,kg/m2,FTO,222476 ... ... outcome_dat <- read_outcome_data(     snps = bmi_exp_dat$SNP,     filename = \"gwas_summary.csv\",     sep = \",\",     snp_col = \"rsid\",     beta_col = \"effect\",     se_col = \"SE\",     effect_allele_col = \"a1\",     other_allele_col = \"a2\",     eaf_col = \"a1_freq\",     pval_col = \"p-value\",     units_col = \"Units\",     gene_col = \"Gene\",     samplesize_col = \"n\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"outcome-data-format","dir":"Articles","previous_headings":"","what":"Outcome data format","title":"Outcome data","text":"extract_outcome_data function returns table SNP effects requested SNPs requested outcomes. format data similar exposure data format, except main columns follows: SNP beta.outcome se.outcome samplesize.outcome ncase.outcome ncontrol.outcome pval.outcome eaf.outcome effect_allele.outcom other_allele.outcome units.outcome outcome consortium.outcome year.outcome pmid.outcome id.outcome originalname.outcome proxy.outcome target_snp.outcome proxy_snp.outcome target_a1.outcome target_a2.outcome proxy_a1.outcome proxy_a2.outcome mr_keep.outcome data_source.outcome","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/outcome.html","id":"more-advanced-use-of-local-data","dir":"Articles","previous_headings":"","what":"More advanced use of local data","title":"Outcome data","text":"developed summary data format called “GWAS VCF”, designed store GWAS results strict performant way. possible use format TwoSampleMR package. Going avenue also allows use LD proxy functionality using LD reference files (ones provide). details, see package explains format query R: https://github.com/mrcieu/gwasvcf package connect data packages including TwoSampleMR https://github.com/MRCIEU/gwasglue","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Perform MR","text":"Let’s continue example BMI CHD: exposure outcome data harmonised, effects standard errors instrument SNP available exposure outcome traits. can use information perform Mendelian randomisation. , simply run: returns data frame estimates causal effect exposure outcome range different MR methods. multiple exposures multiple outcomes dat, mr() function perform MR method combination exposure-outcome traits.","code":"bmi_exp_dat <- extract_instruments(outcomes = 'ieu-a-2') chd_out_dat <- extract_outcome_data(snps = bmi_exp_dat$SNP, outcomes = 'ieu-a-7') dat <- harmonise_data(bmi_exp_dat, chd_out_dat) #> Harmonising Body mass index || id:ieu-a-2 (ieu-a-2) and Coronary heart disease || id:ieu-a-7 (ieu-a-7) res <- mr(dat) #> Analysing 'ieu-a-2' on 'ieu-a-7' res #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 3     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 4     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 5     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method nsnp         b #> 1 Body mass index || id:ieu-a-2                  MR Egger   79 0.5024935 #> 2 Body mass index || id:ieu-a-2           Weighted median   79 0.3870065 #> 3 Body mass index || id:ieu-a-2 Inverse variance weighted   79 0.4459091 #> 4 Body mass index || id:ieu-a-2               Simple mode   79 0.3401554 #> 5 Body mass index || id:ieu-a-2             Weighted mode   79 0.3790910 #>           se         pval #> 1 0.14396056 8.012590e-04 #> 2 0.07639889 4.071091e-07 #> 3 0.05898302 4.032020e-14 #> 4 0.15001315 2.612742e-02 #> 5 0.10221374 3.881092e-04"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"mr-methods","dir":"Articles","previous_headings":"","what":"MR methods","title":"Perform MR","text":"list available MR methods can obtained: perform , can specified mr() function, e.g. perform MR Egger regression Inverse variance weighted methods, default, methods labelled TRUE use_by_default column used mr() function.","code":"mr_method_list() #>                              obj #> 1                  mr_wald_ratio #> 2               mr_two_sample_ml #> 3            mr_egger_regression #> 4  mr_egger_regression_bootstrap #> 5               mr_simple_median #> 6             mr_weighted_median #> 7   mr_penalised_weighted_median #> 8                         mr_ivw #> 9                  mr_ivw_radial #> 10                    mr_ivw_mre #> 11                     mr_ivw_fe #> 12                mr_simple_mode #> 13              mr_weighted_mode #> 14         mr_weighted_mode_nome #> 15           mr_simple_mode_nome #> 16                       mr_raps #> 17                       mr_sign #> 18                        mr_uwr #>                                                         name PubmedID #> 1                                                 Wald ratio          #> 2                                         Maximum likelihood          #> 3                                                   MR Egger 26050253 #> 4                                       MR Egger (bootstrap) 26050253 #> 5                                              Simple median          #> 6                                            Weighted median          #> 7                                  Penalised weighted median          #> 8                                  Inverse variance weighted          #> 9                                                 IVW radial          #> 10 Inverse variance weighted (multiplicative random effects)          #> 11                 Inverse variance weighted (fixed effects)          #> 12                                               Simple mode          #> 13                                             Weighted mode          #> 14                                      Weighted mode (NOME)          #> 15                                        Simple mode (NOME)          #> 16                      Robust adjusted profile score (RAPS)          #> 17                                     Sign concordance test          #> 18                                     Unweighted regression          #>                                                    Description use_by_default #> 1                                                                        TRUE #> 2                                                                       FALSE #> 3                                                                        TRUE #> 4                                                                       FALSE #> 5                                                                       FALSE #> 6                                                                        TRUE #> 7                                                                       FALSE #> 8                                                                        TRUE #> 9                                                                       FALSE #> 10                                                                      FALSE #> 11                                                                      FALSE #> 12                                                                       TRUE #> 13                                                                       TRUE #> 14                                                                      FALSE #> 15                                                                      FALSE #> 16                                                                      FALSE #> 17 Tests for concordance of signs between exposure and outcome          FALSE #> 18                                     Doesn't use any weights          FALSE #>    heterogeneity_test #> 1               FALSE #> 2                TRUE #> 3                TRUE #> 4               FALSE #> 5               FALSE #> 6               FALSE #> 7               FALSE #> 8                TRUE #> 9                TRUE #> 10              FALSE #> 11              FALSE #> 12              FALSE #> 13              FALSE #> 14              FALSE #> 15              FALSE #> 16              FALSE #> 17              FALSE #> 18               TRUE mr(dat, method_list = c(\"mr_egger_regression\", \"mr_ivw\")) #> Analysing 'ieu-a-2' on 'ieu-a-7' #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method nsnp         b #> 1 Body mass index || id:ieu-a-2                  MR Egger   79 0.5024935 #> 2 Body mass index || id:ieu-a-2 Inverse variance weighted   79 0.4459091 #>           se        pval #> 1 0.14396056 8.01259e-04 #> 2 0.05898302 4.03202e-14"},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"heterogeneity-statistics","dir":"Articles","previous_headings":"Sensitivity analyses","what":"Heterogeneity statistics","title":"Perform MR","text":"MR methods can also perform tests heterogeneity. obtain statistics: mr() function, mr_heterogeneity() function can take argument perform heterogeneity tests using specified methods, e.g.","code":"mr_heterogeneity(dat) #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method        Q Q_df #> 1 Body mass index || id:ieu-a-2                  MR Egger 143.3046   77 #> 2 Body mass index || id:ieu-a-2 Inverse variance weighted 143.6508   78 #>         Q_pval #> 1 6.841585e-06 #> 2 8.728420e-06 mr_heterogeneity(dat, method_list = c(\"mr_egger_regression\", \"mr_ivw\")) #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method        Q Q_df #> 1 Body mass index || id:ieu-a-2                  MR Egger 143.3046   77 #> 2 Body mass index || id:ieu-a-2 Inverse variance weighted 143.6508   78 #>         Q_pval #> 1 6.841585e-06 #> 2 8.728420e-06"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"horizontal-pleiotropy","dir":"Articles","previous_headings":"Sensitivity analyses","what":"Horizontal pleiotropy","title":"Perform MR","text":"intercept term MR Egger regression can useful indication whether directional horizontal pleiotropy driving results MR analysis. can obtained follows:","code":"mr_pleiotropy_test(dat) #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure egger_intercept          se      pval #> 1 Body mass index || id:ieu-a-2    -0.001719304 0.003985962 0.6674266"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"single-snp-analysis","dir":"Articles","previous_headings":"Sensitivity analyses","what":"Single SNP analysis","title":"Perform MR","text":"obtain MR estimates using SNPs singly can following: returns data.frame results similar output mr() except performs analysis multiple times exposure-outcome combination - time using different single SNP perform analysis. method used perform single SNP MR Wald ratio default, though can changed, e.g. use fixed effects meta analysis method instead: mr_singlesnp() function calculates full MR using available SNPs well, default uses IVW MR Egger methods. can specified : perform maximum likelihood method combined test.","code":"res_single <- mr_singlesnp(dat) res_single <- mr_singlesnp(dat, single_method = \"mr_meta_fixed\") res_single <- mr_singlesnp(dat, all_method = \"mr_two_sample_ml\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"leave-one-out-analysis","dir":"Articles","previous_headings":"Sensitivity analyses","what":"Leave-one-out analysis","title":"Perform MR","text":"possible perform leave-one-analysis, MR performed leaving SNP turn, identify single SNP driving association. default method used inverse variance weighted method, can changed using method argument.","code":"res_loo <- mr_leaveoneout(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"plots","dir":"Articles","previous_headings":"","what":"Plots","title":"Perform MR","text":"ways visualise results, listed ","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"scatter-plot","dir":"Articles","previous_headings":"Plots","what":"Scatter plot","title":"Perform MR","text":"can depict relationship SNP effects exposure SNP effects outcome using scatter plot. scatter plot created exposure-outcome test, stored p1 list plots. example, plot first scatter plot:  see many plots : Lines drawn method used mr(dat), slope line corresponding estimated causal effect. limit lines drawn, simply specify desired methods, e.g. draw MR Egger IVW: possible save plot using ggsave() function ggplot2 package, e.g. save pdf save png See ?ggplot2::ggsave info.","code":"res <- mr(dat) #> Analysing 'ieu-a-2' on 'ieu-a-7' p1 <- mr_scatter_plot(res, dat) p1[[1]] length(p1) #> [1] 1 res <- mr(dat, method_list = c(\"mr_egger_regression\", \"mr_ivw\")) #> Analysing 'ieu-a-2' on 'ieu-a-7' p1 <- mr_scatter_plot(res, dat) ggsave(p1[[1]], file = \"filename.pdf\", width = 7, height = 7) ggsave(p1[[1]], file = \"filename.png\", width = 7, height = 7)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"forest-plot","dir":"Articles","previous_headings":"Plots","what":"Forest plot","title":"Perform MR","text":"Use mr_forest_plot() function compare MR estimates using different MR methods single SNP tests.  , plot shows causal effect estimated using SNPs , comparing causal effect estimated using methods use SNPs. get plots use different methods, specify mr_singlesnp() function:","code":"res_single <- mr_singlesnp(dat) p2 <- mr_forest_plot(res_single) p2[[1]] res_single <- mr_singlesnp(dat, all_method = c(\"mr_ivw\", \"mr_two_sample_ml\")) p2 <- mr_forest_plot(res_single) p2[[1]]"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"leave-one-out-plot","dir":"Articles","previous_headings":"Plots","what":"Leave-one-out plot","title":"Perform MR","text":"Use mr_leaveoneout_plot() function visualise leave-one-analysis:  Specify test use e.g. mr_leaveoneout(dat, method = mr_egger_regression) use MR-Egger regression.","code":"res_loo <- mr_leaveoneout(dat) p3 <- mr_leaveoneout_plot(res_loo) p3[[1]]"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"funnel-plot","dir":"Articles","previous_headings":"Plots","what":"Funnel plot","title":"Perform MR","text":"Asymmetry funnel plot useful gauging reliability particular MR analysis. Funnel plots can produced using single SNP results follows:","code":"res_single <- mr_singlesnp(dat) p4 <- mr_funnel_plot(res_single) p4[[1]]"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"to-many-forest-plot","dir":"Articles","previous_headings":"","what":"1-to-many forest plot","title":"Perform MR","text":"1--many MR analysis interrogates effect single exposure multiple outcomes multiple exposures single outcome. results analysis can visualised using 1--many forest plot, without stratification categorical variable. visual point view, function works best 50 fewer results really designed handle 100 results. number results much greater 50, may better split across two separate plots. example, 100 sets results divide equally across two plots combine two plots together another programme like Powerpoint. function assumes results already right order plotting. , users advised sort results according like appear plot. Users can use code can use sort_1_to_many() function.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"step-1-generate-1-to-many-mr-results","dir":"Articles","previous_headings":"1-to-many forest plot","what":"Step 1: generate 1-to-many MR results","title":"Perform MR","text":"","code":"exp_dat <- extract_instruments(outcomes = c(2, 100, 1032, 104, 1, 72, 999)) table(exp_dat$exposure) chd_out_dat <- extract_outcome_data(   snps = exp_dat$SNP,   outcomes = 7 )  dat2 <- harmonise_data(   exposure_dat = exp_dat,   outcome_dat = chd_out_dat ) res <- mr(dat2)"},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"example-1--effect-of-multiple-risk-factors-on-coronary-heart-disease","dir":"Articles","previous_headings":"1-to-many forest plot > Step 2. Make the 1-to-many forest plot","what":"Example 1. Effect of multiple risk factors on coronary heart disease","title":"Perform MR","text":"example wish plot results MR analysis effect multiple exposures coronary heart disease, results sorted decreasing effect size (largest effect top plot) one MR method unique exposure-outcome combination. also make size point estimate proportional inverse variance. useful way draw attention towards reliable results away results wide confidence intervals. specify size point estimate, set weight argument name column data weight information. also possible add additional columns column titles choose size text columns: workflow prefer keep plot free axis column titles add separately program like powerpoint:","code":"res <- subset_on_method(res) # default is to subset on either the IVW method (>1 instrumental SNP) or Wald ratio method (1 instrumental SNP). res <- sort_1_to_many(res, b = \"b\", sort_action = 4) # this sorts results by decreasing effect size (largest effect at top of the plot) res <- split_exposure(res) # to keep the Y axis label clean we exclude the exposure ID labels from the exposure column res$weight <- 1/res$se  min(exp(res$b - 1.96*res$se)) # identify value for 'lo' in forest_plot_1_to_many max(exp(res$b + 1.96*res$se)) # identify value for 'up' in forest_plot_1_to_many  forest_plot_1_to_many(   res,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   ao_slc = FALSE,   lo = 0.3,   up = 2.5,   TraitM = \"exposure\",   col1_width = 2,   by = NULL,   trans = \"log2\",   xlab = \"OR for CHD per SD increase in risk factor (95% confidence interval)\",   weight = \"weight\" ) res$pval<-formatC(res$pval, format = \"e\", digits = 2) forest_plot_1_to_many(   res,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   ao_slc = FALSE,   lo = 0.3,   up = 2.5,   TraitM = \"exposure\",   by = NULL,   trans = \"log2\",   xlab = \"OR for CHD per SD increase in risk factor (95% CI)\",   weight = \"weight\",   subheading_size = 11,   col1_title = \"Risk factor\",   col1_width = 2.5,   col_text_size = 4,   addcols = c(\"nsnp\", \"pval\"),   addcol_widths = c(1.0, 1.0),   addcol_titles = c(\"No. SNPs\", \"P-val\") ) forest_plot_1_to_many(   res,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   ao_slc = FALSE,   lo = 0.3,   up = 3.0,   TraitM = \"exposure\",   col1_width = 2.0,   by = NULL,   trans = \"log2\",   xlab = \"\",   addcols = c(\"nsnp\", \"pval\"),   weight = \"weight\",   col_text_size = 4,   addcol_widths = c(0.5, 1.0),   addcol_titles = c(\"\", \"\") )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"example-2--mr-results-for-multiple-mr-methods-grouped-by-multiple-exposures","dir":"Articles","previous_headings":"1-to-many forest plot > Step 2. Make the 1-to-many forest plot","what":"Example 2. MR results for multiple MR methods grouped by multiple exposures","title":"Perform MR","text":"next example plot results analysis effect multiple exposures coronary heart disease using multiple methods, results grouped exposure. also want result IVW method given priority go methods. also want exposure largest IVW effect size go top plot. also set TraitM argument column describing MR method. grouping results exposures. Normally row labels correspond exposures example want row names correspond MR method.","code":"res <- mr(dat2) res <- split_exposure(res) # to keep the Y axis label clean we exclude the exposure ID labels from the exposure column  res <-   sort_1_to_many(     res,     group = \"exposure\",     sort_action = 3,     priority = \"Inverse variance weighted\",     trait_m = \"method\"   )  forest_plot_1_to_many(   res,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   trans = \"log2\",   ao_slc = FALSE,   lo = 0.03,   up = 22,   col1_width = 2,   by = \"exposure\",   TraitM = \"method\",   xlab = \"OR for CHD per SD increase in risk factor (95% confidence interval)\",   subheading_size = 12,   col_text_size = 4 )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"example-3--stratify-results-on-a-grouping-variable","dir":"Articles","previous_headings":"1-to-many forest plot > Step 2. Make the 1-to-many forest plot","what":"Example 3. Stratify results on a grouping variable","title":"Perform MR","text":"next example plot results results stratified grouping variable. also select one MR method unique exposure-outcome combination sort results decreasing effect size within group (.e. largest effect top). example made arbitrary grouping variable called “subcategory” values “Group 1” “Group 2”. Typically, however, grouping variable might correspond something like trait ontology (e.g. anthropometric glycemic traits) study design (e.g. MR observational studies).","code":"res <- mr(dat2) res <- split_exposure(res) res <- subset_on_method(res) res$subcategory[res$exposure %in% c(\"Adiponectin\", \"Hip circumference\", \"Waist circumference\")] <- \"Group 1\" res$subcategory[is.na(res$subcategory)] <- \"Group 2\" res$weight <- 1/res$se res <- sort_1_to_many(res, sort_action = 1, group = \"subcategory\")  forest_plot_1_to_many(   res,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   trans = \"log2\",   ao_slc = FALSE,   lo = 0.3,   up = 2.5,   TraitM = \"exposure\",   col_text_size = 4,   col1_width = 1.5,   by = \"subcategory\",   xlab = \"OR for CHD per SD increase in risk factor (95% confidence interval)\",   subheading_size = 14,   weight = \"weight\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"example-4--effect-of-bmi-on-103-diseases","dir":"Articles","previous_headings":"1-to-many forest plot > Step 2. Make the 1-to-many forest plot","what":"Example 4. Effect of BMI on 103 diseases","title":"Perform MR","text":"plot function works best 50 fewer rows really designed handle 100. Visualising single-column forest plot 100 results also quite difficult. number results much greater 50, advisable split results across two different plots. example select BMI exposure test 103 diseases IEU GWAS database: MR results 103 diseases can difficult visualise single-column forest plot. workflow split across two plots join together separate program, Powerpoint, refinements . typically save plots using pdf() graphics device. particular example disease labels probably require cleaning (bit long) alternatively column text size made smaller. also possible change colour plot shape point estimates. Type ?forest_plot_1_to_many details.","code":"exp_dat <- extract_instruments(outcomes = 2) # extract instruments for BMI ao <- available_outcomes() ao <- ao[ao$category == \"Disease\", ] # identify diseases ao <- ao[which(ao$ncase > 100), ]  dis_dat <- extract_outcome_data(   snps = exp_dat$SNP,   outcomes = ao$id )  dat3 <- harmonise_data(   exposure_dat = exp_dat,   outcome_dat = dis_dat )  res <- mr(dat3, method_list = c(\"mr_wald_ratio\", \"mr_ivw\")) res <- split_outcome(res) # to keep the Y axis label clean we exclude the exposure ID labels from the exposure column  res <- sort_1_to_many(res, b = \"b\", sort_action = 4) # this sorts results by decreasing effect size (largest effect at top of the plot) res1 <- res[1:52, ] res2 <- res[53:103, ]  plot1 <- forest_plot_1_to_many(   res1,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   trans = \"log2\",   ao_slc = FALSE,   lo = 0.004,   up = 461,   col1_width = 2,   TraitM = \"outcome\",   col_text_size = 3,   xlab = \"\" )  plot2 <- forest_plot_1_to_many(   res2,   b = \"b\",   se = \"se\",   exponentiate = TRUE,   trans = \"log2\",   ao_slc = FALSE,   lo = 0.004,   up = 461,   col1_width = 2,   TraitM = \"outcome\",   subheading_size = 11,   col_text_size = 3,   xlab = \"\" )  plot1 plot2  pdf(\"plot1.pdf\", height = 10, width = 8) plot1 dev.off()"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"mr-raps-many-weak-instruments-analysis","dir":"Articles","previous_headings":"","what":"MR.RAPS: Many weak instruments analysis","title":"Perform MR","text":"MR.RAPS (Robust Adjusted Profile Score) recently proposed method considers measurement error SNP-exposure effects, unbiased many (e.g. hundreds ) weak instruments, robust systematic idiosyncratic pleiotropy. See arXiv preprint detail statistical methodology. MR.RAPS implemented R package mr.raps available CRAN. can directly called TwoSampleMR MR.RAPS comes two main options: .dispersion (whether method consider systematic pleiotropy) loss.function (either \"l2\", \"huber\", \"tukey\"). latter two loss functions robust idiosyncratic pleiotropy. default option .dispersion = TRUE loss.function = \"tukey\". change options, modify parameters argument mr() (example)","code":"res <- mr(dat, method_list = c(\"mr_raps\")) res <-   mr(     dat,     method_list = c(\"mr_raps\"),     parameters = list(over.dispersion = FALSE, loss.function = \"l2\")   )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"reports","dir":"Articles","previous_headings":"","what":"Reports","title":"Perform MR","text":"report can generated performs MR analyses, sensitivity analyses, plots, presents single self-contained html web page, word document, pdf document. default produces html file current working directory, see help pages modify . function create separate report file every exposure-outcome combination present dat object.","code":"mr_report(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"mr-steiger-directionality-test","dir":"Articles","previous_headings":"","what":"MR Steiger directionality test","title":"Perform MR","text":"implementation method described : Hemani G, Tilling K, Davey Smith G. Orienting causal relationship imprecisely measured traits using GWAS summary data. PLoS Genetics. 2017. 13(11): e1007081. MR assumed instruments influence exposure first outcome exposure. sometimes difficult evaluate, example cis-acting SNP influencing gene expression levels DNA methylation levels first? causal direction hypothesised exposure outcomes can tested using Steiger test (Hemani, Tilling, Davey Smith 2017). example: calculates variance explained exposure outcome instrumenting SNPs, tests variance outcome less exposure. test , like many others, liable give inaccurate causal directions measurement error parameters exposure outcome (e.g. outcome much lower measurement precision proportion variance explained underestimated). Sensitivity can applied evaluate extent inferred causal direction liable measurement error, two ways. Provide estimates measurement error exposure outcome, obtain adjusted estimate causal direction possible values measurement error, identify proportion parameter space supports inferred causal direction tests obtained using:","code":"out <- directionality_test(dat) #> r.exposure and/or r.outcome not present. #> Calculating approximate SNP-exposure and/or SNP-outcome correlations, assuming all are quantitative traits. Please pre-calculate r.exposure and/or r.outcome using get_r_from_lor() for any binary traits knitr::kable(out) mr_steiger(   p_exp = dat$pval.exposure,   p_out = dat$pval.outcome,   n_exp = dat$samplesize.exposure,   n_out = dat$samplesize.outcome,   r_xxo = 1,   r_yyo = 1,   r_exp=0 )"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"multivariable-mr","dir":"Articles","previous_headings":"","what":"Multivariable MR","title":"Perform MR","text":"SNPs instrument multiple potential exposures, example case different lipid fractions, one method overcoming problem estimate influence lipid conditioning effects SNPs lipids. Multivariable MR can performed using R package follows. Practically speaking, process needs occur perspective generating data correct format: Get instruments exposure Combine set instruments Clump avoid possibility e.g. variant exposure 1 LD variant exposure 2 Re-extract final clumped SNPs (3) exposures Harmonise effect allele Use multivariable MR method harmonised data Example - GWAS IDs HDL, LDL total cholesterol ieu--299, ieu--300 ieu--302. GWAS ID coronary heart disease (CHD) ieu--7. example estimate multivariable effects HDL, LDL total cholesterol CHD. First obtain instruments lipid fraction. entails obtaining combined set SNPs including instruments, getting SNPs lipid fraction. Therefore, e.g. 20 instruments 3 lipid fractions, combined 30 unique SNPs, need extract 30 SNPs lipid fraction (exposure). Next, also extract SNPs outcome. data obtained, harmonise reference allele. Finally, perform multivariable MR analysis generates table results.","code":"id_exposure <- c(\"ieu-a-299\", \"ieu-a-300\", \"ieu-a-302\") id_outcome <- \"ieu-a-7\" mv_exposure_dat <- mv_extract_exposures(id_exposure) mv_outcome_dat <- extract_outcome_data(exposure_dat$SNP, id_outcome) mvdat <- mv_harmonise_data(mv_exposure_dat, mv_outcome_dat) #> Harmonising HDL cholesterol || id:ieu-a-299 (ieu-a-299) and Coronary heart disease || id:ieu-a-7 (ieu-a-7) res <- mv_multiple(mvdat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"note-about-mv-methods","dir":"Articles","previous_headings":"Multivariable MR","what":"Note about MV methods","title":"Perform MR","text":"several different ways analysis can formulated. e.g. consider 3 exposures one outcome, one : Fit exposures together fit one exposure time residuals outcome adjusted outcomes. former recommended default R package mv_multiple() function latter MV MR originally described Burgess et al 2015 can done mv_residual(). Fitting instruments exposures (default) fitting instruments exposure sequentially Forcing slopes origin (default) allowing intercept term. three different parameters eight different ways MV analysis. recommend default settings described .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"note-about-visualisation","dir":"Articles","previous_headings":"Multivariable MR","what":"Note about visualisation","title":"Perform MR","text":"Plots can generated using plots = TRUE argument mv_multiple() mv_residual(). current plots generated necessarily adequate show slope raw points, demonstrate raw points might effectively different plots conditional exposures.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"using-your-own-summary-data","dir":"Articles","previous_headings":"Multivariable MR","what":"Using your own summary data","title":"Perform MR","text":"want perform analysis local summary data (.e. OpenGWAS database) use look mv_extract_exposures_local() function instead mv_extract_exposures() function.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"mr-estimates-when-instruments-are-correlated","dir":"Articles","previous_headings":"","what":"MR estimates when instruments are correlated","title":"Perform MR","text":"examples shown far assumed instruments independent (.e. linkage disequilibrium, LD). avoid ‘double counting’ effects. alternative approach estimate MR effects accounting correlation variants. TwoSampleMR package implemented yet, MendelianRandomization R package Olena Yavorska Stephen Burgess functionality. can use TwoSampleMR package extract, format harmonise data, convert format required MendelianRandomization package. IEU GWAS database server individual level genetic data ~500 Europeans 1000 genomes data, can obtain LD matrix set SNPs using data. example: ld_matrix() returns LD correlation values (R2) pair variants present 1000 genomes data set. Convert MRInput format MendelianRandomization package: produces list MRInput objects can used MendelianRandomization functions, e.g. Alternatively, convert MRInput format also obtaining LD matrix instruments","code":"snplist <- c(\"rs234\", \"rs1205\") ld_mat <- ld_matrix(snplist) ld_mat #>            rs234_A_G rs1205_T_C #> rs234_A_G  1.0000000  0.0797023 #> rs1205_T_C 0.0797023  1.0000000 dat <- harmonise_data(   exposure_dat = bmi_exp_dat,   outcome_dat = chd_out_dat ) #> Harmonising Body mass index || id:ieu-a-2 (ieu-a-2) and Coronary heart disease || id:ieu-a-7 (ieu-a-7) dat2 <- dat_to_MRInput(dat) #> Converting: #>  - exposure: Body mass index || id:ieu-a-2 #>  - outcome: Coronary heart disease || id:ieu-a-7 MendelianRandomization::mr_ivw(dat2[[1]]) #>  #> Inverse-variance weighted method #> (variants uncorrelated, random-effect model) #>  #> Number of Variants : 79  #>  #> ------------------------------------------------------------------ #>  Method Estimate Std Error 95% CI       p-value #>     IVW    0.446     0.059 0.330, 0.562   0.000 #> ------------------------------------------------------------------ #> Residual standard error =  1.357  #> Heterogeneity test statistic (Cochran's Q) = 143.6508 on 78 degrees of freedom, (p-value = 0.0000). I^2 = 45.7%.  #> F statistic = 65.6. dat2 <- try(dat_to_MRInput(dat, get_correlation = TRUE)) #> Converting: #>  - exposure: Body mass index || id:ieu-a-2 #>  - outcome: Coronary heart disease || id:ieu-a-7 #>  - obtaining LD matrix #> Please look at vignettes for options on running this locally if you need to run many instances of this command. #> Warning in ieugwasr::ld_matrix(variants = snps, with_alleles = with_alleles, : The following variants are not present in the LD reference panel #> rs2033529 if (class(dat2) != \"try-error\") MendelianRandomization::mr_ivw(dat2[[1]], correl = TRUE) #>  #> Inverse-variance weighted method #> (variants correlated, random-effect model) #>  #> Number of Variants : 78  #>  #> ------------------------------------------------------------------ #>  Method Estimate Std Error 95% CI       p-value #>     IVW    0.441     0.056 0.331, 0.551   0.000 #> ------------------------------------------------------------------ #> Residual standard error =  1.414  #> Heterogeneity test statistic (Cochran's Q) = 153.8519 on 77 degrees of freedom, (p-value = 0.0000). I^2 = 50.0%.  #> F statistic = 80.3.  #>  #> (Estimates with correlated variants are sensitive to the signs in the correlation matrix #>  - please ensure that your correlations are expressed with respect to the same effect alleles as your summarized association estimates.)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"mr-moe-using-a-mixture-of-experts-machine-learning-approach","dir":"Articles","previous_headings":"","what":"MR-MoE: Using a mixture of experts machine learning approach","title":"Perform MR","text":"recently developed MR-MoE, method choose appropriate amongst several MR tests using machine learning algorithm. Note method still review, full details described : https://doi.org/10.1101/173682. MR-MoE operates taking set harmonised data, inferring characteristics dataset, using characteristics predict well different MR methods perform dataset, terms maximising power minimising false discovery rates. order run analysis must download RData object contains trained random forests used predict efficacy method. can downloaded : dropbox.com/s/5la7y38od95swcf Caution: large file (approx 167Mb) downloaded, read object use mr_moe() function perform analysis. example shown , estimating causal effect BMI coronary heart disease: function following: Performs MR using 11 MR methods Applies Steiger filtering heterogeneity filtering remove SNPs substantially larger R2 exposure outcome. Note - binary traits ensure number cases, number controls, allele frequencies available SNP. continuous traits make sure p-value sample size available. function infers trait binary continuous based units.exposure units.outcome columns - binary traits must values set ‘log odds’ Performs 14 MR methods using subset SNPs survive Steiger filtering Generates meta data summary data predict reliable 28 methods applied. every exposure / outcome combination dat object, MR-MoE method applied. function returns list long number exposure / outcome combinations. case, length 1, containing result BMI CHD. result object list following elements: estimates (results MR) heterogeneity (results heterogeneity different filtering approaches) directional_pleiotropy (egger intercepts) info (metrics used generate MOE) Looking estimates, see column called MOE predicted AUROC curve performance method.","code":"# Extact instruments for BMI exposure_dat <- extract_instruments(\"ieu-a-2\")  # Get corresponding effects for CHD outcome_dat <- extract_outcome_data(exposure_dat$SNP, \"ieu-a-7\")  # Harmonise dat <- harmonise_data(exposure_dat, outcome_dat)  # Load the downloaded RData object. This loads the rf object load(\"rf.rdata\")  # Obtain estimates from all methods, and generate data metrics res_all <- mr_wrapper(dat)  # MR-MoE - predict the performance of each method res_moe <- mr_moe(res_all, rf)"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"post-mr-results-management","dir":"Articles","previous_headings":"","what":"Post MR results management","title":"Perform MR","text":"TwoSampleMR package also provides following functions managing editing MR results.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"split-outcome-names","dir":"Articles","previous_headings":"Post MR results management","what":"Split outcome names","title":"Perform MR","text":"outcome column output mr() combines original outcome name outcome trait ID. outcome column can split separate columns id outcome name using split_outcome function:","code":"head(res) #> $result #>   id.exposure                        exposure id.outcome #> 1   ieu-a-299 HDL cholesterol || id:ieu-a-299    ieu-a-7 #> 2   ieu-a-300 LDL cholesterol || id:ieu-a-300    ieu-a-7 #> 3   ieu-a-302   Triglycerides || id:ieu-a-302    ieu-a-7 #>                                outcome nsnp           b         se         pval #> 1 Coronary heart disease || id:ieu-a-7   79 -0.08919724 0.05970552 1.351879e-01 #> 2 Coronary heart disease || id:ieu-a-7   68  0.37853543 0.04976846 2.828614e-14 #> 3 Coronary heart disease || id:ieu-a-7   42  0.13584165 0.06738291 4.380354e-02 res <- mr(dat) #> Analysing 'ieu-a-2' on 'ieu-a-7' split_outcome(res) #>   id.exposure id.outcome                outcome                      exposure #> 1     ieu-a-2    ieu-a-7 Coronary heart disease Body mass index || id:ieu-a-2 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease Body mass index || id:ieu-a-2 #> 3     ieu-a-2    ieu-a-7 Coronary heart disease Body mass index || id:ieu-a-2 #> 4     ieu-a-2    ieu-a-7 Coronary heart disease Body mass index || id:ieu-a-2 #> 5     ieu-a-2    ieu-a-7 Coronary heart disease Body mass index || id:ieu-a-2 #>                      method nsnp         b         se         pval #> 1                  MR Egger   79 0.5024935 0.14396056 8.012590e-04 #> 2           Weighted median   79 0.3870065 0.07717818 5.318417e-07 #> 3 Inverse variance weighted   79 0.4459091 0.05898302 4.032020e-14 #> 4               Simple mode   79 0.3401554 0.15276076 2.885059e-02 #> 5             Weighted mode   79 0.3790910 0.10761091 7.173381e-04"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"split-exposure-names","dir":"Articles","previous_headings":"Post MR results management","what":"Split exposure names","title":"Perform MR","text":"Similarly outcome column, exposure column output mr() combines original exposure name exposure trait ID. can split separate columns id exposure name using split_exposure function.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"generate-odds-ratios-with-95-confidence-intervals","dir":"Articles","previous_headings":"Post MR results management","what":"Generate odds ratios with 95% confidence intervals","title":"Perform MR","text":"Users can convert log odds ratios odds ratios 95% confidence intervals using:","code":"generate_odds_ratios(res) #>   id.exposure id.outcome                              outcome #> 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 3     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 4     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #> 5     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method nsnp         b #> 1 Body mass index || id:ieu-a-2                  MR Egger   79 0.5024935 #> 2 Body mass index || id:ieu-a-2           Weighted median   79 0.3870065 #> 3 Body mass index || id:ieu-a-2 Inverse variance weighted   79 0.4459091 #> 4 Body mass index || id:ieu-a-2               Simple mode   79 0.3401554 #> 5 Body mass index || id:ieu-a-2             Weighted mode   79 0.3790910 #>           se         pval      lo_ci     up_ci       or or_lci95 or_uci95 #> 1 0.14396056 8.012590e-04 0.22033081 0.7846562 1.652838 1.246489 2.191653 #> 2 0.07717818 5.318417e-07 0.23573724 0.5382757 1.472566 1.265842 1.713051 #> 3 0.05898302 4.032020e-14 0.33030238 0.5615158 1.561909 1.391389 1.753328 #> 4 0.15276076 2.885059e-02 0.04074434 0.6395665 1.405166 1.041586 1.895659 #> 5 0.10761091 7.173381e-04 0.16817361 0.5900084 1.460956 1.183142 1.804004"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"subset-on-method","dir":"Articles","previous_headings":"Post MR results management","what":"Subset on method","title":"Perform MR","text":"sometimes useful subset results MR method, one unique result exposure-outcome combination: default subset IVW method >1 SNP available use Wald ratio method single SNP available. Users can specify multi-SNP method subset .","code":"subset_on_method(res) #>   id.exposure id.outcome                              outcome #> 3     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7 #>                        exposure                    method nsnp         b #> 3 Body mass index || id:ieu-a-2 Inverse variance weighted   79 0.4459091 #>           se        pval #> 3 0.05898302 4.03202e-14"},{"path":"https://mrcieu.github.io/TwoSampleMR/articles/perform_mr.html","id":"combine-all-results","dir":"Articles","previous_headings":"Post MR results management","what":"Combine all results","title":"Perform MR","text":"often useful combine results study level characterists single dataframe table, e.g. sharing results collaborators user wishes present results single table figure. can done using combine_all_mrresults() function: combines results mr(), mr_heterogeneity(), mr_pleiotropy_test() mr_singlesnp() single dataframe. also merges results outcome study level characteristics available_outcomes() function, including sample size characteristics. requested, also exponentiates results (e.g. user wants log odds ratio converted odds ratios 95 percent confidence intervals).","code":"res <- mr(dat) het <- mr_heterogeneity(dat) plt <- mr_pleiotropy_test(dat) sin <- mr_singlesnp(dat) all_res <-   combine_all_mrresults(     res,     het,     plt,     sin,     ao_slc = TRUE,     Exp = TRUE,     split.exposure = FALSE,     split.outcome = TRUE   ) head(all_res[, c(   \"Method\",   \"outcome\",   \"exposure\",   \"nsnp\",   \"b\",   \"se\",   \"pval\",   \"intercept\",   \"intercept_se\",   \"intercept_pval\",   \"Q\",   \"Q_df\",   \"Q_pval\",   \"consortium\",   \"ncase\",   \"ncontrol\",   \"pmid\",   \"population\" )])"},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gibran Hemani. Author, maintainer. Philip Haycock. Author. Jie Zheng. Author. Tom Gaunt. Author. Ben Elsworth. Author. Tom Palmer. Author.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hemani G, Zheng J, Elsworth B, Wade KH, Baird D, Haberland V, Laurin C, Burgess S, Bowden J, Langdon R, Tan VY, Yarmolinsky J, Shihab HA, Timpson NJ, Evans DM, Relton C, Martin RM, Davey Smith G, Gaunt TR, Haycock PC, MR-Base Collaboration. MR-Base platform supports systematic causal inference across human phenome. eLife 2018;7:e34408. doi: 10.7554/eLife.34408 Hemani G, Tilling K, Davey Smith G (2017) Orienting causal relationship imprecisely measured traits using GWAS summary data. PLOS Genetics 13(11): e1007081. https://doi.org/10.1371/journal.pgen.1007081","code":"@Article{twosamplemr,   author = {G. Hemani and J. Zheng and B. Elsworth and K. Wade and D. Baird and V. Haberland and C. Laurin and S. Burgess and J. Bowden and R. Langdon and V.Y. Tan and J. Yarmolinsky and H.A. Shibab and N.J. Timpson and D.M. Evans and C. Relton and R.M. Martin and G. {Davey Smith} and T.R. Gaunt and P.C. Haycock and {The MR-Base Collaboration}},   title = {The MR-Base platform supports systematic causal inference across the human phenome},   year = {2018},   volume = {7},   journal = {eLife},   pages = {e34408},   url = {https://elifesciences.org/articles/34408},   doi = {10.7554/eLife.34408}, } @Article{mrsteiger,   author = {G. Hemani and K. Tilling and G. {Davey Smith}},   title = {Orienting the causal relationship between imprecisely measured traits using GWAS summary data},   journal = {PLoS Genetics},   year = {2017},   volume = {13},   number = {11},   pages = {e1007081},   doi = {10.1371/journal.pgen.1007081},   url = {https://doi.org/10.1371/journal.pgen.1007081}, }"},{"path":"https://mrcieu.github.io/TwoSampleMR/index.html","id":"mendelian-randomization-with-gwas-summary-data","dir":"","previous_headings":"","what":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","title":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","text":"package performing Mendelian randomization using GWAS summary data. uses IEU OpenGWAS database obtain data automatically, wide range methods run analysis.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/index.html","id":"january-2020-major-update","dir":"","previous_headings":"","what":"January 2020 major update","title":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","text":"made substantial changes package, database reference panels. full details changes, please visit https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","text":"Users running Windows macOS, install latest version TwoSampleMR please install MRC IEU r-universe Users running Linux WebR please see following instructions. update package run command .","code":"install.packages(\"TwoSampleMR\", repos = c(\"https://mrcieu.r-universe.dev\", \"https://cloud.r-project.org\"))"},{"path":"https://mrcieu.github.io/TwoSampleMR/index.html","id":"installing-from-source","dir":"","previous_headings":"Installation","what":"Installing from source","title":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","text":"update package just run remotes::install_github(\"MRCIEU/TwoSampleMR\") command .","code":"install.packages(\"remotes\") remotes::install_github(\"MRCIEU/TwoSampleMR\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/index.html","id":"docker","dir":"","previous_headings":"","what":"Docker","title":"Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database","text":"multi-platform docker image containing R TwoSampleMR package pre-installed (x86_64 ARM computers) available : https://hub.docker.com/r/mrcieu/twosamplemr","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/Isq.html","id":null,"dir":"Reference","previous_headings":"","what":"I-squared calculation — Isq","title":"I-squared calculation — Isq","text":"function calculates \\(^2\\) statistic. use \\(^2_{GX}\\) metric ensure effects sign (e.g. abs(y)).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/Isq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"I-squared calculation — Isq","text":"","code":"Isq(y, s)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/Isq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"I-squared calculation — Isq","text":"y Vector effects. s Vector standard errors.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/Isq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"I-squared calculation — Isq","text":"Isq value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/TwoSampleMR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"TwoSampleMR: Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database — TwoSampleMR-package","title":"TwoSampleMR: Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database — TwoSampleMR-package","text":"package performing Mendelian randomization using GWAS summary data. uses IEU OpenGWAS database https://gwas.mrcieu.ac.uk/ automatically obtain data, wide range methods run analysis.","code":""},{"path":[]},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/TwoSampleMR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"TwoSampleMR: Two Sample MR Functions and Interface to MRC Integrative Epidemiology Unit OpenGWAS Database — TwoSampleMR-package","text":"Maintainer: Gibran Hemani g.hemani@bristol.ac.uk (ORCID) Authors: Philip Haycock philip.haycock@bristol.ac.uk (ORCID) Jie Zheng Jie.Zheng@bristol.ac.uk (ORCID) Tom Gaunt Tom.Gaunt@bristol.ac.uk (ORCID) Ben Elsworth Ben.Elsworth@bristol.ac.uk (ORCID) Tom Palmer tom.palmer@bristol.ac.uk (ORCID)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Add meta data to extracted data — add_metadata","title":"Add meta data to extracted data — add_metadata","text":"Previously meta data returned alongside association information. mostly unnecessary needlessly repeating information. convenience function reinstates information. Can applied either exposure data, outcome data, harmonised data","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add meta data to extracted data — add_metadata","text":"","code":"add_metadata(dat, cols = c(\"sample_size\", \"ncase\", \"ncontrol\", \"unit\", \"sd\"))"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add meta data to extracted data — add_metadata","text":"dat Either exposure data, outcome data harmonised data cols metadata fields add. Default = c(\"sample_size\", \"ncase\", \"ncontrol\", \"unit\", \"sd\")","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add meta data to extracted data — add_metadata","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_rsq.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate r-square of each association — add_rsq","title":"Estimate r-square of each association — add_rsq","text":"Can applied exposure_dat, outcome_dat harmonised_data. Note beneficial circumstances add meta data data object using add_metadata() running function. Also adds effective sample size case control data.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_rsq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate r-square of each association — add_rsq","text":"","code":"add_rsq(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_rsq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate r-square of each association — add_rsq","text":"dat exposure_dat, outcome_dat harmonised_data","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/add_rsq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate r-square of each association — add_rsq","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/allele_frequency.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate allele frequency from SNP — allele_frequency","title":"Estimate allele frequency from SNP — allele_frequency","text":"Estimate allele frequency SNP","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/allele_frequency.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate allele frequency from SNP — allele_frequency","text":"","code":"allele_frequency(g)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/allele_frequency.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate allele frequency from SNP — allele_frequency","text":"g Vector 0/1/2","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/allele_frequency.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate allele frequency from SNP — allele_frequency","text":"Allele frequency","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/available_outcomes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get list of studies with available GWAS summary statistics through API — available_outcomes","title":"Get list of studies with available GWAS summary statistics through API — available_outcomes","text":"Get list studies available GWAS summary statistics API","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/available_outcomes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get list of studies with available GWAS summary statistics through API — available_outcomes","text":"","code":"available_outcomes(opengwas_jwt = ieugwasr::get_opengwas_jwt())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/available_outcomes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get list of studies with available GWAS summary statistics through API — available_outcomes","text":"opengwas_jwt Used authenticate protected endpoints. Login https://api.opengwas.io obtain jwt. Provide jwt string , store .Renviron keyname OPENGWAS_JWT.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/available_outcomes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get list of studies with available GWAS summary statistics through API — available_outcomes","text":"Dataframe details available studies","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/cleanup_outcome_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Avoid issues in MR by finding impossible vals and setting to NA — cleanup_outcome_data","title":"Avoid issues in MR by finding impossible vals and setting to NA — cleanup_outcome_data","text":"Avoid issues MR finding impossible vals setting NA","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/cleanup_outcome_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Avoid issues in MR by finding impossible vals and setting to NA — cleanup_outcome_data","text":"","code":"cleanup_outcome_data(d)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/cleanup_outcome_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Avoid issues in MR by finding impossible vals and setting to NA — cleanup_outcome_data","text":"d Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/cleanup_outcome_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Avoid issues in MR by finding impossible vals and setting to NA — cleanup_outcome_data","text":"Cleaned data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/clump_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform LD clumping on SNP data — clump_data","title":"Perform LD clumping on SNP data — clump_data","text":"Uses PLINK clumping method, SNPs LD within particular window pruned. SNP lowest p-value retained.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/clump_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform LD clumping on SNP data — clump_data","text":"","code":"clump_data(   dat,   clump_kb = 10000,   clump_r2 = 0.001,   clump_p1 = 1,   clump_p2 = 1,   pop = \"EUR\",   bfile = NULL,   plink_bin = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/clump_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform LD clumping on SNP data — clump_data","text":"dat Output format_data(). Must SNP name column (SNP), SNP chromosome column (chr_name), SNP position column (chrom_start). id.exposure pval.exposure present generated. clump_kb Clumping window, default 10000. clump_r2 Clumping r2 cutoff. Note default value recently changed 0.01 0.001. clump_p1 Clumping sig level index SNPs, default 1. clump_p2 Clumping sig level secondary SNPs, default 1. pop Super-population use reference panel. Default = \"EUR\". Options \"EUR\", \"SAS\", \"EAS\", \"AFR\", \"AMR\". 'legacy' also available - previously used version EUR panel slightly different set markers bfile provided use API. Default = NULL plink_bin NULL bfile NULL detect packaged plink binary specific OS. Otherwise specify path plink binary. Default = NULL","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/clump_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform LD clumping on SNP data — clump_data","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/clump_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform LD clumping on SNP data — clump_data","text":"function interacts OpenGWAS API, houses LD reference panels 5 super-populations 1000 genomes reference panel. includes bi-allelic SNPs MAF > 0.01, quite possible variant want include clumping process absent. absent, automatically excluded results. can check variants present LD reference panel using ieugwasr::ld_reflookup(). function put load OpenGWAS servers, makes life difficult users. implemented method made available LD reference panels perform clumping locally, see ieugwasr::ld_clump() related vignettes details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_all_mrresults.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine all mr results — combine_all_mrresults","title":"Combine all mr results — combine_all_mrresults","text":"function combines results mr(), mr_heterogeneity(), mr_pleiotropy_test() mr_singlesnp() single data frame. also merges results outcome study level characteristics available_outcomes(). desired also exponentiates results (e.g. user wants log odds ratio converted odds ratios 95 percent confidence intervals). exposure outcome columns output mr() contain trait names trait ids. combine_all_mrresults() function splits separate columns default.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_all_mrresults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine all mr results — combine_all_mrresults","text":"","code":"combine_all_mrresults(   res,   het,   plt,   sin,   ao_slc = TRUE,   Exp = FALSE,   split.exposure = FALSE,   split.outcome = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_all_mrresults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine all mr results — combine_all_mrresults","text":"res Results mr(). het Results mr_heterogeneity(). plt Results mr_pleiotropy_test(). sin Results mr_singlesnp(). ao_slc Logical; set TRUE outcome study level characteristics retrieved available_outcomes(). Default TRUE. Exp Logical; set TRUE results exponentiated. Useful user wants log odds ratios expressed odds ratios. Default FALSE. split.exposure Logical; set TRUE exposure column split separate columns exposure name exposure ID. Default FALSE. split.outcome Logical; set TRUE outcome column split separate columns outcome name outcome ID. Default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_all_mrresults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine all mr results — combine_all_mrresults","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine data — combine_data","title":"Combine data — combine_data","text":"Taking exposure outcome data (returned format_data()) combine multiple datasets together can analysed one batch. Removes duplicate SNPs, preferentially keeping usable MR analysis.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine data — combine_data","text":"","code":"combine_data(x)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine data — combine_data","text":"x List data frames returned format_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/combine_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine data — combine_data","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/contingency.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain 2x2 contingency table from marginal parameters and odds ratio — contingency","title":"Obtain 2x2 contingency table from marginal parameters and odds ratio — contingency","text":"Columns case control frequencies. Rows frequencies allele 1 allele 2.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/contingency.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain 2x2 contingency table from marginal parameters and odds ratio — contingency","text":"","code":"contingency(af, prop, odds_ratio, eps = 1e-15)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/contingency.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain 2x2 contingency table from marginal parameters and odds ratio — contingency","text":"af Allele frequency effect allele. prop Proportion cases. odds_ratio Odds ratio. eps tolerance, default 1e-15.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/contingency.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain 2x2 contingency table from marginal parameters and odds ratio — contingency","text":"2x2 contingency table matrix","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/convert_outcome_to_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert outcome data to exposure data — convert_outcome_to_exposure","title":"Convert outcome data to exposure data — convert_outcome_to_exposure","text":"Helper function convert results extract_outcome_data() exposure_dat format.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/convert_outcome_to_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert outcome data to exposure data — convert_outcome_to_exposure","text":"","code":"convert_outcome_to_exposure(outcome_dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/convert_outcome_to_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert outcome data to exposure data — convert_outcome_to_exposure","text":"outcome_dat Output extract_outcome_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/convert_outcome_to_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert outcome data to exposure data — convert_outcome_to_exposure","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/create_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Create fixed width label — create_label","title":"Create fixed width label — create_label","text":"Create fixed width label","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/create_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create fixed width label — create_label","text":"","code":"create_label(n1, nom)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/create_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create fixed width label — create_label","text":"n1 number nom name","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/create_label.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create fixed width label — create_label","text":"text","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_MRInput.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert TwoSampleMR format to MendelianRandomization format — dat_to_MRInput","title":"Convert TwoSampleMR format to MendelianRandomization format — dat_to_MRInput","text":"MendelianRandomization package offers MR methods can used data used TwoSampleMR package. function converts TwoSampleMR format MRInput class.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_MRInput.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert TwoSampleMR format to MendelianRandomization format — dat_to_MRInput","text":"","code":"dat_to_MRInput(dat, get_correlations = FALSE, pop = \"EUR\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_MRInput.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert TwoSampleMR format to MendelianRandomization format — dat_to_MRInput","text":"dat Output harmonise_data() function. get_correlations Default FALSE. TRUE extract LD matrix SNPs European 1000 genomes data OpenGWAS. pop get_correlations TRUE use following","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_MRInput.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert TwoSampleMR format to MendelianRandomization format — dat_to_MRInput","text":"List MRInput objects exposure/outcome combination","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_RadialMR.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert dat to RadialMR format — dat_to_RadialMR","title":"Convert dat to RadialMR format — dat_to_RadialMR","text":"Creates list RadialMR format datasets exposure-outcome pair.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_RadialMR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert dat to RadialMR format — dat_to_RadialMR","text":"","code":"dat_to_RadialMR(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_RadialMR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert dat to RadialMR format — dat_to_RadialMR","text":"dat Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/dat_to_RadialMR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert dat to RadialMR format — dat_to_RadialMR","text":"List RadialMR format datasets","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/default_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"List of parameters for use with MR functions — default_parameters","title":"List of parameters for use with MR functions — default_parameters","text":"default list(test_dist = \"z\", nboot = 1000, Cov = 0, penk = 20, phi = 1, alpha = 0.05, Qthresh = 0.05, .dispersion = TRUE, loss.function = \"huber\").","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/default_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List of parameters for use with MR functions — default_parameters","text":"","code":"default_parameters()"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/directionality_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform MR Steiger test of directionality — directionality_test","title":"Perform MR Steiger test of directionality — directionality_test","text":"statistical test whether assumption exposure causes outcome valid.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/directionality_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform MR Steiger test of directionality — directionality_test","text":"","code":"directionality_test(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/directionality_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform MR Steiger test of directionality — directionality_test","text":"dat Harmonised exposure outcome data. Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/directionality_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform MR Steiger test of directionality — directionality_test","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/effective_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the effective sample size in a case control study — effective_n","title":"Estimate the effective sample size in a case control study — effective_n","text":"Taken https://www.nature.com/articles/nprot.2014.071","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/effective_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the effective sample size in a case control study — effective_n","text":"","code":"effective_n(ncase, ncontrol)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/effective_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the effective sample size in a case control study — effective_n","text":"ncase Vector number cases ncontrol Vector number controls","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/effective_n.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the effective sample size in a case control study — effective_n","text":"Vector effective sample size","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform enrichment analysis — enrichment","title":"Perform enrichment analysis — enrichment","text":"Perform enrichment analysis","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform enrichment analysis — enrichment","text":"","code":"enrichment(dat, method_list = enrichment_method_list()$obj)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform enrichment analysis — enrichment","text":"dat Harmonised exposure outcome data. Output harmonise_data(). method_list List methods use analysis. Default enrichment_method_list()$obj. See enrichment_method_list() details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform enrichment analysis — enrichment","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment_method_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Get list of available p-value enrichment methods — enrichment_method_list","title":"Get list of available p-value enrichment methods — enrichment_method_list","text":"Get list available p-value enrichment methods","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment_method_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get list of available p-value enrichment methods — enrichment_method_list","text":"","code":"enrichment_method_list()"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/enrichment_method_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get list of available p-value enrichment methods — enrichment_method_list","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/estimate_trait_sd.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate trait SD by obtaining beta estimates from z-scores and finding the ratio with original beta values — estimate_trait_sd","title":"Estimate trait SD by obtaining beta estimates from z-scores and finding the ratio with original beta values — estimate_trait_sd","text":"Assumes sample size allele frequency correct SNP, allele frequency gives reasonable estimate variance SNP.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/estimate_trait_sd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate trait SD by obtaining beta estimates from z-scores and finding the ratio with original beta values — estimate_trait_sd","text":"","code":"estimate_trait_sd(b, se, n, p)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/estimate_trait_sd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate trait SD by obtaining beta estimates from z-scores and finding the ratio with original beta values — estimate_trait_sd","text":"b vector effect sizes. se vector standard errors. n vector sample sizes. p vector allele frequencies.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/estimate_trait_sd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate trait SD by obtaining beta estimates from z-scores and finding the ratio with original beta values — estimate_trait_sd","text":"Vector sd estimates association.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_instruments.html","id":null,"dir":"Reference","previous_headings":"","what":"Find instruments for use in MR from the OpenGWAS database — extract_instruments","title":"Find instruments for use in MR from the OpenGWAS database — extract_instruments","text":"function searches GWAS significant SNPs (given p-value) specified set outcomes. performs LD based clumping return independent significant associations.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_instruments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find instruments for use in MR from the OpenGWAS database — extract_instruments","text":"","code":"extract_instruments(   outcomes,   p1 = 5e-08,   clump = TRUE,   p2 = 5e-08,   r2 = 0.001,   kb = 10000,   opengwas_jwt = ieugwasr::get_opengwas_jwt(),   force_server = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_instruments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find instruments for use in MR from the OpenGWAS database — extract_instruments","text":"outcomes Array outcome IDs (see available_outcomes()). p1 Significance threshold. default 5e-8. clump Logical; whether clump results. default TRUE. p2 Secondary clumping threshold. default 5e-8. r2 Clumping r2 cut . default 0.001. kb Clumping distance cutoff. default 10000. opengwas_jwt Used authenticate protected endpoints. Login https://api.opengwas.io obtain jwt. Provide jwt string , store .Renviron keyname OPENGWAS_JWT. force_server Force analysis extract results server rather MRInstruments package.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_instruments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find instruments for use in MR from the OpenGWAS database — extract_instruments","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_outcome_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Supply the output from read_exposure_data() and all the SNPs therein will be queried against the requested outcomes in remote database using API. — extract_outcome_data","title":"Supply the output from read_exposure_data() and all the SNPs therein will be queried against the requested outcomes in remote database using API. — extract_outcome_data","text":"Supply output read_exposure_data() SNPs therein queried requested outcomes remote database using API.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_outcome_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Supply the output from read_exposure_data() and all the SNPs therein will be queried against the requested outcomes in remote database using API. — extract_outcome_data","text":"","code":"extract_outcome_data(   snps,   outcomes,   proxies = TRUE,   rsq = 0.8,   align_alleles = 1,   palindromes = 1,   maf_threshold = 0.3,   opengwas_jwt = ieugwasr::get_opengwas_jwt(),   splitsize = 10000,   proxy_splitsize = 500 )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_outcome_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Supply the output from read_exposure_data() and all the SNPs therein will be queried against the requested outcomes in remote database using API. — extract_outcome_data","text":"snps Array SNP rs IDs. outcomes Array IDs (see id column output available_outcomes()). proxies Look LD tags? Default TRUE. rsq Minimum LD rsq value (proxies = 1). Default = 0.8. align_alleles Try align tag alleles target alleles (proxies = 1). 1 = yes, 0 = . default 1. palindromes Allow palindromic SNPs (proxies = 1). 1 = yes, 0 = . default 1. maf_threshold MAF threshold try infer palindromic SNPs. default 0.3. opengwas_jwt Used authenticate protected endpoints. Login https://api.opengwas.io obtain jwt. Provide jwt string , store .Renviron keyname OPENGWAS_JWT. splitsize default 10000. proxy_splitsize default 500.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/extract_outcome_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Supply the output from read_exposure_data() and all the SNPs therein will be queried against the requested outcomes in remote database using API. — extract_outcome_data","text":"Dataframe summary statistics available outcomes","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/fishers_combined_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Fisher's combined test — fishers_combined_test","title":"Fisher's combined test — fishers_combined_test","text":"Fisher's combined test","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/fishers_combined_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fisher's combined test — fishers_combined_test","text":"","code":"fishers_combined_test(pval)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/fishers_combined_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fisher's combined test — fishers_combined_test","text":"pval Vector outcome p-values","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/fishers_combined_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fisher's combined test — fishers_combined_test","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Forest plot for multiple exposures and multiple outcomes — forest_plot","title":"Forest plot for multiple exposures and multiple outcomes — forest_plot","text":"Perform MR multiple exposures multiple outcomes. plots results.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forest plot for multiple exposures and multiple outcomes — forest_plot","text":"","code":"forest_plot(   mr_res,   exponentiate = FALSE,   single_snp_method = \"Wald ratio\",   multi_snp_method = \"Inverse variance weighted\",   group_single_categories = TRUE,   by_category = TRUE,   in_columns = FALSE,   threshold = NULL,   xlab = \"\",   xlim = NULL,   trans = \"identity\",   ao_slc = TRUE,   priority = \"Cardiometabolic\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forest plot for multiple exposures and multiple outcomes — forest_plot","text":"mr_res Results mr(). exponentiate Convert effects ? Default FALSE. single_snp_method single SNP methosd use 1 SNP used estimate causal effect? default \"Wald ratio\". multi_snp_method multi-SNP methods use 1 SNPs used estimate causal effect? default \"Inverse variance weighted\". group_single_categories categories one outcome, group together \"\" group. default TRUE. by_category Separate results sections category? default TRUE. in_columns Separate exposures different columns. default FALSE. threshold p-value threshold use colouring points significance level. NULL (default) colour layer applied. xlab x-axis label. in_columns=TRUE exposure values appended end xlab. e.g. xlab=\"Effect \" x-labels read \"Effect exposure1\", \"Effect exposure2\" etc. Otherwise printed . xlim limit x-axis range. Provide vector length 2, lower upper bounds. default NULL. trans Transformation apply x-axis. e.g. \"identity\", \"log2\", etc. default \"identity\". ao_slc retrieve sample size subcategory available_outcomes(). set FALSE mr_res must contain following additional columns: sample_size subcategory. default behaviour use available_outcomes() retrieve sample size subcategory. priority Name category prioritise top forest plot. default \"Cardiometabolic\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forest plot for multiple exposures and multiple outcomes — forest_plot","text":"grid plot object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_1_to_many.html","id":null,"dir":"Reference","previous_headings":"","what":"1-to-many forest plot — forest_plot_1_to_many","title":"1-to-many forest plot — forest_plot_1_to_many","text":"Plot results analysis multiple exposures single outcome single exposure multiple outcomes. Plots effect estimates 95 percent confidence intervals. ordering results plot determined order supplied user. Users may find sort_1_to_many() helpful sorting results prior using 1--many forest plot. plot function works best 50 results designed handle 100 results.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_1_to_many.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"1-to-many forest plot — forest_plot_1_to_many","text":"","code":"forest_plot_1_to_many(   mr_res = \"mr_res\",   b = \"b\",   se = \"se\",   TraitM = \"outcome\",   col1_width = 1,   col1_title = \"\",   exponentiate = FALSE,   trans = \"identity\",   ao_slc = TRUE,   lo = NULL,   up = NULL,   by = NULL,   xlab = \"Effect (95% confidence interval)\",   addcols = NULL,   addcol_widths = NULL,   addcol_titles = \"\",   subheading_size = 6,   shape_points = 15,   colour_scheme = \"black\",   col_text_size = 5,   weight = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_1_to_many.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"1-to-many forest plot — forest_plot_1_to_many","text":"mr_res Data frame results supplied user. default \"mr_res\". b Name column specifying effect exposure outcome. default \"b\". se Name column specifying standard error b. default \"se\". TraitM column specifying names traits. Corresponds 'many' 1--many forest plot. default \"outcome\". col1_width Width Y axis label column specified TraitM argument. default 1. col1_title Title column specified TraitM argument. default \"\". exponentiate Convert log odds ratios odds ratios? Default FALSE. trans Specify x-axis scale. e.g. \"identity\", \"log2\", etc. set \"identity\" additive scale used. set log2 x-axis plotted multiplicative / doubling scale (preferable plotting odds ratios). Default \"identity\". ao_slc Logical; retrieve trait subcategory information using available_outcomes(). Default FALSE. lo Lower limit X axis plot. upper limit X axis plot. Name grouping variable stratify results . Default NULL. xlab X-axis label, default \"Effect (95% confidence interval)\". addcols Name additional columns plot. Character vector. default NULL. addcol_widths Widths Y axis labels additional columns specified addcols argument. Numeric vector. default NULL. addcol_titles Titles additional columns specified addcols argument. Character vector. default NULL. subheading_size text size subheadings specified argument. default 6. shape_points shape data points pass ggplot2::geom_point(). Default set 15 (filled square). colour_scheme general colour scheme plot. Default make text data points \"black\". col_text_size default 5. weight default NULL.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_1_to_many.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"1-to-many forest plot — forest_plot_1_to_many","text":"grid plot object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic.html","id":null,"dir":"Reference","previous_headings":"","what":"A basic forest plot — forest_plot_basic","title":"A basic forest plot — forest_plot_basic","text":"function used create basic forest plot. requires output format_mr_results().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A basic forest plot — forest_plot_basic","text":"","code":"forest_plot_basic(   dat,   section = NULL,   colour_group = NULL,   colour_group_first = TRUE,   xlab = NULL,   bottom = TRUE,   trans = \"identity\",   xlim = NULL,   threshold = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A basic forest plot — forest_plot_basic","text":"dat Output format_mr_results(). section category dat plot. NULL prints everything. colour_group exposure plot. NULL prints everything grouping colour. colour_group_first default TRUE. xlab x-axis label. Default=NULL. bottom Show x-axis? Default=FALSE. trans Transformation x axis. xlim x-axis limits. threshold p-value threshold use colouring points significance level. NULL (default) colour layer applied.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A basic forest plot — forest_plot_basic","text":"ggplot object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic2.html","id":null,"dir":"Reference","previous_headings":"","what":"A basic forest plot — forest_plot_basic2","title":"A basic forest plot — forest_plot_basic2","text":"function used create basic forest plot. requires output format_1_to_many().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A basic forest plot — forest_plot_basic2","text":"","code":"forest_plot_basic2(   dat,   section = NULL,   colour_group = NULL,   colour_group_first = TRUE,   xlab = NULL,   bottom = TRUE,   trans = \"identity\",   xlim = NULL,   lo = lo,   up = up,   subheading_size = subheading_size,   colour_scheme = \"black\",   shape_points = 15 )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A basic forest plot — forest_plot_basic2","text":"dat Output format_1_to_many() section category dat plot. NULL prints everything. colour_group exposure plot. NULL prints everything grouping colour. colour_group_first default TRUE. xlab x-axis label. Default=NULL. bottom Show x-axis? Default=FALSE. trans x-axis scale. xlim x-axis limits. lo Lower limit x axis. Upper limit x axis. subheading_size text size subheadings. subheadings correspond values section argument. colour_scheme general colour scheme plot. Default make text data points \"black\". shape_points shape data points pass ggplot2::geom_point(). Default set 15 (filled square).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/forest_plot_basic2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A basic forest plot — forest_plot_basic2","text":"ggplot object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_1_to_many.html","id":null,"dir":"Reference","previous_headings":"","what":"Format MR results for a 1-to-many forest plot — format_1_to_many","title":"Format MR results for a 1-to-many forest plot — format_1_to_many","text":"function formats user-supplied results forest_plot_1_to_many() function. user supplies results form data frame. data frame assumed contain least three columns data: effect estimates, analysis effect exposure outcome; standard errors effect estimates; column trait names, corresponding 'many' 1--many forest plot.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_1_to_many.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format MR results for a 1-to-many forest plot — format_1_to_many","text":"","code":"format_1_to_many(   mr_res,   b = \"b\",   se = \"se\",   exponentiate = FALSE,   ao_slc = FALSE,   by = NULL,   TraitM = \"outcome\",   addcols = NULL,   weight = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_1_to_many.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format MR results for a 1-to-many forest plot — format_1_to_many","text":"mr_res Data frame results supplied user. b Name column specifying effect exposure outcome. Default = \"b\". se Name column specifying standard error b. Default = \"se\". exponentiate Convert log odds ratios odds ratios? Default=FALSE. ao_slc Logical; retrieve trait subcategory information using available_outcomes(). Default=FALSE. Name column indicating grouping variable stratify results . Default=NULL. TraitM column specifying names traits. Corresponds 'many' 1--many forest plot. Default=\"outcome\". addcols Name additional columns add plot. Character vector. default NULL. weight default NULL.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_1_to_many.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format MR results for a 1-to-many forest plot — format_1_to_many","text":"data frame.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_aries_mqtl.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data from methylation QTL results — format_aries_mqtl","title":"Get data from methylation QTL results — format_aries_mqtl","text":"See format_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_aries_mqtl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data from methylation QTL results — format_aries_mqtl","text":"","code":"format_aries_mqtl(aries_mqtl_subset, type = \"exposure\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_aries_mqtl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data from methylation QTL results — format_aries_mqtl","text":"aries_mqtl_subset Selected rows aries_mqtl data loaded MRInstruments package. type data used \"exposure\" \"outcome\"? Default \"exposure\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_aries_mqtl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data from methylation QTL results — format_aries_mqtl","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_d.html","id":null,"dir":"Reference","previous_headings":"","what":"Format the returned table from the MySQL database — format_d","title":"Format the returned table from the MySQL database — format_d","text":"Format returned table MySQL database","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format the returned table from the MySQL database — format_d","text":"","code":"format_d(d)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format the returned table from the MySQL database — format_d","text":"d Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format the returned table from the MySQL database — format_d","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Read exposure or outcome data — format_data","title":"Read exposure or outcome data — format_data","text":"Reads exposure data. Checks organises columns use MR enrichment tests. Infers p-values possible beta se.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read exposure or outcome data — format_data","text":"","code":"format_data(   dat,   type = \"exposure\",   snps = NULL,   header = TRUE,   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   units_col = \"units\",   ncase_col = \"ncase\",   ncontrol_col = \"ncontrol\",   samplesize_col = \"samplesize\",   gene_col = \"gene\",   id_col = \"id\",   min_pval = 1e-200,   z_col = \"z\",   info_col = \"info\",   chr_col = \"chr\",   pos_col = \"pos\",   log_pval = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read exposure or outcome data — format_data","text":"dat Data frame. Must header least SNP column present. type exposure outcome data read ? default \"exposure\". snps SNPs extract. NULL extract keeps . default NULL. header default TRUE. phenotype_col Optional column name column phenotype name corresponding SNP. present created value \"Outcome\". default \"Phenotype\". snp_col Required name column SNP rs IDs. default \"SNP\". beta_col Required MR. Name column effect sizes. default \"beta\". se_col Required MR. Name column standard errors. default \"se\". eaf_col Required MR. Name column effect allele frequency. default \"eaf\". effect_allele_col Required MR. Name column effect allele. Must contain characters \"\", \"C\", \"T\" \"G\". default \"effect_allele\". other_allele_col Required MR. Name column non effect allele. Must contain characters \"\", \"C\", \"T\" \"G\". default \"other_allele\". pval_col Required enrichment tests. Name column p-value. default \"pval\". units_col Optional column name units. default \"units\". ncase_col Optional column name number cases. default \"ncase\". ncontrol_col Optional column name number controls. default \"ncontrol\". samplesize_col Optional column name sample size. default \"samplesize\". gene_col Optional column name gene name. default \"gene\". id_col default \"id\". min_pval Minimum allowed p-value. default 1e-200. z_col default \"z\". info_col default \"info_col\". chr_col default \"chr_col\". pos_col default \"pos\". log_pval pval -log10(P). default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read exposure or outcome data — format_data","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gtex_eqtl.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data from eQTL catalog into correct format — format_gtex_eqtl","title":"Get data from eQTL catalog into correct format — format_gtex_eqtl","text":"See format_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gtex_eqtl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data from eQTL catalog into correct format — format_gtex_eqtl","text":"","code":"format_gtex_eqtl(gtex_eqtl_subset, type = \"exposure\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gtex_eqtl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data from eQTL catalog into correct format — format_gtex_eqtl","text":"gtex_eqtl_subset Selected rows gtex_eqtl data loaded MRInstruments package. type data used \"exposure\" \"outcome\"? Default \"exposure\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gtex_eqtl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data from eQTL catalog into correct format — format_gtex_eqtl","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gwas_catalog.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","title":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","text":"DEPRECATED. Please use format_data() instead.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gwas_catalog.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","text":"","code":"format_gwas_catalog(gwas_catalog_subset, type = \"exposure\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gwas_catalog.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","text":"gwas_catalog_subset GWAS catalog subset. type default \"exposure\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gwas_catalog.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_gwas_catalog.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get data selected from GWAS catalog into correct format — format_gwas_catalog","text":"","code":"if (FALSE) { # \\dontrun{ require(MRInstruments) data(gwas_catalog) bmi <- subset(gwas_catalog, Phenotype==\"Body mass index\" & Year==2010 & grepl(\"kg\", Units)) bmi <- format_data(bmi) } # }"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_metab_qtls.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data from metabolomic QTL results — format_metab_qtls","title":"Get data from metabolomic QTL results — format_metab_qtls","text":"See format_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_metab_qtls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data from metabolomic QTL results — format_metab_qtls","text":"","code":"format_metab_qtls(metab_qtls_subset, type = \"exposure\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_metab_qtls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data from metabolomic QTL results — format_metab_qtls","text":"metab_qtls_subset Selected rows metab_qtls data loaded MRInstruments package. type data used \"exposure\" \"outcome\"? Default \"exposure\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_metab_qtls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data from metabolomic QTL results — format_metab_qtls","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_mr_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Format MR results for forest plot — format_mr_results","title":"Format MR results for forest plot — format_mr_results","text":"function takes results mr() particularly useful MR applied using multiple exposures multiple outcomes. creates new data frame following: Variables: exposure, outcome, category, outcome sample size, effect, upper ci, lower ci, pval, nsnp one estimate exposure-outcome exponentiated effects required","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_mr_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format MR results for forest plot — format_mr_results","text":"","code":"format_mr_results(   mr_res,   exponentiate = FALSE,   single_snp_method = \"Wald ratio\",   multi_snp_method = \"Inverse variance weighted\",   ao_slc = TRUE,   priority = \"Cardiometabolic\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_mr_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format MR results for forest plot — format_mr_results","text":"mr_res Results mr(). exponentiate Convert effects ? default FALSE. single_snp_method single SNP methods use 1 SNP used estimate causal effect? default \"Wald ratio\". multi_snp_method multi-SNP methods use 1 SNPs used estimate causal effect? default \"Inverse variance weighted\". ao_slc Logical; retrieve sample size subcategory using available_outcomes(). set FALSE mr_res must contain following additional columns: subcategory sample_size. priority Name category prioritise top forest plot. default \"Cardiometabolic\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_mr_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format MR results for forest plot — format_mr_results","text":"data frame.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_mr_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Format MR results for forest plot — format_mr_results","text":"default uses available_outcomes() function retrieve study level characteristics outcome trait, including sample size outcome category. assumes MR analysis performed using outcome GWAS(s) contained OpenGWAS. ao_slc set TRUE user must supply study level characteristics. useful user supplied outcome GWAS results (.e. OpenGWAS).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_proteomic_qtls.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data from proteomic QTL results — format_proteomic_qtls","title":"Get data from proteomic QTL results — format_proteomic_qtls","text":"See format_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_proteomic_qtls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data from proteomic QTL results — format_proteomic_qtls","text":"","code":"format_proteomic_qtls(proteomic_qtls_subset, type = \"exposure\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_proteomic_qtls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data from proteomic QTL results — format_proteomic_qtls","text":"proteomic_qtls_subset Selected rows proteomic_qtls data loaded MRInstruments package. type data used \"exposure\" \"outcome\"? Default \"exposure\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/format_proteomic_qtls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data from proteomic QTL results — format_proteomic_qtls","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/generate_odds_ratios.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate odds ratios — generate_odds_ratios","title":"Generate odds ratios — generate_odds_ratios","text":"function takes b se mr() generates odds ratios 95 percent confidence intervals.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/generate_odds_ratios.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate odds ratios — generate_odds_ratios","text":"","code":"generate_odds_ratios(mr_res)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/generate_odds_ratios.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate odds ratios — generate_odds_ratios","text":"mr_res Results mr().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/generate_odds_ratios.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate odds ratios — generate_odds_ratios","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_p_from_r2n.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate p-value from R-squared and sample size — get_p_from_r2n","title":"Calculate p-value from R-squared and sample size — get_p_from_r2n","text":"Calculate p-value R-squared sample size","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_p_from_r2n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate p-value from R-squared and sample size — get_p_from_r2n","text":"","code":"get_p_from_r2n(r2, n)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_p_from_r2n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate p-value from R-squared and sample size — get_p_from_r2n","text":"r2 Rsq n Sample size","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_p_from_r2n.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate p-value from R-squared and sample size — get_p_from_r2n","text":"P-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_population_allele_frequency.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the allele frequency in population from case/control summary data — get_population_allele_frequency","title":"Estimate the allele frequency in population from case/control summary data — get_population_allele_frequency","text":"Estimate allele frequency population case/control summary data","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_population_allele_frequency.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the allele frequency in population from case/control summary data — get_population_allele_frequency","text":"","code":"get_population_allele_frequency(af, prop, odds_ratio, prevalence)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_population_allele_frequency.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the allele frequency in population from case/control summary data — get_population_allele_frequency","text":"af Effect allele frequency (MAF) prop Proportion samples cases odds_ratio Odds ratio prevalence Population disease prevalence","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_population_allele_frequency.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the allele frequency in population from case/control summary data — get_population_allele_frequency","text":"Population allele frequency","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_bsen.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate R-squared from beta, standard error and sample size — get_r_from_bsen","title":"Estimate R-squared from beta, standard error and sample size — get_r_from_bsen","text":"Estimate R-squared beta, standard error sample size","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_bsen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate R-squared from beta, standard error and sample size — get_r_from_bsen","text":"","code":"get_r_from_bsen(b, se, n)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_bsen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate R-squared from beta, standard error and sample size — get_r_from_bsen","text":"b Array effect sizes se Array standard errors n Array (effective) sample sizes","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_bsen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate R-squared from beta, standard error and sample size — get_r_from_bsen","text":"Vector signed r values","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_lor.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate proportion of variance of liability explained by SNP in general population — get_r_from_lor","title":"Estimate proportion of variance of liability explained by SNP in general population — get_r_from_lor","text":"uses equation 10 Lee et al. Better Coefficient Determination Genetic Profile Analysis. Genetic Epidemiology 36: 214–224 (2012) doi:10.1002/gepi.21614 .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_lor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate proportion of variance of liability explained by SNP in general population — get_r_from_lor","text":"","code":"get_r_from_lor(   lor,   af,   ncase,   ncontrol,   prevalence,   model = \"logit\",   correction = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_lor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate proportion of variance of liability explained by SNP in general population — get_r_from_lor","text":"lor Vector Log odds ratio. af Vector allele frequencies. ncase Vector Number cases. ncontrol Vector Number controls. prevalence Vector Disease prevalence population. model effect size estimated \"logit\" (default) \"probit\" model. correction Scale estimated r correction value. default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_lor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate proportion of variance of liability explained by SNP in general population — get_r_from_lor","text":"Vector signed r values","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_pn.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate variance explained from p-values and sample size — get_r_from_pn","title":"Calculate variance explained from p-values and sample size — get_r_from_pn","text":"method approximation, may numerically unstable. Ideally estimate r directly independent replication samples. Use get_r_from_lor() binary traits.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_pn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate variance explained from p-values and sample size — get_r_from_pn","text":"","code":"get_r_from_pn(p, n)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_pn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate variance explained from p-values and sample size — get_r_from_pn","text":"p Array pvals n Array sample sizes","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_r_from_pn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate variance explained from p-values and sample size — get_r_from_pn","text":"Vector r values (arbitrarily positive)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SE from effect size and p-value — get_se","title":"Get SE from effect size and p-value — get_se","text":"Get SE effect size p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SE from effect size and p-value — get_se","text":"","code":"get_se(eff, pval)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SE from effect size and p-value — get_se","text":"eff effect size pval p-values","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/get_se.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get SE from effect size and p-value — get_se","text":"array","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","title":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","text":"order perform MR effect SNP outcome exposure must harmonised relative allele.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","text":"","code":"harmonise_data(exposure_dat, outcome_dat, action = 2)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","text":"exposure_dat Output read_exposure_data(). outcome_dat Output extract_outcome_data(). action Level strictness dealing SNPs. action = 1: Assume alleles coded forward strand, .e. attempt flip alleles action = 2: Try infer positive strand alleles, using allele frequencies palindromes (default, conservative); action = 3: Correct strand non-palindromic SNPs, drop palindromic SNPs analysis (conservative). single value passed action applied outcomes. multiple values can supplied vector, element relating different outcome.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","text":"Data frame harmonised effects alleles","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Harmonise the alleles and effects between the exposure and outcome — harmonise_data","text":"Expects data format generated read_exposure_data() extract_outcome_data(). means inputs must dataframes following columns: outcome_dat: SNP beta.outcome se.outcome effect_allele.outcome other_allele.outcome eaf.outcome outcome exposure_dat: SNP beta.exposure se.exposure effect_allele.exposure other_allele.exposure eaf.exposure function tries harmonise INDELs. coded sequence strings things work smoothly. coded D/one dataset try convert sequences dataset adequate information. coded D/one dataset variant equal length INDEL alleles , variant dropped. one datasets one allele (.e. effect allele) harmonisation naturally going ambiguous variants dropped.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_ld_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmonise LD matrix against summary data — harmonise_ld_dat","title":"Harmonise LD matrix against summary data — harmonise_ld_dat","text":"LD matrix returns rsid_ea_oa identifiers. Make sure oriented effect allele summary dataset. Summary dataset can exposure dataset harmonised dartaset.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_ld_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmonise LD matrix against summary data — harmonise_ld_dat","text":"","code":"harmonise_ld_dat(x, ld)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_ld_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmonise LD matrix against summary data — harmonise_ld_dat","text":"x Exposure dataset harmonised dataset ld Output ld_matrix()","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/harmonise_ld_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Harmonise LD matrix against summary data — harmonise_ld_dat","text":"List exposure dataset harmonised LD matrix","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/knit_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Knit report using working environment — knit_report","title":"Knit report using working environment — knit_report","text":"Warning: quite likely called within Rmd file implying recursive call knit(). generate \"duplicate label\" errors unlabelled chunks. avoid , code chunks Rmd file named. Supposedly error can also avoided setting following option: options(knitr.duplicate.label = 'allow'). tried seem help.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/knit_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Knit report using working environment — knit_report","text":"","code":"knit_report(input_filename, output_filename, ...)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/knit_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Knit report using working environment — knit_report","text":"input_filename Rmd file. output_filename Markdown HTML output file.  HTML file specified using .htm, .html, .HTM .HTML file extension. html specified, similarly named markdown file also generated. output files including cache figures appear folder output_filename. ... Arguments passed knitr::knit()","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ld_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get LD matrix for list of SNPs — ld_matrix","title":"Get LD matrix for list of SNPs — ld_matrix","text":"function takes list SNPs searches specified super-population 1000 Genomes phase 3 reference panel. creates LD matrix r values (signed, squared). LD values respect major alleles 1000G dataset. can specify whether allele names displayed.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ld_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get LD matrix for list of SNPs — ld_matrix","text":"","code":"ld_matrix(snps, with_alleles = TRUE, pop = \"EUR\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ld_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get LD matrix for list of SNPs — ld_matrix","text":"snps List SNPs. with_alleles Whether append allele names SNP names. default TRUE. pop Super-population use reference panel. Default = \"EUR\". Options \"EUR\", \"SAS\", \"EAS\", \"AFR\", \"AMR\". 'legacy' also available - previously used version EUR panel slightly different set markers.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ld_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get LD matrix for list of SNPs — ld_matrix","text":"Matrix LD r values","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ld_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get LD matrix for list of SNPs — ld_matrix","text":"data used generating LD matrix includes bi-allelic SNPs MAF > 0.01, quite possible variant want include absent. absent, automatically excluded results. can check variants present LD reference panel using ieugwasr::ld_reflookup(). function put load OpenGWAS servers, makes life difficult users, limited analyse 500 variants time. implemented method made available LD reference panels perform operation locally, see ieugwasr::ld_matrix() related vignettes details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate LDSC — ldsc_h2","title":"Univariate LDSC — ldsc_h2","text":"Imported help estimate sample overlap studies","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate LDSC — ldsc_h2","text":"","code":"ldsc_h2(id, ancestry = \"infer\", snpinfo = NULL, splitsize = 20000)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate LDSC — ldsc_h2","text":"id ID analyse ancestry ancestry traits 1 2 (AFR, AMR, EAS, EUR, SAS) 'infer' (default) case try guess based allele frequencies snpinfo Output ieugwasr::afl2_list(\"hapmap3\"), NULL done automatically splitsize many SNPs extract one time. Default=20000","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate LDSC — ldsc_h2","text":"model fit","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Univariate LDSC — ldsc_h2","text":"Bulik-Sullivan,B.K. et al. (2015) atlas genetic correlations across human diseases traits. Nat. Genet. 47, 1236–1241. Guo,B. Wu,B. (2018) Principal component based adaptive association test multiple traits using GWAS summary statistics. bioRxiv 269597; doi: 10.1101/269597 Gua,B. Wu,B. (2019) Integrate multiple traits detect novel trait-gene association using GWAS summary data adaptive test approach. Bioinformatics. 2019 Jul 1;35(13):2251-2257. doi: 10.1093/bioinformatics/bty961. https://github.com/baolinwu/MTAR","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate LDSC — ldsc_h2_internal","title":"Univariate LDSC — ldsc_h2_internal","text":"Imported help estimate sample overlap studies","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2_internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate LDSC — ldsc_h2_internal","text":"","code":"ldsc_h2_internal(Z, r2, N, W = NULL)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2_internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate LDSC — ldsc_h2_internal","text":"Z summary Z-statistics M variants r2 average reference LD scores M variants N GWAS sample size variant (different across variants) W variant weight","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_h2_internal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate LDSC — ldsc_h2_internal","text":"model fit","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg.html","id":null,"dir":"Reference","previous_headings":"","what":"Bivariate LDSC — ldsc_rg","title":"Bivariate LDSC — ldsc_rg","text":"Imported help estimate sample overlap studies","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bivariate LDSC — ldsc_rg","text":"","code":"ldsc_rg(id1, id2, ancestry = \"infer\", snpinfo = NULL, splitsize = 20000)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bivariate LDSC — ldsc_rg","text":"id1 ID 1 analyse id2 ID 2 analyse ancestry ancestry traits 1 2 (AFR, AMR, EAS, EUR, SAS) 'infer' (default) case try guess based allele frequencies snpinfo Output ieugwasr::afl2_list(\"hapmap3\"), NULL done automatically splitsize many SNPs extract one time. Default=20000","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bivariate LDSC — ldsc_rg","text":"model fit","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Bivariate LDSC — ldsc_rg_internal","title":"Bivariate LDSC — ldsc_rg_internal","text":"Imported help estimate sample overlap studies","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg_internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bivariate LDSC — ldsc_rg_internal","text":"","code":"ldsc_rg_internal(Zs, r2, h1, h2, N1, N2, Nc = 0, W = NULL)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg_internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bivariate LDSC — ldsc_rg_internal","text":"Zs Mx2 matrix summary Z-statistics M variants two GWAS r2 average reference LD scores M variants h1 hsq trait 1 h2 hsq trait 2 N1 sample size 1st GWAS N2 sample size 2nd GWAS Nc overlapped sample size two GWAS W variant weight","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg_internal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bivariate LDSC — ldsc_rg_internal","text":"List models","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/ldsc_rg_internal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bivariate LDSC — ldsc_rg_internal","text":"Bulik-Sullivan,B.K. et al. (2015) atlas genetic correlations across human diseases traits. Nat. Genet. 47, 1236–1241. Guo,B. Wu,B. (2018) Principal component based adaptive association test multiple traits using GWAS summary statistics. bioRxiv 269597; doi: 10.1101/269597 Gua,B. Wu,B. (2019) Integrate multiple traits detect novel trait-gene association using GWAS summary data adaptive test approach. Bioinformatics. 2019 Jul 1;35(13):2251-2257. doi: 10.1093/bioinformatics/bty961. https://github.com/baolinwu/MTAR","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/make_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Convenient function to create a harmonised dataset — make_dat","title":"Convenient function to create a harmonised dataset — make_dat","text":"Convenient function create harmonised dataset.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/make_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convenient function to create a harmonised dataset — make_dat","text":"","code":"make_dat(   exposures = c(\"ieu-a-2\", \"ieu-a-301\"),   outcomes = c(\"ieu-a-7\", \"ieu-a-1001\"),   proxies = TRUE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/make_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convenient function to create a harmonised dataset — make_dat","text":"exposures default c(\"ieu--2\", \"ieu--301\") (BMI LDL). outcomes default c(\"ieu--7\", \"ieu--1001\") (CHD EDU). proxies Look proxies? Default = TRUE","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/make_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convenient function to create a harmonised dataset — make_dat","text":"Harmonised data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform all Mendelian randomization tests — mr","title":"Perform all Mendelian randomization tests — mr","text":"Perform Mendelian randomization tests","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform all Mendelian randomization tests — mr","text":"","code":"mr(   dat,   parameters = default_parameters(),   method_list = subset(mr_method_list(), use_by_default)$obj )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform all Mendelian randomization tests — mr","text":"dat Harmonised exposure outcome data. Output harmonise_data(). parameters Parameters used various MR methods. Default output default_parameters(). method_list List methods use analysis. See mr_method_list() details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform all Mendelian randomization tests — mr","text":"List following elements: mr Table MR results extra Table extra results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_density_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Density plot — mr_density_plot","title":"Density plot — mr_density_plot","text":"Density plot","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_density_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density plot — mr_density_plot","text":"","code":"mr_density_plot(   singlesnp_results,   mr_results,   exponentiate = FALSE,   bandwidth = \"nrd0\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_density_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density plot — mr_density_plot","text":"singlesnp_results mr_singlesnp(). mr_results Results mr(). exponentiate Plot exponentiated scale. default FALSE. bandwidth Density bandwidth parameter.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_density_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density plot — mr_density_plot","text":"List plots","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Egger's regression for Mendelian randomization — mr_egger_regression","title":"Egger's regression for Mendelian randomization — mr_egger_regression","text":"Egger's regression Mendelian randomization","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Egger's regression for Mendelian randomization — mr_egger_regression","text":"","code":"mr_egger_regression(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Egger's regression for Mendelian randomization — mr_egger_regression","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Egger's regression for Mendelian randomization — mr_egger_regression","text":"List following elements: b MR estimate se Standard error MR estimate pval p-value MR estimate b_i Estimate horizontal pleiotropy (intercept) se_i Standard error intercept pval_i p-value intercept Q, Q_df, Q_pval Heterogeneity stats mod Summary regression dat Original data used MR Egger regression","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Run bootstrap to generate standard errors for MR — mr_egger_regression_bootstrap","title":"Run bootstrap to generate standard errors for MR — mr_egger_regression_bootstrap","text":"Run bootstrap generate standard errors MR","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run bootstrap to generate standard errors for MR — mr_egger_regression_bootstrap","text":"","code":"mr_egger_regression_bootstrap(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run bootstrap to generate standard errors for MR — mr_egger_regression_bootstrap","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters. Specifically, nboot parameter can specified number bootstrap replications. default parameters=list(nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_egger_regression_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run bootstrap to generate standard errors for MR — mr_egger_regression_bootstrap","text":"List following elements: b MR estimate se Standard error MR estimate pval p-value MR estimate b_i Estimate horizontal pleiotropy (intercept) se_i Standard error intercept pval_i p-value intercept mod Summary regression dat Original data used MR Egger regression","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Forest plot — mr_forest_plot","title":"Forest plot — mr_forest_plot","text":"Forest plot","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forest plot — mr_forest_plot","text":"","code":"mr_forest_plot(singlesnp_results, exponentiate = FALSE)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forest plot — mr_forest_plot","text":"singlesnp_results mr_singlesnp(). exponentiate Plot exponential scale. default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forest plot — mr_forest_plot","text":"List plots","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot_grouped.html","id":null,"dir":"Reference","previous_headings":"","what":"Grouped forest plot — mr_forest_plot_grouped","title":"Grouped forest plot — mr_forest_plot_grouped","text":"Grouped forest plot","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot_grouped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grouped forest plot — mr_forest_plot_grouped","text":"","code":"mr_forest_plot_grouped(   name,   eff_Col = \"b\",   exposure_Name = \"exposure\",   outcome_Name = \"outcome\",   forest_Title = \"\",   outfile_Name = \"annot_FP.pdf\",   left_Col_Names = c(\"Exposure\", \"Outcome\"),   left_Col_Titles = NULL,   right_Col_Names = c(\"p\", \"Outcome.n.case\", \"Outcome.n.control\", \"Outcome.sample.size\"),   right_Col_Titles = NULL,   debug = FALSE,   log_ES = FALSE,   decrease = TRUE,   returnRobj = TRUE,   se_Col = \"se\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot_grouped.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Grouped forest plot — mr_forest_plot_grouped","text":"name (character) name delimited file containing results first sheet (needs headers), r object. eff_Col (character) name column delimited file contains effect sizes. exposure_Name (character) name column delimited file containing types studies. outcome_Name (character) name column delimited file containing names study. forest_Title (character) title used forest plot. outfile_Name (character) name used output file (.pdf) (.wmf). left_Col_Names (character vector) vector containing names left-hand-side annotation columns delimited file. left_Col_Titles (character vector) vector containing titles left-hand-side annotation column. right_Col_Names (character vector) vector containing names right-hand-side annotation columns delimited file. right_Col_Titles (character vector) vector containing titles right-hand-side annotation column. debug (logical) show warnings TRUE/FALSE? log_ES (logical) perform natural log transform effect sizes confidence bounds TRUE/FALSE? decrease (logical) sort studies decreasing effect sizes TRUE/FALSE? returnRobj (logical) return graph internal R object TRUE/FALSE? se_Col (character) name column giving standard error effect sizes.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_forest_plot_grouped.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Grouped forest plot — mr_forest_plot_grouped","text":"grid object giving forest plot (plot pdf)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_funnel_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Funnel plot — mr_funnel_plot","title":"Funnel plot — mr_funnel_plot","text":"Create funnel plot single SNP analyses.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_funnel_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Funnel plot — mr_funnel_plot","text":"","code":"mr_funnel_plot(singlesnp_results)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_funnel_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Funnel plot — mr_funnel_plot","text":"singlesnp_results mr_singlesnp().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_funnel_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Funnel plot — mr_funnel_plot","text":"List plots","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_heterogeneity.html","id":null,"dir":"Reference","previous_headings":"","what":"Get heterogeneity statistics — mr_heterogeneity","title":"Get heterogeneity statistics — mr_heterogeneity","text":"Get heterogeneity statistics.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_heterogeneity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get heterogeneity statistics — mr_heterogeneity","text":"","code":"mr_heterogeneity(   dat,   parameters = default_parameters(),   method_list = subset(mr_method_list(), heterogeneity_test & use_by_default)$obj )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_heterogeneity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get heterogeneity statistics — mr_heterogeneity","text":"dat Harmonised exposure outcome data. Output harmonise_data(). parameters Parameters used various MR methods. Default output default_parameters(). method_list List methods use analysis. See mr_method_list() details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_heterogeneity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get heterogeneity statistics — mr_heterogeneity","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse variance weighted regression — mr_ivw","title":"Inverse variance weighted regression — mr_ivw","text":"default multiplicative random effects IVW estimate. standard error corrected dispersion Use mr_ivw_mre() function estimates correct dispersion.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse variance weighted regression — mr_ivw","text":"","code":"mr_ivw(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse variance weighted regression — mr_ivw","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse variance weighted regression — mr_ivw","text":"List following elements: b MR estimate se Standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_fe.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse variance weighted regression (fixed effects) — mr_ivw_fe","title":"Inverse variance weighted regression (fixed effects) — mr_ivw_fe","text":"Inverse variance weighted regression (fixed effects)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_fe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse variance weighted regression (fixed effects) — mr_ivw_fe","text":"","code":"mr_ivw_fe(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_fe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse variance weighted regression (fixed effects) — mr_ivw_fe","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_fe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse variance weighted regression (fixed effects) — mr_ivw_fe","text":"List following elements: b MR estimate se Standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_mre.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse variance weighted regression (multiplicative random effects model) — mr_ivw_mre","title":"Inverse variance weighted regression (multiplicative random effects model) — mr_ivw_mre","text":"mr_ivw() correction dispersion.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_mre.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse variance weighted regression (multiplicative random effects model) — mr_ivw_mre","text":"","code":"mr_ivw_mre(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_mre.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse variance weighted regression (multiplicative random effects model) — mr_ivw_mre","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_mre.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse variance weighted regression (multiplicative random effects model) — mr_ivw_mre","text":"List following elements: b MR estimate se Standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_radial.html","id":null,"dir":"Reference","previous_headings":"","what":"Radial IVW analysis — mr_ivw_radial","title":"Radial IVW analysis — mr_ivw_radial","text":"Radial IVW analysis","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_radial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Radial IVW analysis — mr_ivw_radial","text":"","code":"mr_ivw_radial(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_radial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Radial IVW analysis — mr_ivw_radial","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_ivw_radial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Radial IVW analysis — mr_ivw_radial","text":"List following elements: b causal effect estimate se standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout.html","id":null,"dir":"Reference","previous_headings":"","what":"Leave one out sensitivity analysis — mr_leaveoneout","title":"Leave one out sensitivity analysis — mr_leaveoneout","text":"Leave one sensitivity analysis","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Leave one out sensitivity analysis — mr_leaveoneout","text":"","code":"mr_leaveoneout(dat, parameters = default_parameters(), method = mr_ivw)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Leave one out sensitivity analysis — mr_leaveoneout","text":"dat Output harmonise_data(). parameters List parameters. method Choose method use. default mr_ivw.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Leave one out sensitivity analysis — mr_leaveoneout","text":"List data frames","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot results from leaveoneout analysis — mr_leaveoneout_plot","title":"Plot results from leaveoneout analysis — mr_leaveoneout_plot","text":"Plot results leaveoneout analysis.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot results from leaveoneout analysis — mr_leaveoneout_plot","text":"","code":"mr_leaveoneout_plot(leaveoneout_results)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot results from leaveoneout analysis — mr_leaveoneout_plot","text":"leaveoneout_results Output mr_leaveoneout().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_leaveoneout_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot results from leaveoneout analysis — mr_leaveoneout_plot","text":"List plots","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_median.html","id":null,"dir":"Reference","previous_headings":"","what":"MR median estimators — mr_median","title":"MR median estimators — mr_median","text":"MR median estimators","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR median estimators — mr_median","text":"","code":"mr_median(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR median estimators — mr_median","text":"dat Output harmonise_data(). parameters List parameters. default default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR median estimators — mr_median","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform 2 sample IV using fixed effects meta analysis and delta method for standard errors — mr_meta_fixed","title":"Perform 2 sample IV using fixed effects meta analysis and delta method for standard errors — mr_meta_fixed","text":"Perform 2 sample IV using fixed effects meta analysis delta method standard errors","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform 2 sample IV using fixed effects meta analysis and delta method for standard errors — mr_meta_fixed","text":"","code":"mr_meta_fixed(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform 2 sample IV using fixed effects meta analysis and delta method for standard errors — mr_meta_fixed","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform 2 sample IV using fixed effects meta analysis and delta method for standard errors — mr_meta_fixed","text":"List following elements: b causal effect estimate se standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform 2 sample IV using simple standard error — mr_meta_fixed_simple","title":"Perform 2 sample IV using simple standard error — mr_meta_fixed_simple","text":"Perform 2 sample IV using simple standard error","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform 2 sample IV using simple standard error — mr_meta_fixed_simple","text":"","code":"mr_meta_fixed_simple(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform 2 sample IV using simple standard error — mr_meta_fixed_simple","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_fixed_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform 2 sample IV using simple standard error — mr_meta_fixed_simple","text":"List following elements: b causal effect estimate se standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform 2 sample IV using random effects meta analysis and delta method for standard errors — mr_meta_random","title":"Perform 2 sample IV using random effects meta analysis and delta method for standard errors — mr_meta_random","text":"Perform 2 sample IV using random effects meta analysis delta method standard errors","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform 2 sample IV using random effects meta analysis and delta method for standard errors — mr_meta_random","text":"","code":"mr_meta_random(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform 2 sample IV using random effects meta analysis and delta method for standard errors — mr_meta_random","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_meta_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform 2 sample IV using random effects meta analysis and delta method for standard errors — mr_meta_random","text":"List following elements: b causal effect estimate se standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_method_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Get list of available MR methods — mr_method_list","title":"Get list of available MR methods — mr_method_list","text":"Get list available MR methods","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_method_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get list of available MR methods — mr_method_list","text":"","code":"mr_method_list()"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_method_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get list of available MR methods — mr_method_list","text":"character vector method names","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_mode.html","id":null,"dir":"Reference","previous_headings":"","what":"MR mode estimators — mr_mode","title":"MR mode estimators — mr_mode","text":"Perform simple, weighted, penalised modes, well versions use NOME assumption.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_mode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR mode estimators — mr_mode","text":"","code":"mr_mode(dat, parameters = default_parameters(), mode_method = \"all\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_mode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR mode estimators — mr_mode","text":"dat Output harmonise_data(). parameters List parameters. default default_parameters(). mode_method default \"\". choices 'Simple mode', 'Weighted mode', 'Penalised mode', 'Simple mode (NOME)', 'Weighted mode (NOME)'.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_mode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR mode estimators — mr_mode","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixture of experts — mr_moe","title":"Mixture of experts — mr_moe","text":"Based method described https://www.biorxiv.org/content/10.1101/173682v2. MR methods applied summary set, can use mixture experts predict method likely accurate.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixture of experts — mr_moe","text":"","code":"mr_moe(res, rf)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixture of experts — mr_moe","text":"res Output mr_wrapper(). rf trained random forest methods. available download https://www.dropbox.com/s/5la7y38od95swcf/rf.rdata?dl=0.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixture of experts — mr_moe","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mixture of experts — mr_moe","text":"mr_moe() function modifies estimates item list results mr_wrapper() function. three things: Adds MOE column, predictor method well performs terms high power low type 1 error (scaled 0-1, 1 best performance). renames methods estimating method + instrument selection method. 4 instrument selection methods: Tophits (.e. filtering), directional filtering (DF, unthresholded version Steiger filtering), heterogeneity filtering (HF, removing instruments make substantial (p < 0.05) contributions Cochran's Q statistic), DF + HF DF applied HF applied top . orders table order best performing method. Note mixture experts trained datasets least 5 SNPs. dataset fewer 5 SNPs function might return errors.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_moe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mixture of experts — mr_moe","text":"","code":"if (FALSE) { # \\dontrun{ # Example of body mass index on coronary heart disease # Extract and harmonise data a <- extract_instruments(\"ieu-a-2\") b <- extract_outcome_data(a$SNP, 7) dat <- harmonise_data(a, b)  # Apply all MR methods r <- mr_wrapper(dat)  # Load the rf object containing the trained models load(\"rf.rdata\") # Update the results with mixture of experts r <- mr_moe(r, rf)  # Now you can view the estimates, and see that they have # been sorted in order from most likely to least likely to # be accurate, based on MOE prediction r[[1]]$estimates } # }"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_penalised_weighted_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Penalised weighted median MR — mr_penalised_weighted_median","title":"Penalised weighted median MR — mr_penalised_weighted_median","text":"Modification standard weighted median MR Updated based Burgess 2016 \"Robust instrumental variable methods using multiple candidate instruments application Mendelian randomization\"","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_penalised_weighted_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Penalised weighted median MR — mr_penalised_weighted_median","text":"","code":"mr_penalised_weighted_median(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_penalised_weighted_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Penalised weighted median MR — mr_penalised_weighted_median","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp Standard errors genetic effects exposure se_out Standard errors genetic effects outcome parameters List containing penk - Constant term penalisation, nboot - number bootstrap replications calculate SE. default_parameters() sets parameters=list(penk=20, nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_penalised_weighted_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Penalised weighted median MR — mr_penalised_weighted_median","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_pleiotropy_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Test for horizontal pleiotropy in MR analysis — mr_pleiotropy_test","title":"Test for horizontal pleiotropy in MR analysis — mr_pleiotropy_test","text":"Performs MR Egger returns intercept values.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_pleiotropy_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test for horizontal pleiotropy in MR analysis — mr_pleiotropy_test","text":"","code":"mr_pleiotropy_test(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_pleiotropy_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test for horizontal pleiotropy in MR analysis — mr_pleiotropy_test","text":"dat Harmonised exposure outcome data. Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_pleiotropy_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test for horizontal pleiotropy in MR analysis — mr_pleiotropy_test","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":null,"dir":"Reference","previous_headings":"","what":"Robust adjusted profile score — mr_raps","title":"Robust adjusted profile score — mr_raps","text":"Robust adjusted profile score","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Robust adjusted profile score — mr_raps","text":"","code":"mr_raps(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Robust adjusted profile score — mr_raps","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters list parameters. Specifically, .dispersion loss.function. .dispersion logical concerning model consider overdispersion (systematic pleiotropy). loss.function allows using either squared error loss (\"l2\") robust loss functions/scores (\"huber\" \"tukey\"). default parameters=list(overdispersion = TRUE, loss.function = \"tukey\").","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Robust adjusted profile score — mr_raps","text":"List following elements: b MR estimate se Standard error pval p-value nsnp Number SNPs","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Robust adjusted profile score — mr_raps","text":"function calls mr.raps package. Please refer documentation package detail.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_raps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Robust adjusted profile score — mr_raps","text":"Qingyuan Zhao, Jingshu Wang, Jack Bowden, Dylan S. Small. Statistical inference two-sample summary-data Mendelian randomization using robust adjusted profile score. Forthcoming.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate MR report — mr_report","title":"Generate MR report — mr_report","text":"Using output mr() function report generate report containing tables graphs summarising results. separate report produced exposure - outcome pair analysed.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate MR report — mr_report","text":"","code":"mr_report(   dat,   output_path = \".\",   output_type = \"html\",   author = \"Analyst\",   study = \"Two Sample MR\",   path = system.file(\"reports\", package = \"TwoSampleMR\"),   ... )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate MR report — mr_report","text":"dat Output harmonise_data() output_path Directory reports saved. output_type Choose \"html\" \"md\". Default \"html\". output files including cache figures appear folder specified output_path. author Author name. study Study title. path filepath report template. ... Extra options passed knitr::knit().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker.html","id":null,"dir":"Reference","previous_headings":"","what":"MR Rucker framework — mr_rucker","title":"MR Rucker framework — mr_rucker","text":"MR Rucker framework.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR Rucker framework — mr_rucker","text":"","code":"mr_rucker(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR Rucker framework — mr_rucker","text":"dat Output harmonise_data(). parameters List Qthresh determining transition models, alpha values calculating confidence intervals. Defaults 0.05 default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR Rucker framework — mr_rucker","text":"list","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Run rucker with bootstrap estimates — mr_rucker_bootstrap","title":"Run rucker with bootstrap estimates — mr_rucker_bootstrap","text":"Run Rucker bootstrap estimates.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run rucker with bootstrap estimates — mr_rucker_bootstrap","text":"","code":"mr_rucker_bootstrap(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run rucker with bootstrap estimates — mr_rucker_bootstrap","text":"dat Output harmonise_data(). parameters List parameters. default default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run rucker with bootstrap estimates — mr_rucker_bootstrap","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_cooksdistance.html","id":null,"dir":"Reference","previous_headings":"","what":"MR Rucker with outliers automatically detected and removed — mr_rucker_cooksdistance","title":"MR Rucker with outliers automatically detected and removed — mr_rucker_cooksdistance","text":"Uses Cook's distance D > 4/nsnp iteratively remove outliers.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_cooksdistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR Rucker with outliers automatically detected and removed — mr_rucker_cooksdistance","text":"","code":"mr_rucker_cooksdistance(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_cooksdistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR Rucker with outliers automatically detected and removed — mr_rucker_cooksdistance","text":"dat Output harmonise_data(). parameters List parameters. default default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_cooksdistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR Rucker with outliers automatically detected and removed — mr_rucker_cooksdistance","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_jackknife.html","id":null,"dir":"Reference","previous_headings":"","what":"Run rucker with jackknife estimates — mr_rucker_jackknife","title":"Run rucker with jackknife estimates — mr_rucker_jackknife","text":"Run rucker jackknife estimates.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_jackknife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run rucker with jackknife estimates — mr_rucker_jackknife","text":"","code":"mr_rucker_jackknife(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_jackknife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run rucker with jackknife estimates — mr_rucker_jackknife","text":"dat Output harmonise_data. parameters List parameters. default default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_rucker_jackknife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run rucker with jackknife estimates — mr_rucker_jackknife","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_scatter_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scatter plot with lines showing the causal estimate for different MR tests — mr_scatter_plot","title":"Create scatter plot with lines showing the causal estimate for different MR tests — mr_scatter_plot","text":"Requires dev version ggplot2","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_scatter_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scatter plot with lines showing the causal estimate for different MR tests — mr_scatter_plot","text":"","code":"mr_scatter_plot(mr_results, dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_scatter_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scatter plot with lines showing the causal estimate for different MR tests — mr_scatter_plot","text":"mr_results Output mr(). dat Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_scatter_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scatter plot with lines showing the causal estimate for different MR tests — mr_scatter_plot","text":"List plots","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_sign.html","id":null,"dir":"Reference","previous_headings":"","what":"MR sign test — mr_sign","title":"MR sign test — mr_sign","text":"Tests often SNP-exposure SNP-outcome signs concordant. avoid problem averaging SNPs, can suffer bias due outliers strong effects; avoid excluding SNPs implicit median mode based estimators. effect estimate interpreted effect size - proportion SNP-exposure SNP-outcome effects concordant signs. e.g. +1 means sign, -1 means opposite signs, 0 means equal number concordant discordant signs. Restricted work 6 valid SNPs.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_sign.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR sign test — mr_sign","text":"","code":"mr_sign(b_exp, b_out, se_exp = NULL, se_out = NULL, parameters = NULL)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_sign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR sign test — mr_sign","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp required se_out required parameters required","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_sign.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR sign test — mr_sign","text":"List following elements: b Concordance (see description) se NA pval p-value nsnp Number SNPs (excludes NAs effect estimates 0)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple median method — mr_simple_median","title":"Simple median method — mr_simple_median","text":"Perform MR using summary statistics. Bootstraps used calculate standard error.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple median method — mr_simple_median","text":"","code":"mr_simple_median(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple median method — mr_simple_median","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters number bootstrap replications used calculate SE can set parameters=list(nboot = 1000). default list(nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple median method — mr_simple_median","text":"List following elements: b MR estimate se Standard error pval p-value nsnp number SNPs","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode.html","id":null,"dir":"Reference","previous_headings":"","what":"MR simple mode estimator — mr_simple_mode","title":"MR simple mode estimator — mr_simple_mode","text":"MR simple mode estimator","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR simple mode estimator — mr_simple_mode","text":"","code":"mr_simple_mode(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR simple mode estimator — mr_simple_mode","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp Standard errors genetic effects exposure se_out Standard errors genetic effects outcome parameters List containing phi - Bandwidth parameter, nboot - number bootstraps calculate SE. default_parameters() sets list(phi=1, nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR simple mode estimator — mr_simple_mode","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode_nome.html","id":null,"dir":"Reference","previous_headings":"","what":"MR simple mode estimator (NOME) — mr_simple_mode_nome","title":"MR simple mode estimator (NOME) — mr_simple_mode_nome","text":"MR simple mode estimator (NOME).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode_nome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR simple mode estimator (NOME) — mr_simple_mode_nome","text":"","code":"mr_simple_mode_nome(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode_nome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR simple mode estimator (NOME) — mr_simple_mode_nome","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp Standard errors genetic effects exposure se_out Standard errors genetic effects outcome parameters List containing phi - Bandwidth parameter, nboot - number bootstraps calculate SE. default_parameters() sets list(phi=1, nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_simple_mode_nome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR simple mode estimator (NOME) — mr_simple_mode_nome","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_singlesnp.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform 2 sample MR on each SNP individually — mr_singlesnp","title":"Perform 2 sample MR on each SNP individually — mr_singlesnp","text":"Perform 2 sample MR SNP individually","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_singlesnp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform 2 sample MR on each SNP individually — mr_singlesnp","text":"","code":"mr_singlesnp(   dat,   parameters = default_parameters(),   single_method = \"mr_wald_ratio\",   all_method = c(\"mr_ivw\", \"mr_egger_regression\") )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_singlesnp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform 2 sample MR on each SNP individually — mr_singlesnp","text":"dat Output harmonise_data(). parameters List parameters. default default_parameters(). single_method Function use MR analysis. default \"mr_wald_ratio\". all_method Functions use MR analysis. default c(\"mr_ivw\", \"mr_egger_regression\").","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_singlesnp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform 2 sample MR on each SNP individually — mr_singlesnp","text":"List data frames","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger.html","id":null,"dir":"Reference","previous_headings":"","what":"MR Steiger test of directionality — mr_steiger","title":"MR Steiger test of directionality — mr_steiger","text":"statistical test whether assumption exposure causes outcome valid","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR Steiger test of directionality — mr_steiger","text":"","code":"mr_steiger(p_exp, p_out, n_exp, n_out, r_exp, r_out, r_xxo = 1, r_yyo = 1, ...)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR Steiger test of directionality — mr_steiger","text":"p_exp Vector p-values SNP-exposure p_out Vector p-values SNP-outcome n_exp Sample sizes p_exp n_out Sample sizes p_out r_exp Vector absolute correlations SNP-exposure r_out Vector absolute correlations SNP-outcome r_xxo Measurememt precision exposure r_yyo Measurement precision outcome ... arguments passed lattice::wireframe()","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR Steiger test of directionality — mr_steiger","text":"List following elements: r2_exp Estimated variance explained x r2_out Estimated variance explained y r2_exp_adj Predicted variance explained x accounting estimated measurement error r2_out_adj Predicted variance explained y accounting estimated measurement error correct_causal_direction TRUE/FALSE steiger_test p-value inference direction correct_causal_direction_adj TRUE/FALSE, direction causality given measurement error parameters steiger_test_adj p-value inference direction causality given measurement error parameters vz Total volume error parameter space vz0 Volume parameter space gives incorrect answer vz1 Volume paramtere space gives correct answer sensitivity_ratio Ratio vz1/vz0. Higher means inferred direction less susceptible measurement error sensitivity_plot Plot parameter space causal directions measurement error","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger2.html","id":null,"dir":"Reference","previous_headings":"","what":"MR Steiger test of directionality — mr_steiger2","title":"MR Steiger test of directionality — mr_steiger2","text":"statistical test whether assumption exposure causes outcome valid","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR Steiger test of directionality — mr_steiger2","text":"","code":"mr_steiger2(r_exp, r_out, n_exp, n_out, r_xxo = 1, r_yyo = 1, ...)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR Steiger test of directionality — mr_steiger2","text":"r_exp Vector correlations SNP-exposure r_out Vector correlations SNP-outcome n_exp Sample sizes p_exp n_out Sample sizes p_out r_xxo Measurememt precision exposure r_yyo Measurement precision outcome ... arguments passed lattice::wireframe()","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_steiger2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR Steiger test of directionality — mr_steiger2","text":"List following elements: r2_exp Estimated variance explained x r2_out Estimated variance explained y r2_exp_adj Predicted variance explained x accounting estimated measurement error r2_out_adj Predicted variance explained y accounting estimated measurement error correct_causal_direction TRUE/FALSE steiger_test p-value inference direction correct_causal_direction_adj TRUE/FALSE, direction causality given measurement error parameters steiger_test_adj p-value inference direction causality given measurement error parameters vz Total volume error parameter space vz0 Volume parameter space gives incorrect answer vz1 Volume paramtere space gives correct answer sensitivity_ratio Ratio vz1/vz0. Higher means inferred direction less susceptible measurement error sensitivity_plot Plot parameter space causal directions measurement error","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_two_sample_ml.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum likelihood MR method — mr_two_sample_ml","title":"Maximum likelihood MR method — mr_two_sample_ml","text":"Maximum likelihood MR method","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_two_sample_ml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum likelihood MR method — mr_two_sample_ml","text":"","code":"mr_two_sample_ml(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_two_sample_ml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum likelihood MR method — mr_two_sample_ml","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_two_sample_ml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum likelihood MR method — mr_two_sample_ml","text":"List following elements: b causal effect estimate se standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_uwr.html","id":null,"dir":"Reference","previous_headings":"","what":"Unweighted regression — mr_uwr","title":"Unweighted regression — mr_uwr","text":"default multiplicative random effects IVW estimate. standard error corrected dispersion Use mr_ivw_mre() function estimates correct dispersion.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_uwr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unweighted regression — mr_uwr","text":"","code":"mr_uwr(b_exp, b_out, se_exp, se_out, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_uwr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unweighted regression — mr_uwr","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters. default default_parameters().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_uwr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unweighted regression — mr_uwr","text":"List following elements: b MR estimate se Standard error pval p-value Q, Q_df, Q_pval Heterogeneity stats","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wald_ratio.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform 2 sample IV using Wald ratio. — mr_wald_ratio","title":"Perform 2 sample IV using Wald ratio. — mr_wald_ratio","text":"Perform 2 sample IV using Wald ratio.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wald_ratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform 2 sample IV using Wald ratio. — mr_wald_ratio","text":"","code":"mr_wald_ratio(b_exp, b_out, se_exp, se_out, parameters)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wald_ratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform 2 sample IV using Wald ratio. — mr_wald_ratio","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters List parameters.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wald_ratio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform 2 sample IV using Wald ratio. — mr_wald_ratio","text":"List following elements: b causal effect estimate se standard error pval p-value nsnp 1","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted median method — mr_weighted_median","title":"Weighted median method — mr_weighted_median","text":"Perform MR using summary statistics. Bootstraps used calculate standard error.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted median method — mr_weighted_median","text":"","code":"mr_weighted_median(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted median method — mr_weighted_median","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. parameters default default_parameters(). Specify number bootstrap replications calculate SE nboot. default list(nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted median method — mr_weighted_median","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode.html","id":null,"dir":"Reference","previous_headings":"","what":"MR weighted mode estimator — mr_weighted_mode","title":"MR weighted mode estimator — mr_weighted_mode","text":"MR weighted mode estimator","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR weighted mode estimator — mr_weighted_mode","text":"","code":"mr_weighted_mode(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR weighted mode estimator — mr_weighted_mode","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp Standard errors genetic effects exposure se_out Standard errors genetic effects outcome parameters List containing phi - Bandwidth parameter, nboot - number bootstraps calculate SE. default_parameters() sets list(phi=1, nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR weighted mode estimator — mr_weighted_mode","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode_nome.html","id":null,"dir":"Reference","previous_headings":"","what":"MR weighted mode estimator (NOME) — mr_weighted_mode_nome","title":"MR weighted mode estimator (NOME) — mr_weighted_mode_nome","text":"Weighted mode estimator","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode_nome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR weighted mode estimator (NOME) — mr_weighted_mode_nome","text":"","code":"mr_weighted_mode_nome(   b_exp,   b_out,   se_exp,   se_out,   parameters = default_parameters() )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode_nome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR weighted mode estimator (NOME) — mr_weighted_mode_nome","text":"b_exp Vector genetic effects exposure b_out Vector genetic effects outcome se_exp Standard errors genetic effects exposure se_out Standard errors genetic effects outcome parameters List containing phi - Bandwidth parameter, nboot - number bootstraps calculate SE. default_parameters() sets list(phi=1, nboot=1000).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_weighted_mode_nome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR weighted mode estimator (NOME) — mr_weighted_mode_nome","text":"List following elements: b MR estimate se Standard error pval p-value","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform full set of MR analyses — mr_wrapper","title":"Perform full set of MR analyses — mr_wrapper","text":"Perform full set MR analyses","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform full set of MR analyses — mr_wrapper","text":"","code":"mr_wrapper(dat, parameters = default_parameters())"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform full set of MR analyses — mr_wrapper","text":"dat Output harmonise_data(). parameters Parameters pass MR functions. Output default_parameters() used default.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mr_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform full set of MR analyses — mr_wrapper","text":"list","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_basic.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform basic multivariable MR — mv_basic","title":"Perform basic multivariable MR — mv_basic","text":"Performs initial multivariable MR analysis Burgess et al 2015. exposure outcome residualised exposures, unweighted regression applied.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_basic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform basic multivariable MR — mv_basic","text":"","code":"mv_basic(mvdat, pval_threshold = 5e-08)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_basic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform basic multivariable MR — mv_basic","text":"mvdat Output mv_harmonise_data(). pval_threshold P-value threshold include instruments. default 5e-8.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_basic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform basic multivariable MR — mv_basic","text":"List results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract exposure variables for multivariable MR — mv_extract_exposures","title":"Extract exposure variables for multivariable MR — mv_extract_exposures","text":"Requires list IDs available_outcomes. ID, extracts instruments. , gets full list instruments extracts SNPs every exposure. Finally, keeps SNPs ) independent b) present exposures, harmonises strand.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract exposure variables for multivariable MR — mv_extract_exposures","text":"","code":"mv_extract_exposures(   id_exposure,   clump_r2 = 0.001,   clump_kb = 10000,   harmonise_strictness = 2,   opengwas_jwt = ieugwasr::get_opengwas_jwt(),   find_proxies = TRUE,   force_server = FALSE,   pval_threshold = 5e-08,   pop = \"EUR\",   plink_bin = NULL,   bfile = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract exposure variables for multivariable MR — mv_extract_exposures","text":"id_exposure Array IDs (e.g. c(299, 300, 302) HDL, LDL, trigs) clump_r2 default 0.01. clump_kb default 10000. harmonise_strictness See action option harmonise_data(). default 2. opengwas_jwt Used authenticate protected endpoints. Login https://api.opengwas.io obtain jwt. Provide jwt string , store .Renviron keyname OPENGWAS_JWT. find_proxies Look proxies? slows everything accurate. default TRUE. force_server Whether search pre-clumped dataset re-extract clump directly server. default FALSE. pval_threshold Instrument detection p-value threshold. Default = 5e-8 pop 1000 genomes super population use clumping using server plink_bin NULL bfile NULL detect packaged plink binary specific OS. Otherwise specify path plink binary. Default = NULL bfile provided use API. Default = NULL","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract exposure variables for multivariable MR — mv_extract_exposures","text":"data frame exposure_dat format","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures_local.html","id":null,"dir":"Reference","previous_headings":"","what":"Attempt to perform MVMR using local data — mv_extract_exposures_local","title":"Attempt to perform MVMR using local data — mv_extract_exposures_local","text":"Allows read summary data text files format multivariable exposure dataset.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attempt to perform MVMR using local data — mv_extract_exposures_local","text":"","code":"mv_extract_exposures_local(   filenames_exposure,   sep = \" \",   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   units_col = \"units\",   ncase_col = \"ncase\",   ncontrol_col = \"ncontrol\",   samplesize_col = \"samplesize\",   gene_col = \"gene\",   id_col = \"id\",   min_pval = 1e-200,   log_pval = FALSE,   pval_threshold = 5e-08,   plink_bin = NULL,   bfile = NULL,   clump_r2 = 0.001,   clump_kb = 10000,   pop = \"EUR\",   harmonise_strictness = 2 )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attempt to perform MVMR using local data — mv_extract_exposures_local","text":"filenames_exposure Filenames exposure dataset. Must header least SNP column present. Following arguments used determining read filename clumping etc. sep Specify delimeter file. default space, .e. sep=\" \". length 1 use sep value exposure dataset. can provide vector values, one exposure dataset, values different across datasets. applies dataset-formatting options listed . phenotype_col Optional column name column phenotype name corresponding SNP. present created value \"Outcome\". Default \"Phenotype\". snp_col Required name column SNP rs IDs. default \"SNP\". beta_col Required MR. Name column effect sizes. default \"beta\". se_col Required MR. Name column standard errors. default \"se\". eaf_col Required MR. Name column effect allele frequency. default \"eaf\". effect_allele_col Required MR. Name column effect allele. Must \"\", \"C\", \"T\" \"G\". default \"effect_allele\". other_allele_col Required MR. Name column non effect allele. Must \"\", \"C\", \"T\" \"G\". default \"other_allele\". pval_col Required enrichment tests. Name column p-value. default \"pval\". units_col Optional column name units. default \"units\". ncase_col Optional column name number cases. default \"ncase\". ncontrol_col Optional column name number controls. default \"ncontrol\". samplesize_col Optional column name sample size. default \"samplesize\". gene_col Optional column name gene name. default \"gene\". id_col Optional column name give dataset ID. generated automatically provided every trait / unit combination. default \"id\". min_pval Minimum allowed p-value. default 1e-200. log_pval pval -log10(P). default FALSE. pval_threshold Default=5e-8 clumping plink_bin NULL bfile NULL detect packaged plink binary specific OS. Otherwise specify path plink binary. Default = NULL bfile provided use API. Default = NULL clump_r2 Default=0.001 clumping clump_kb Default=10000 clumping pop 1000 genomes super population use clumping using server harmonise_strictness See action argument harmonise_data(). Default=2","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures_local.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attempt to perform MVMR using local data — mv_extract_exposures_local","text":"List","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_extract_exposures_local.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attempt to perform MVMR using local data — mv_extract_exposures_local","text":"Note can provide array column names column, length filenames_exposure","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_harmonise_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmonise exposure and outcome for multivariable MR — mv_harmonise_data","title":"Harmonise exposure and outcome for multivariable MR — mv_harmonise_data","text":"Harmonise exposure outcome multivariable MR","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_harmonise_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmonise exposure and outcome for multivariable MR — mv_harmonise_data","text":"","code":"mv_harmonise_data(exposure_dat, outcome_dat, harmonise_strictness = 2)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_harmonise_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmonise exposure and outcome for multivariable MR — mv_harmonise_data","text":"exposure_dat Output mv_extract_exposures(). outcome_dat Output extract_outcome_data(exposure_dat$SNP, id_output). harmonise_strictness See action option harmonise_data(). default 2.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_harmonise_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Harmonise exposure and outcome for multivariable MR — mv_harmonise_data","text":"List vectors matrices required mv analysis. exposure_beta matrix beta coefficients, rows correspond SNPs columns correspond exposures. exposure_se exposure_beta, standard errors. exposure_pval exposure_beta, p-values. expname data frame two variables, id.exposure exposure character strings. outcome_beta array effects outcome, corresponding SNPs exposure_beta. outcome_se array standard errors outcome. outcome_pval array p-values outcome. outname data frame two variables, id.outcome outcome character strings.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_ivw.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform IVW multivariable MR — mv_ivw","title":"Perform IVW multivariable MR — mv_ivw","text":"Performs modified multivariable MR analysis. exposure instruments selected exposures SNPs regressed outcome together, weighting inverse variance outcome.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_ivw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform IVW multivariable MR — mv_ivw","text":"","code":"mv_ivw(mvdat, pval_threshold = 5e-08)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_ivw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform IVW multivariable MR — mv_ivw","text":"mvdat Output mv_harmonise_data(). pval_threshold P-value threshold include instruments. default 5e-8.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_ivw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform IVW multivariable MR — mv_ivw","text":"List results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_lasso_feature_selection.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply LASSO feature selection to mvdat object — mv_lasso_feature_selection","title":"Apply LASSO feature selection to mvdat object — mv_lasso_feature_selection","text":"Apply LASSO feature selection mvdat object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_lasso_feature_selection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply LASSO feature selection to mvdat object — mv_lasso_feature_selection","text":"","code":"mv_lasso_feature_selection(mvdat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_lasso_feature_selection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply LASSO feature selection to mvdat object — mv_lasso_feature_selection","text":"mvdat Output mv_harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_lasso_feature_selection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply LASSO feature selection to mvdat object — mv_lasso_feature_selection","text":"data frame retained features","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_multiple.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform IVW multivariable MR — mv_multiple","title":"Perform IVW multivariable MR — mv_multiple","text":"Performs modified multivariable MR analysis. exposure instruments selected exposures SNPs regressed outcome together, weighting inverse variance outcome.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_multiple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform IVW multivariable MR — mv_multiple","text":"","code":"mv_multiple(   mvdat,   intercept = FALSE,   instrument_specific = FALSE,   pval_threshold = 5e-08,   plots = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_multiple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform IVW multivariable MR — mv_multiple","text":"mvdat Output mv_harmonise_data(). intercept intercept estimated (TRUE) force line origin (FALSE, default). instrument_specific estimate exposure obtained using instruments exposures (FALSE, default) using instruments specific exposure (TRUE). pval_threshold P-value threshold include instruments. default 5e-8. plots Create plots? default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_multiple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform IVW multivariable MR — mv_multiple","text":"List results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_residual.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform basic multivariable MR — mv_residual","title":"Perform basic multivariable MR — mv_residual","text":"Performs initial multivariable MR analysis Burgess et al 2015. exposure outcome residualised exposures, unweighted regression applied.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_residual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform basic multivariable MR — mv_residual","text":"","code":"mv_residual(   mvdat,   intercept = FALSE,   instrument_specific = FALSE,   pval_threshold = 5e-08,   plots = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_residual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform basic multivariable MR — mv_residual","text":"mvdat Output mv_harmonise_data(). intercept intercept estimated (TRUE) force line origin (FALSE, default). instrument_specific estimate exposure obtained using instruments exposures (FALSE, default) using instruments specific exposure (TRUE). pval_threshold P-value threshold include instruments. default 5e-8. plots Create plots? default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_residual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform basic multivariable MR — mv_residual","text":"List results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_subset.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform multivariable MR on subset of features — mv_subset","title":"Perform multivariable MR on subset of features — mv_subset","text":"function proceeds follows: Select features (default done using LASSO feature selection). Subset mvdat retain relevant features instruments. Perform MVMR remaining data.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_subset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform multivariable MR on subset of features — mv_subset","text":"","code":"mv_subset(   mvdat,   features = mv_lasso_feature_selection(mvdat),   intercept = FALSE,   instrument_specific = FALSE,   pval_threshold = 5e-08,   plots = FALSE )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_subset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform multivariable MR on subset of features — mv_subset","text":"mvdat Output mv_harmonise_data(). features Dataframe features retain, must column name 'exposure' list exposures retain mvdat. default mvdat_lasso_feature_selection(mvdat). intercept intercept estimated (TRUE) force line origin (FALSE, default). instrument_specific estimate exposure obtained using instruments exposures (FALSE, default) using instruments specific exposure (TRUE). pval_threshold P-value threshold include instruments. default 5e-8. plots Create plots? default FALSE.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/mv_subset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform multivariable MR on subset of features — mv_subset","text":"List results","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/power_prune.html","id":null,"dir":"Reference","previous_headings":"","what":"Power prune — power_prune","title":"Power prune — power_prune","text":"duplicate summary sets particular exposure-outcome combination, function keeps exposure-outcome summary set highest expected statistical power. can done dropping duplicate summary sets smaller sample sizes. Alternatively, pruning procedure can take account instrument strength outcome sample size. latter useful, example, considerable variation SNP coverage duplicate summary sets (e.g. studies used targeted fine mapping arrays). large number SNPs available instrument exposure, outcome GWAS better SNP coverage may provide better power outcome GWAS larger sample size.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/power_prune.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Power prune — power_prune","text":"","code":"power_prune(dat, method = 1, dist.outcome = \"binary\")"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/power_prune.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Power prune — power_prune","text":"dat Results harmonise_data(). method duplicate summary sets pruned basis sample size alone (method = 1) combination instrument strength sample size (method = 2)? Default set 1. set 1, duplicate summary sets first dropped basis outcome sample size (smaller duplicates dropped). duplicates still present, remaining duplicates dropped basis exposure sample size (smaller duplicates dropped). method set 2, duplicates dropped basis instrument strength (amount variation explained exposure instrumental SNPs) sample size, assumes SNP-exposure effects correspond continuous trait normal distribution (.e. exposure binary). SNP-outcome effects can correspond either binary continuous trait. exposure binary method=1 used. dist.outcome distribution outcome. Can either \"binary\" \"continuous\". Default set \"binary\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/power_prune.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Power prune — power_prune","text":"data.frame duplicate summary sets removed","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_exposure_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Read exposure data — read_exposure_data","title":"Read exposure data — read_exposure_data","text":"Reads exposure data. Checks organises columns use MR enrichment tests. Infers p-values possible beta se.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_exposure_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read exposure data — read_exposure_data","text":"","code":"read_exposure_data(   filename,   clump = FALSE,   sep = \" \",   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   units_col = \"units\",   ncase_col = \"ncase\",   ncontrol_col = \"ncontrol\",   samplesize_col = \"samplesize\",   gene_col = \"gene\",   id_col = \"id\",   min_pval = 1e-200,   log_pval = FALSE,   chr_col = \"chr\",   pos_col = \"pos\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_exposure_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read exposure data — read_exposure_data","text":"filename Filename. Must header least SNP column present. clump Whether perform LD clumping clump_data() exposure data. default FALSE. sep Specify delimeter file. default space, .e. \" \". phenotype_col Optional column name column phenotype name corresponding SNP. present created value \"Outcome\". default \"Phenotype\". snp_col Required name column SNP rs IDs. default \"SNP\". beta_col Required MR. Name column effect sizes. default \"beta\". se_col Required MR. Name column standard errors. default \"se\". eaf_col Required MR. Name column effect allele frequency. default \"eaf\". effect_allele_col Required MR. Name column effect allele. Must \"\", \"C\", \"T\" \"G\". default \"effect_allele\". other_allele_col Required MR. Name column non effect allele. Must \"\", \"C\", \"T\" \"G\". default \"other_allele\". pval_col Required enrichment tests. Name column p-value. default \"pval\". units_col Optional column name units. default \"units\". ncase_col Optional column name number cases. default \"ncase\". ncontrol_col Optional column name number controls. default \"ncontrol\". samplesize_col Optional column name sample size. default \"samplesize\". gene_col Optional column name gene name. default \"gene\". id_col Optional column name give dataset ID. generated automatically provided every trait / unit combination. default \"id\". min_pval Minimum allowed p-value. default 1e-200. log_pval p-value -log10(P). default FALSE. chr_col Optional column name chromosome. Default \"chr\". pos_col Optional column name genetic position Default \"pos\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_exposure_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read exposure data — read_exposure_data","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_outcome_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Read outcome data — read_outcome_data","title":"Read outcome data — read_outcome_data","text":"Reads outcome data. Checks organises columns use MR enrichment tests. Infers p-values possible beta se.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_outcome_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read outcome data — read_outcome_data","text":"","code":"read_outcome_data(   filename,   snps = NULL,   sep = \" \",   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   units_col = \"units\",   ncase_col = \"ncase\",   ncontrol_col = \"ncontrol\",   samplesize_col = \"samplesize\",   gene_col = \"gene\",   id_col = \"id\",   min_pval = 1e-200,   log_pval = FALSE,   chr_col = \"chr\",   pos_col = \"pos\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_outcome_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read outcome data — read_outcome_data","text":"filename Filename. Must header least SNP column present. snps SNPs extract. NULL, default, extract keeps . sep Specify delimeter file. default space, .e. sep=\" \". phenotype_col Optional column name column phenotype name corresponding SNP. present created value \"Outcome\". Default \"Phenotype\". snp_col Required name column SNP rs IDs. default \"SNP\". beta_col Required MR. Name column effect sizes. default \"beta\". se_col Required MR. Name column standard errors. default \"se\". eaf_col Required MR. Name column effect allele frequency. default \"eaf\". effect_allele_col Required MR. Name column effect allele. Must \"\", \"C\", \"T\" \"G\". default \"effect_allele\". other_allele_col Required MR. Name column non effect allele. Must \"\", \"C\", \"T\" \"G\". default \"other_allele\". pval_col Required enrichment tests. Name column p-value. default \"pval\". units_col Optional column name units. default \"units\". ncase_col Optional column name number cases. default \"ncase\". ncontrol_col Optional column name number controls. default \"ncontrol\". samplesize_col Optional column name sample size. default \"samplesize\". gene_col Optional column name gene name. default \"gene\". id_col Optional column name give dataset ID. generated automatically provided every trait / unit combination. default \"id\". min_pval Minimum allowed p-value. default 1e-200. log_pval pval -log10(P). default FALSE. chr_col Optional column name chromosome. Default \"chr\". pos_col Optional column name genetic position Default \"pos\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/read_outcome_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read outcome data — read_outcome_data","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mr_presso.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for MR-PRESSO — run_mr_presso","title":"Wrapper for MR-PRESSO — run_mr_presso","text":"See https://github.com/rondolab/MR-PRESSO details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mr_presso.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for MR-PRESSO — run_mr_presso","text":"","code":"run_mr_presso(dat, NbDistribution = 1000, SignifThreshold = 0.05)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mr_presso.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for MR-PRESSO — run_mr_presso","text":"dat Output harmonise_data(). NbDistribution Number bootstrap replications. default 1000. SignifThreshold Outlier significance threshold. default 0.05.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mr_presso.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for MR-PRESSO — run_mr_presso","text":"List results every exposure/outcome combination","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mrmix.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform MRMix analysis on harmonised dat object — run_mrmix","title":"Perform MRMix analysis on harmonised dat object — run_mrmix","text":"See https://github.com/gqi/MRMix details.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mrmix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform MRMix analysis on harmonised dat object — run_mrmix","text":"","code":"run_mrmix(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mrmix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform MRMix analysis on harmonised dat object — run_mrmix","text":"dat Output harmonise_data(). Ensures eaf.exposure values missing.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/run_mrmix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform MRMix analysis on harmonised dat object — run_mrmix","text":"List results, one list item every exposure/outcome pair dat object","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/simple_cap.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple attempt at correcting string case — simple_cap","title":"Simple attempt at correcting string case — simple_cap","text":"Simple attempt correcting string case","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/simple_cap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple attempt at correcting string case — simple_cap","text":"","code":"simple_cap(x)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/simple_cap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple attempt at correcting string case — simple_cap","text":"x Character array character","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/simple_cap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple attempt at correcting string case — simple_cap","text":"Character array character","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/size.prune.html","id":null,"dir":"Reference","previous_headings":"","what":"Size prune — size.prune","title":"Size prune — size.prune","text":"Whens duplicate summary sets particular exposure-outcome combination, function drops duplicates smaller total sample size (binary outcomes, number cases used instead total sample size).","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/size.prune.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Size prune — size.prune","text":"","code":"size.prune(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/size.prune.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Size prune — size.prune","text":"dat Results harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/size.prune.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Size prune — size.prune","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/sort_1_to_many.html","id":null,"dir":"Reference","previous_headings":"","what":"Sort results for 1-to-many forest plot — sort_1_to_many","title":"Sort results for 1-to-many forest plot — sort_1_to_many","text":"function sorts user-supplied results forest_plot_1_to_many() function. user supplies results form data frame.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/sort_1_to_many.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sort results for 1-to-many forest plot — sort_1_to_many","text":"","code":"sort_1_to_many(   mr_res,   b = \"b\",   trait_m = \"outcome\",   sort_action = 4,   group = NULL,   priority = NULL )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/sort_1_to_many.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sort results for 1-to-many forest plot — sort_1_to_many","text":"mr_res Data frame results supplied user. b Name column specifying effect exposure outcome. default \"b\". trait_m column specifying names traits. Corresponds 'many' 1--many forest plot. default \"outcome\". sort_action Choose sort results. sort_action = 1: sort results effect size within groups. Use group order supplied user. sort_action = 2: sort results effect size group. Overides group ordering supplied user. sort_action = 3: group results trait together (e.g. multiple results trait different MR methods). sort_action = 4: sort decreasing effect size (largest effect size top smallest bottom). sort_action = 5: sort increasing effect size (smallest effect size top largest bottom). group Name grouping variable mr_res. priority sort_action = 3, choose value trait_m variable given priority go trait_m values. trait largest effect size prioritised group go top plot.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/sort_1_to_many.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sort results for 1-to-many forest plot — sort_1_to_many","text":"data frame.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_exposure.html","id":null,"dir":"Reference","previous_headings":"","what":"Split exposure column — split_exposure","title":"Split exposure column — split_exposure","text":"function takes exposure column results generated mr() splits separate columns 'exposure name' 'id'.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_exposure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split exposure column — split_exposure","text":"","code":"split_exposure(mr_res)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_exposure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split exposure column — split_exposure","text":"mr_res Results mr().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_exposure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split exposure column — split_exposure","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_outcome.html","id":null,"dir":"Reference","previous_headings":"","what":"Split outcome column — split_outcome","title":"Split outcome column — split_outcome","text":"function takes outcome column results generated mr() splits separate columns 'outcome name' 'id'.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_outcome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split outcome column — split_outcome","text":"","code":"split_outcome(mr_res)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_outcome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split outcome column — split_outcome","text":"mr_res Results mr().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/split_outcome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split outcome column — split_outcome","text":"data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/standardise_units.html","id":null,"dir":"Reference","previous_headings":"","what":"Try to standardise continuous traits to be in standard deviation units — standardise_units","title":"Try to standardise continuous traits to be in standard deviation units — standardise_units","text":"Uses estimate_trait_sd().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/standardise_units.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Try to standardise continuous traits to be in standard deviation units — standardise_units","text":"","code":"standardise_units(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/standardise_units.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Try to standardise continuous traits to be in standard deviation units — standardise_units","text":"dat Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/standardise_units.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Try to standardise continuous traits to be in standard deviation units — standardise_units","text":"Data frame","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_filtering.html","id":null,"dir":"Reference","previous_headings":"","what":"Steiger filtering function — steiger_filtering","title":"Steiger filtering function — steiger_filtering","text":"function takes object harmonise_data() following: rsq.exposure rsq.outcome column try estimate . done differently traits \"log odds\" units. estimate rsq quantitative traits must either p-values sample sizes SNP, effect sizes standard errors units SD units (column must contain \"SD\"). estimate rsq binary traits units must called \"log odds\" must beta.exposure, eaf.exposure, ncase.exposure, ncontrol.exposure, prevalence.exposure. principles apply calculating rsq outcome trait, except column names beta.outcome etc. prevalence supplied uses 0.1 default.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_filtering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Steiger filtering function — steiger_filtering","text":"","code":"steiger_filtering(dat)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_filtering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Steiger filtering function — steiger_filtering","text":"dat Output harmonise_data().","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_filtering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Steiger filtering function — steiger_filtering","text":"harmonise_data() style data frame additional columns rsq.exposure, rsq.outcome, steiger_dir (TRUE rsq.exposure larger rsq.outcome) steiger_pval test see rsq.exposure significantly larger rsq.outcome.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_filtering.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Steiger filtering function — steiger_filtering","text":"rsq calculated exposure outcome, perform Steiger test SNP see rsq exposure larger rsq outcome. Note Steiger filtering, useful, pitfalls. Try use replication effect estimates exposure (biased winner's curse), note strong antagonistic confounding differential measurement error exposure outcome causal directions inferred incorrectly.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_sensitivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate the Steiger test's sensitivity to measurement error — steiger_sensitivity","title":"Evaluate the Steiger test's sensitivity to measurement error — steiger_sensitivity","text":"Evaluate Steiger test's sensitivity measurement error","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_sensitivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate the Steiger test's sensitivity to measurement error — steiger_sensitivity","text":"","code":"steiger_sensitivity(rgx_o, rgy_o, ...)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_sensitivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate the Steiger test's sensitivity to measurement error — steiger_sensitivity","text":"rgx_o Observed variance exposure explained SNPs rgy_o Observed variance outcome explained SNPs ... arguments passed lattice::wireframe()","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/steiger_sensitivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate the Steiger test's sensitivity to measurement error — steiger_sensitivity","text":"List following elements: vz Total volume error parameter space vz0 Volume parameter space gives incorrect answer vz1 Volume paramtere space gives correct answer sensitivity_ratio Ratio vz1/vz0. Higher means inferred direction less susceptible measurement error pl plot parameter space","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/subset_on_method.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset MR-results on method — subset_on_method","title":"Subset MR-results on method — subset_on_method","text":"function takes MR results mr() restricts single method per exposure x disease combination.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/subset_on_method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset MR-results on method — subset_on_method","text":"","code":"subset_on_method(   mr_res,   single_snp_method = \"Wald ratio\",   multi_snp_method = \"Inverse variance weighted\" )"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/subset_on_method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset MR-results on method — subset_on_method","text":"mr_res Results mr(). single_snp_method single SNP methods use 1 SNP used estimate causal effect? default \"Wald ratio\". multi_snp_method multi-SNP methods use 1 SNPs used estimate causal effect? default \"Inverse variance weighted\".","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/subset_on_method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset MR-results on method — subset_on_method","text":"data frame.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/trim.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim function to remove leading and trailing blank spaces — trim","title":"Trim function to remove leading and trailing blank spaces — trim","text":"Trim function remove leading trailing blank spaces","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/trim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim function to remove leading and trailing blank spaces — trim","text":"","code":"trim(x)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/trim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim function to remove leading and trailing blank spaces — trim","text":"x Character array character","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/trim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim function to remove leading and trailing blank spaces — trim","text":"Character array character","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted median method — weighted_median","title":"Weighted median method — weighted_median","text":"New method Jack","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted median method — weighted_median","text":"","code":"weighted_median(b_iv, weights)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted median method — weighted_median","text":"b_iv Wald ratios weights Weights SNP","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted median method — weighted_median","text":"MR estimate","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate standard errors for weighted median method using bootstrap — weighted_median_bootstrap","title":"Calculate standard errors for weighted median method using bootstrap — weighted_median_bootstrap","text":"Based new script weighted median confidence interval, update 31 July 2015.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate standard errors for weighted median method using bootstrap — weighted_median_bootstrap","text":"","code":"weighted_median_bootstrap(b_exp, b_out, se_exp, se_out, weights, nboot)"},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate standard errors for weighted median method using bootstrap — weighted_median_bootstrap","text":"b_exp Vector genetic effects exposure. b_out Vector genetic effects outcome. se_exp Standard errors genetic effects exposure. se_out Standard errors genetic effects outcome. weights Weights apply SNP. nboot Number bootstrap replications. default 1000.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/reference/weighted_median_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate standard errors for weighted median method using bootstrap — weighted_median_bootstrap","text":"Empirical standard error","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v069","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.9","title":"TwoSampleMR v0.6.9","text":"(Release date 2025-02-05) Fixed bug format_data() log_pval argument set TRUE. specified p-value column now used (thanks @luddeluddis) Amend references MR-Base OpenGWAS","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v068","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.8","title":"TwoSampleMR v0.6.8","text":"(Release date 2024-09-06) Replaced unique() calls power_prune() mean() ensure scalar iv.se values (thanks @phageghost) Slightly improved formatting code base","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v067","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.7","title":"TwoSampleMR v0.6.7","text":"(Release date 2024-08-21) Update OpenGWAS API URLs Minor tweak R CMD check GitHub Actions due rjson hard dependency MendelianRandomization package now requiring R >= 4.4.0 Add dark mode pkgdown site","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v066","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.6","title":"TwoSampleMR v0.6.6","text":"(Release date 2024-07-06) Improve test Improve permissions GitHub Actions workflows Bump minimum required version ieugwasr 1.0.1 Made amends code bring line lintr recommendations Added omitted tidyr soft dependency","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v065","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.5","title":"TwoSampleMR v0.6.5","text":"(Release date: 2024-06-30) Bumped version roxygen2 creating package documentation Update earliest version R R CMD check GitHub Actions workflow 4.3.2. meta dependency depends lme4, recent 1.1-35.4 release lme4 requires Matrix 1.6-2 released days R 4.3.2. Made package tests robust non-response OpenGWAS API","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v064","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.4","title":"TwoSampleMR v0.6.4","text":"(Release date: 2024-06-05) Update installation instructions README.md Fixed bug wrong indels recoding function called (thanks @ruochiz)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v063","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.3","title":"TwoSampleMR v0.6.3","text":"(Release date: 2024-05-23) Update package startup message","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v062","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.2","title":"TwoSampleMR v0.6.2","text":"(Release date: 2024-05-09) format_data() now errors detects dat object class 'data.table' issues message informing user make dat object simply 'data.frame' (thanks Si Fang @sifang1678)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v061","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.1","title":"TwoSampleMR v0.6.1","text":"(Release date: 2024-04-30) MendelianRandomization package moved hard dependency soft dependency. dependency package Matrix now requires R >= 4.4.0. Making MendelianRandomization soft dependency means don’t need make TwoSampleMR requirement.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v060","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.6.0","title":"TwoSampleMR v0.6.0","text":"(Release date: 2024-04-22) TwoSampleMR now uses CRAN version ieugwasr package. Importantly includes new authentication system OpenGWAS API. Please see https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication information set .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0511","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.11","title":"TwoSampleMR v0.5.11","text":"(Release date: 2024-03-21) mr_leaveoneout_plot() mr_forest_plot() amended size argument linewidth per ggplot2 version 3.4.0. Add datasets tests, continuous integration services, creation vignettes don’t rely availability OpenGWAS server. Various improvements helpfiles.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0510","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.10","title":"TwoSampleMR v0.5.10","text":"(Release date: 2024-02-20) Added bfile plink_bin arguments clump_data() Improvements file reading dataset formatting capabilities mv_extract_exposures_local() create multiple exposure dataset","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v059","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.9","title":"TwoSampleMR v0.5.9","text":"(Release date: 2024-02-01) Fixed minor issue dat_to_RadialMR() Minor improvements make_dat() default arguments helpfile Minor improvements package tests Amendments GitHub Actions workflows Updated several URLs changed","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v058","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.8","title":"TwoSampleMR v0.5.8","text":"(Release date: 2023-11-16) Improved speed harmonisation using data.table functions (thanks @nicksunderland) Updated URL R-CMD-check README badge Updates GitHub Actions workflows","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v057","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.7","title":"TwoSampleMR v0.5.7","text":"(Release date: 2023-05-29) Move car package Suggests allow TwoSampleMR install R versions 4.0.0 4.1.0 DESCRIPTION use pkgdepends syntax MRPRESSO package due repository name different package name installing TwoSampleMR pak continues work Various minor code tweaks fix 2 R CMD check notes Add Cairo package Suggests list (thanks @hdraisma) Fix error outcome data vignette (thanks @hdraisma) p-values ~0 stored 1 elasticsearch database. now fixed datasets clumped re-define tophits. full list affected GWAS available : https://github.com/MRCIEU/opengwas-infpval-fix Updated steiger filtering use effective sample size case control studies (thanks @niekverw) Fixed issue tri-allelic SNPs harmonisation. Credit Clare Horscroft (@chorscroft) spotting error fixing Fixed issue experimental version local multivariable MR method. Credit Mischa Lundberg (@MischaLundberg). Catching edge cases retrieving sample size meta data Updating default rsq estimation function use beta standard error instead p-value, improve numerical stability Allow chr pos read local summary data files reading local data without p-values, editing inferred p-value method two-sided images vignettes (hence also rendered pkgdown website) now accompanying alt text descriptions accompanying website package now uses Bootstrap 5, means search facility enabled NAMESPACE simplified, hence package load time slightly improved","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v056","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.6","title":"TwoSampleMR v0.5.6","text":"(Release date: 2021-03-25) Fix scatter plot (thanks Yossi Farjoun @yfarjoun) Update mr.raps parameters (thanks Qingyuan Zhao @qingyuanzhao) Bug fix MVMR (thanks Conor Judge @conorjudge) Fix harmonise_data (thanks Leland Taylor @letaylor) Documentation (thanks @jinghuazhao)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v055","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.5","title":"TwoSampleMR v0.5.5","text":"(Release date: 2020-08-09) Updating clump_data function operate outcome datasets way operates exposure datasets. Credit goes Marina Vabistsevits spotting suggesting solution. Removing ios function, now moved mr.ios package : https://github.com/universe77/mr.ios ieu--756 ieu--757 ieu--758 ieu--759 ieu--760 ieu--761 ieu--762 ieu--763 ieu--764 ieu--765 ieu--766 ieu--767 ieu--768 ieu--769 ieu--770 ieu--771 ieu--772 ieu--773 ieu--774 ieu--775 ieu--776 ieu--777 ieu--778 ieu--779 bbj--64 bbj--65 bbj--66 bbj--67 bbj--68 bbj--69 ebi--GCST004364 ebi--GCST005215 ebi--GCST005216 ebi--GCST005221 ebi--GCST005222 ieu--1086 ieu--761 ieu--762 ieu--763 ieu--767 ieu--777 ieu--779","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v054","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.4","title":"TwoSampleMR v0.5.4","text":"(Release date: 2020-05-10) datasets now re-instated Added options different populations LD operations converting MRInput format supplying LD matrix, possible multi-allelic variants represented differently GWAS LD reference panel. Ambiguous alignments removed, now fixed. Credit goes Mona Almramhi spotting fixing issue.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v053","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.3","title":"TwoSampleMR v0.5.3","text":"(Release date: 2020-04-02) converting MRInput format supplying LD matrix, LD matrix SNP order matching summary data order. Credit goes Mona Almramhi spotting fixing issue. Reinstating datasets previously disabled (ukb-, ukb-d, ubm-) Fixed bug mr_wrapper. Thanks Gunn-Helen Moen .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v052","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.2","title":"TwoSampleMR v0.5.2","text":"(Release date: 2020-03-11) longer marking LD functions deprecated now. Thanks Jonas Bovijn discussions . Various fixes R CMD check warnings notes.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v051","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.1","title":"TwoSampleMR v0.5.1","text":"(Release date: 2020-02-14) number datasets found issues since 0.5.0. include: minority non-effect alleles incorrect ieu-batch. consequence harmonisation may thrown SNPs due harmonisation mismatches. Error arose 0.5.0 now fixed p-value issues ubm-batch. led fewer top-hits identified . Error arose 0.5.0 currently disabled Effect allele frequency issues ukb-batch, potentially due misreported effect alleles. Error arose 0.5.0 currently disabled","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v050","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.5.0","title":"TwoSampleMR v0.5.0","text":"(Release date: 2020-01-01) Major update, details : https://mrcieu.github.io/TwoSampleMR/articles/gwas2020.html","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0426","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.26","title":"TwoSampleMR v0.4.26","text":"(Release date: 2019-12-01) Improved precision low p-values steiger tests. Thanks Hannah V Meyer Tom Palmer . Improved instrument extraction new datasets","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0425","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.25","title":"TwoSampleMR v0.4.25","text":"(Release date: 2019-09-12) Changes googleAuthR package break authentication. Added interception install older version fixed. Please use devtools::install_github(\"MarkEdmondson1234/googleAuthR@v0.8.1\")","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0424","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.24","title":"TwoSampleMR v0.4.24","text":"(Release date: 2019-09-10) Bug found extract_instruments requesting non-default parameters. Thanks Shantanu Bafna pointing .","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0423","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.23","title":"TwoSampleMR v0.4.23","text":"(Release date: 2019-08-12) Forcing server extract_instruments pre-computed outcomes present default. old behaviour still possible setting extract_instruments(force_server_if_empty=FALSE)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0422","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.22","title":"TwoSampleMR v0.4.22","text":"(Release date: 2019-02-22) Changing default API address preparation moving version 0.5.0 use new API","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0421","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.21","title":"TwoSampleMR v0.4.21","text":"(Release date: 2019-02-19) Updated mixture experts","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0420","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.20","title":"TwoSampleMR v0.4.20","text":"(Release date: 2019-01-31) harmonise function now returns summary harmonisation procedure e.g. number SNPs removed etc. Access via attr(obj, “log”) Note tested shown give results previously chance might lead slightly different behaviour. Please install previous version prefer avoid possibilities changed behaviour - devtools::install_github(“MRCIEU/TwoSampleMR@0.4.18”)","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0419","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.19","title":"TwoSampleMR v0.4.19","text":"(Release date: 2019-01-31) Fixed bug mr_heterogeneity impacted minority cases. method list specified order results didn’t always match method (MR Egger IVW mixed ). affect default usage. Thanks Anna Guyatt pointing . Added index suspicion functionality, penalised mode estimator Added transformation function scale effect estimate units SD scale Starting write change log !","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0418","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.18","title":"TwoSampleMR v0.4.18","text":"(Release date: 2018-12-03) Improved performance harmonisation","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v0417","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.4.17","title":"TwoSampleMR v0.4.17","text":"(Release date: 2018-12-03) Added facility harmonise indels Documentation options added multivariable MR","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v034","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.3.4","title":"TwoSampleMR v0.3.4","text":"(Release date: 2017-11-30) Moving elastic search database request batching changing 50 SNPs per chunk 10000. can modified extract_outcome_data(splitsize=50) Changing harmonise_data behaviour - now discard bad SNPs retains mr_keep column indicating whether used mr analysis functions Fixed issue oauth token Updated scatter plot register mr_keep column.","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v033","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.3.3","title":"TwoSampleMR v0.3.3","text":"(Release date: 2017-11-23) Fixed bug singlesnp leaveoneout analyses","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v032","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.3.2","title":"TwoSampleMR v0.3.2","text":"(Release date: 2017-11-22) Added function check latest version package load","code":""},{"path":"https://mrcieu.github.io/TwoSampleMR/news/index.html","id":"twosamplemr-v031","dir":"Changelog","previous_headings":"","what":"TwoSampleMR v0.3.1","title":"TwoSampleMR v0.3.1","text":"(Release date: 2017-11-22) One external packages TwoSampleMR depends upon changed, making authorisation behaviour change. authorisation timing hour refreshing timeout. now fixed - authorisation token refresh hour. authorisation token used stored hidden file called .httr-oauth. now changed - stored visible file called ‘mrbase.oauth’.","code":""}]
